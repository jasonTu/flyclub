"use strict";function ModalInstanceCtrl(a,b,c){a.subuser={},a.randomPassword=function(){for(var b=8,c="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",d=c.length,e="",f=0;b>f;f++)e+=c.charAt(Math.floor(Math.random()*d));a.subuser.password=e},a.setDefaultQuota=function(){a.subuser.quota=c.companyInfo.user_default_quota},a.disableSubmit=function(){return a.userForm.$invalid||a.userForm.$pristine?!0:!1},a.ok=function(){b.close(a.subuser)},a.cancel=function(){b.dismiss("cancel")}}function UpdateQuotaCtrl(a,b,c){a.subuser={},a.setDefaultQuota=function(){a.quota=c.companyInfo.user_default_quota},a.disableSubmit=function(){return a.quotaForm.$invalid?!0:!1},a.ok=function(){b.close(a.quota)},a.cancel=function(){b.dismiss("cancel")}}function CreateChannelUserCtrl(a,b,c){a.subuser={},a.randomPassword=function(){console.log("modalInfo");for(var b=8,c="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",d=c.length,e="",f=0;b>f;f++)e+=c.charAt(Math.floor(Math.random()*d));a.subuser.password=e},a.setDefaultQuota=function(){console.log("modalInfo"),a.subuser.quota=String(c.companyInfo.user_default_quota)},a.disableSubmit=function(){return a.userForm.$invalid||a.userForm.$pristine?!0:!1},a.ok=function(){b.close(a.subuser)},a.cancel=function(){b.dismiss("cancel")}}function UpdateUserQuotaCtrl(a,b,c){a.subuser={},a.setDefaultQuota=function(){console.log("modalInfo"),a.quota=String(c.companyInfo.user_default_quota)},a.disableSubmit=function(){return a.quotaForm.$invalid?!0:!1},a.ok=function(){b.close(a.quota)},a.cancel=function(){b.dismiss("cancel")}}function CreateChannelCompanyCtrl(a,b,c){a.subuser={},a.randomPassword=function(){for(var b=8,c="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",d=c.length,e="",f=0;b>f;f++)e+=c.charAt(Math.floor(Math.random()*d));a.subuser.password=e},a.setDefaultQuota=function(){a.subuser.quota=String(c.companyInfo.user_default_quota)},a.disableSubmit=function(){return a.userForm.$invalid||a.userForm.$pristine?!0:!1},a.ok=function(){b.close(a.subuser)},a.cancel=function(){b.dismiss("cancel")}}function UpdateCompanyQuotaCtrl(a,b,c){a.subuser={},a.setDefaultQuota=function(){a.quota=String(c.companyInfo.user_default_quota)},a.disableSubmit=function(){return a.quotaForm.$invalid?!0:!1},a.ok=function(){b.close(a.quota)},a.cancel=function(){b.dismiss("cancel")}}var mbkportalApp=angular.module("mbkportalApp",["ngAnimate","ngCookies","ngResource","ui.router","ngSanitize","ngTouch","ui.bootstrap","mgo-angular-wizard","datatables","treeControl","file-model","angularSpinner"]);mbkportalApp.factory("settings",["$rootScope",function(a){var b={layout:{pageSidebarClosed:!1,pageContentWhite:!0,pageBodySolid:!1,pageAutoScrollOnLoad:1e3},assetsPath:"../metronic",globalPath:"../metronic",layoutPath:"images"};return a.settings=b,b}]),mbkportalApp.controller("AppController",["$scope","$rootScope",function(a,b){a.$on("$viewContentLoaded",function(){})}]),mbkportalApp.controller("HeaderController",["$scope","$window","$location","user","usSpinnerService",function(a,b,c,d,e){a.userinfo={username:"Admin"},a.getCurrentUserInfo=function(){d.getCurrentUserInfo().then(function(c){200==c.status?a.userinfo=c.data:401==c.status&&(b.localStorage.loginStatus=!1,console.log(c))},function(a){console.log(a)})},a.logout=function(){d.logoutUser().then(function(c){a.loginRet=c,delete b.localStorage.loginStatus,delete b.localStorage.token_type,delete b.localStorage.access_token,delete b.localStorage.expires_in,delete b.localStorage.expires_at,delete b.localStorage.username,a.getCurrentUserInfo()},function(c){500==a.loginRet.status?console.log("logout get internal error"):401==a.loginRet.status&&(delete b.localStorage.loginStatus,delete b.localStorage.token_type,delete b.localStorage.access_token,delete b.localStorage.expires_in,delete b.localStorage.expires_at,delete b.localStorage.username,a.getCurrentUserInfo()),console.log("logout get request error")}),console.log("logout")},a.$on("$includeContentLoaded",function(){Layout.initHeader(),a.getCurrentUserInfo()})}]),mbkportalApp.controller("SidebarController",["$scope","$window","constants","user","usSpinnerService",function(a,b,c,d,e){a.deviceMgt=!0,a.channelMgt=!1,a.certMgt=!0,a.entityCert=!0,a.subuserMgt=!0,a.getCurrentUserInfo=function(){d.getCurrentUserInfo().then(function(d){200==d.status?(a.userinfo=d.data,a.userinfo.user_type==c.userType.channel&&(a.deviceMgt=!1,a.channelMgt=!0),a.userinfo.cert_status==c.certStatus.certyTypeNo||a.userinfo.cert_status==c.certStatus.certTypeUserVerifying||a.userinfo.cert_status==c.certStatus.certTypeCompanyVerifying?(a.certMgt=!0,a.entityCert=!0,a.subuserMgt=!1):a.userinfo.cert_status==c.certStatus.certTypeNoneed?(a.entityCert=!1,a.subuserMgt=!1,a.certMgt=!1):(a.certMgt=!0,a.entityCert=!0,a.subuserMgt=!0)):401==d.status&&(b.localStorage.loginStatus=!1,console.log(d))},function(a){console.log(a)})},a.$on("$includeContentLoaded",function(){Layout.initSidebar(),a.getCurrentUserInfo()})}]),mbkportalApp.controller("FooterController",["$scope",function(a){a.$on("$includeContentLoaded",function(){Layout.initFooter()})}]),mbkportalApp.config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/profile"),a.state("dashboard",{url:"/dashboard",templateUrl:"views/dashboard.html",data:{pageTitle:"Admin Dashboard Template"},controller:"dashboardCtrl"}).state("deviceList",{url:"/deviceList/:deviceId",templateUrl:"views/backup.html",data:{pageTitle:"Admin DeviceList"},controller:"BackupCtrl"}).state("actionList",{url:"/actionlist/:deviceId/:taskId",templateUrl:"views/taskhistory.html",data:{pageTitle:"Admin taskhistory"},controller:"taskhistoryCtrl"}).state("download",{url:"/download",templateUrl:"views/download.html",data:{pageTitle:"Admin Download"}}).state("profile",{url:"/profile",templateUrl:"views/user.html",data:{pageTitle:"Admin Download"},controller:"UserProfileCtrl"}).state("changepwd",{url:"/changepwd",templateUrl:"views/changepwd.html",data:{pageTitle:"Change Password"},controller:"PasswordCtrl"}).state("certmgt",{url:"/certmgt",templateUrl:"views/certManagement.html",data:{pageTitle:"Certification Management"},controller:"CertMgtCtrl"}).state("subusermgt",{url:"/subusermgt",templateUrl:"views/subuserMgt.html",data:{pageTitle:"Sub User Management"},controller:"SubuserMgtCtrl"}).state("channelusermgt",{url:"/channelusermgt",templateUrl:"views/channeluserMgt.html",data:{pageTitle:"Channel User Management"},controller:"ChanneluserMgtCtrl"}).state("channelcompanymgt",{url:"/channelcompanymgt",templateUrl:"views/channelcompanyMgt.html",data:{pageTitle:"Channel Company Management"},controller:"ChannelcompanyMgtCtrl"})}]),mbkportalApp.factory("authInterceptor",["$q","$rootScope","$timeout","$window","$location",function(a,b,c,d,e){return{request:function(a){return a.headers=a.headers||{},a.headers.Authorization=[window.localStorage.token_type,window.localStorage.access_token].join(" "),a},responseError:function(e){return 401==e.status&&(d.localStorage.loginStatus=!1,d.location="/mgmt/user_login.html#/login",c(function(){b.$broadcast("event:unauthorized")},1e3)),a.reject(e)}}}]),mbkportalApp.config(["usSpinnerConfigProvider",function(a){a.setDefaults({lines:15,length:3,width:2,radius:12,scale:1,opacity:.5,speed:1})}]),mbkportalApp.config(["$httpProvider",function(a){a.interceptors.push("authInterceptor")}]),mbkportalApp.run(["$rootScope","$http","config","utils","settings","$state",function(a,b,c,d,e,f){a.$state=f,a.$settings=e,a.$on("event:authenticate",function(b,c){window.localStorage.token_type=c.data.token_type,window.localStorage.access_token=c.data.access_token,window.localStorage.expires_in=c.data.expires_in,window.localStorage.expires_at=c.data.expires_at,a.$broadcast("event:authenticated")})}]),angular.module("mbkportalApp").directive("ngSpinnerBar",["$rootScope",function(a){return{link:function(b,c,d){c.addClass("hide"),a.$on("$stateChangeStart",function(){c.removeClass("hide")}),a.$on("$stateChangeSuccess",function(){c.addClass("hide"),$("body").removeClass("page-on-load"),Layout.setSidebarMenuActiveLink("match"),setTimeout(function(){App.scrollTop()},a.settings.layout.pageAutoScrollOnLoad)}),a.$on("$stateNotFound",function(){c.addClass("hide")}),a.$on("$stateChangeError",function(){c.addClass("hide")})}}}]),angular.module("mbkportalApp").directive("a",function(){return{restrict:"E",link:function(a,b,c){(c.ngClick||""===c.href||"#"===c.href)&&b.on("click",function(a){a.preventDefault()})}}}),angular.module("mbkportalApp").directive("dropdownMenuHover",function(){return{link:function(a,b){b.dropdownHover()}}});var App=function(){var a,b=!1,c=!1,d=!1,e=!1,f=[],g="../assets/",h="global/img/",i="global/plugins/",j="global/css/",k={blue:"#89C4F4",red:"#F3565D",green:"#1bbc9b",purple:"#9b59b6",grey:"#95a5a6",yellow:"#F8CB00"},l=function(){"rtl"===$("body").css("direction")&&(b=!0),c=!!navigator.userAgent.match(/MSIE 8.0/),d=!!navigator.userAgent.match(/MSIE 9.0/),e=!!navigator.userAgent.match(/MSIE 10.0/),e&&$("html").addClass("ie10"),(e||d||c)&&$("html").addClass("ie")},m=function(){for(var a=0;a<f.length;a++){var b=f[a];b.call()}},n=function(){var a;if(c){var b;$(window).resize(function(){b!=document.documentElement.clientHeight&&(a&&clearTimeout(a),a=setTimeout(function(){m()},50),b=document.documentElement.clientHeight)})}else $(window).resize(function(){a&&clearTimeout(a),a=setTimeout(function(){m()},50)})},o=function(){$("body").on("click",".portlet > .portlet-title > .tools > a.remove",function(a){a.preventDefault();var b=$(this).closest(".portlet");$("body").hasClass("page-portlet-fullscreen")&&$("body").removeClass("page-portlet-fullscreen"),b.find(".portlet-title .fullscreen").tooltip("destroy"),b.find(".portlet-title > .tools > .reload").tooltip("destroy"),b.find(".portlet-title > .tools > .remove").tooltip("destroy"),b.find(".portlet-title > .tools > .config").tooltip("destroy"),b.find(".portlet-title > .tools > .collapse, .portlet > .portlet-title > .tools > .expand").tooltip("destroy"),b.remove()}),$("body").on("click",".portlet > .portlet-title .fullscreen",function(a){a.preventDefault();var b=$(this).closest(".portlet");if(b.hasClass("portlet-fullscreen"))$(this).removeClass("on"),b.removeClass("portlet-fullscreen"),$("body").removeClass("page-portlet-fullscreen"),b.children(".portlet-body").css("height","auto");else{var c=App.getViewPort().height-b.children(".portlet-title").outerHeight()-parseInt(b.children(".portlet-body").css("padding-top"))-parseInt(b.children(".portlet-body").css("padding-bottom"));$(this).addClass("on"),b.addClass("portlet-fullscreen"),$("body").addClass("page-portlet-fullscreen"),b.children(".portlet-body").css("height",c)}}),$("body").on("click",".portlet > .portlet-title > .tools > a.reload",function(a){a.preventDefault();var b=$(this).closest(".portlet").children(".portlet-body"),c=$(this).attr("data-url"),d=$(this).attr("data-error-display");c?(App.blockUI({target:b,animate:!0,overlayColor:"none"}),$.ajax({type:"GET",cache:!1,url:c,dataType:"html",success:function(a){App.unblockUI(b),b.html(a),App.initAjax()},error:function(a,c,e){App.unblockUI(b);var f="Error on reloading the content. Please check your connection and try again.";"toastr"==d&&toastr?toastr.error(f):"notific8"==d&&$.notific8?($.notific8("zindex",11500),$.notific8(f,{theme:"ruby",life:3e3})):alert(f)}})):(App.blockUI({target:b,animate:!0,overlayColor:"none"}),window.setTimeout(function(){App.unblockUI(b)},1e3))}),$('.portlet .portlet-title a.reload[data-load="true"]').click(),$("body").on("click",".portlet > .portlet-title > .tools > .collapse, .portlet .portlet-title > .tools > .expand",function(a){a.preventDefault();var b=$(this).closest(".portlet").children(".portlet-body");$(this).hasClass("collapse")?($(this).removeClass("collapse").addClass("expand"),b.slideUp(200)):($(this).removeClass("expand").addClass("collapse"),b.slideDown(200))})},p=function(){if($().uniform){var a=$("input[type=checkbox]:not(.toggle, .md-check, .md-radiobtn, .make-switch, .icheck), input[type=radio]:not(.toggle, .md-check, .md-radiobtn, .star, .make-switch, .icheck)");a.size()>0&&a.each(function(){0===$(this).parents(".checker").size()&&($(this).show(),$(this).uniform())})}},q=function(){if($("body").on("click",".md-checkbox > label, .md-radio > label",function(){var a=$(this),b=$(this).children("span:first-child");b.addClass("inc");var c=b.clone(!0);b.before(c),$("."+b.attr("class")+":last",a).remove()}),$("body").hasClass("page-md")){var a,b,c,d,e;$("body").on("click","a.btn, button.btn, input.btn, label.btn",function(f){a=$(this),0==a.find(".md-click-circle").length&&a.prepend("<span class='md-click-circle'></span>"),b=a.find(".md-click-circle"),b.removeClass("md-click-animate"),b.height()||b.width()||(c=Math.max(a.outerWidth(),a.outerHeight()),b.css({height:c,width:c})),d=f.pageX-a.offset().left-b.width()/2,e=f.pageY-a.offset().top-b.height()/2,b.css({top:e+"px",left:d+"px"}).addClass("md-click-animate"),setTimeout(function(){b.remove()},1e3)})}var f=function(a){""!=a.val()?a.addClass("edited"):a.removeClass("edited")};$("body").on("keydown",".form-md-floating-label .form-control",function(a){f($(this))}),$("body").on("blur",".form-md-floating-label .form-control",function(a){f($(this))}),$(".form-md-floating-label .form-control").each(function(){$(this).val().length>0&&$(this).addClass("edited")})},r=function(){$().iCheck&&$(".icheck").each(function(){var a=$(this).attr("data-checkbox")?$(this).attr("data-checkbox"):"icheckbox_minimal-grey",b=$(this).attr("data-radio")?$(this).attr("data-radio"):"iradio_minimal-grey";a.indexOf("_line")>-1||b.indexOf("_line")>-1?$(this).iCheck({checkboxClass:a,radioClass:b,insert:'<div class="icheck_line-icon"></div>'+$(this).attr("data-label")}):$(this).iCheck({checkboxClass:a,radioClass:b})})},s=function(){$().bootstrapSwitch&&$(".make-switch").bootstrapSwitch()},t=function(){$().confirmation&&$("[data-toggle=confirmation]").confirmation({container:"body",btnOkClass:"btn btn-sm btn-success",btnCancelClass:"btn btn-sm btn-danger"})},u=function(){$("body").on("shown.bs.collapse",".accordion.scrollable",function(a){App.scrollTo($(a.target))})},v=function(){if(location.hash){var a=encodeURI(location.hash.substr(1));$('a[href="#'+a+'"]').parents(".tab-pane:hidden").each(function(){var a=$(this).attr("id");$('a[href="#'+a+'"]').click()}),$('a[href="#'+a+'"]').click()}$().tabdrop&&$(".tabbable-tabdrop .nav-pills, .tabbable-tabdrop .nav-tabs").tabdrop({text:'<i class="fa fa-ellipsis-v"></i>&nbsp;<i class="fa fa-angle-down"></i>'})},w=function(){$("body").on("hide.bs.modal",function(){$(".modal:visible").size()>1&&$("html").hasClass("modal-open")===!1?$("html").addClass("modal-open"):$(".modal:visible").size()<=1&&$("html").removeClass("modal-open")}),$("body").on("show.bs.modal",".modal",function(){$(this).hasClass("modal-scroll")&&$("body").addClass("modal-open-noscroll")}),$("body").on("hide.bs.modal",".modal",function(){$("body").removeClass("modal-open-noscroll")}),$("body").on("hidden.bs.modal",".modal:not(.modal-cached)",function(){$(this).removeData("bs.modal")})},x=function(){$(".tooltips").tooltip(),$(".portlet > .portlet-title .fullscreen").tooltip({container:"body",title:"Fullscreen"}),$(".portlet > .portlet-title > .tools > .reload").tooltip({container:"body",title:"Reload"}),$(".portlet > .portlet-title > .tools > .remove").tooltip({container:"body",title:"Remove"}),$(".portlet > .portlet-title > .tools > .config").tooltip({container:"body",title:"Settings"}),$(".portlet > .portlet-title > .tools > .collapse, .portlet > .portlet-title > .tools > .expand").tooltip({container:"body",title:"Collapse/Expand"})},y=function(){$("body").on("click",".dropdown-menu.hold-on-click",function(a){a.stopPropagation()})},z=function(){$("body").on("click",'[data-close="alert"]',function(a){$(this).parent(".alert").hide(),$(this).closest(".note").hide(),a.preventDefault()}),$("body").on("click",'[data-close="note"]',function(a){$(this).closest(".note").hide(),a.preventDefault()}),$("body").on("click",'[data-remove="note"]',function(a){$(this).closest(".note").remove(),a.preventDefault()})},A=function(){$('[data-hover="dropdown"]').not(".hover-initialized").each(function(){$(this).dropdownHover(),$(this).addClass("hover-initialized")})},B=function(){"function"==typeof autosize&&autosize(document.querySelector("textarea.autosizeme"))},C=function(){$(".popovers").popover(),$(document).on("click.bs.popover.data-api",function(b){a&&a.popover("hide")})},D=function(){App.initSlimScroll(".scroller")},E=function(){jQuery.fancybox&&$(".fancybox-button").size()>0&&$(".fancybox-button").fancybox({groupAttr:"data-rel",prevEffect:"none",nextEffect:"none",closeBtn:!0,helpers:{title:{type:"inside"}}})},F=function(){$().counterUp&&$("[data-counter='counterup']").counterUp({delay:10,time:1e3})},G=function(){(c||d)&&$("input[placeholder]:not(.placeholder-no-fix), textarea[placeholder]:not(.placeholder-no-fix)").each(function(){var a=$(this);""===a.val()&&""!==a.attr("placeholder")&&a.addClass("placeholder").val(a.attr("placeholder")),a.focus(function(){a.val()==a.attr("placeholder")&&a.val("")}),a.blur(function(){(""===a.val()||a.val()==a.attr("placeholder"))&&a.val(a.attr("placeholder"))})})},H=function(){$().select2&&($.fn.select2.defaults.set("theme","bootstrap"),$(".select2me").select2({placeholder:"Select",width:"auto",allowClear:!0}))},I=function(){$("[data-auto-height]").each(function(){var a=$(this),b=$("[data-height]",a),c=0,d=a.attr("data-mode"),e=parseInt(a.attr("data-offset")?a.attr("data-offset"):0);b.each(function(){"height"==$(this).attr("data-height")?$(this).css("height",""):$(this).css("min-height","");var a="base-height"==d?$(this).outerHeight():$(this).outerHeight(!0);a>c&&(c=a)}),c+=e,b.each(function(){"height"==$(this).attr("data-height")?$(this).css("height",c):$(this).css("min-height",c)}),a.attr("data-related")&&$(a.attr("data-related")).css("height",a.height())})};return{init:function(){l(),n(),q(),p(),r(),s(),D(),E(),H(),o(),z(),y(),v(),x(),C(),u(),w(),t(),B(),F(),this.addResizeHandler(I),G()},initAjax:function(){p(),r(),s(),A(),D(),H(),E(),y(),x(),C(),u(),t()},initComponents:function(){this.initAjax()},setLastPopedPopover:function(b){a=b},addResizeHandler:function(a){f.push(a)},runResizeHandlers:function(){m()},scrollTo:function(a,b){var c=a&&a.size()>0?a.offset().top:0;a&&($("body").hasClass("page-header-fixed")?c-=$(".page-header").height():$("body").hasClass("page-header-top-fixed")?c-=$(".page-header-top").height():$("body").hasClass("page-header-menu-fixed")&&(c-=$(".page-header-menu").height()),c+=b?b:-1*a.height()),$("html,body").animate({scrollTop:c},"slow")},initSlimScroll:function(a){$(a).each(function(){if(!$(this).attr("data-initialized")){var a;a=$(this).attr("data-height")?$(this).attr("data-height"):$(this).css("height"),$(this).slimScroll({allowPageScroll:!0,size:"7px",color:$(this).attr("data-handle-color")?$(this).attr("data-handle-color"):"#bbb",wrapperClass:$(this).attr("data-wrapper-class")?$(this).attr("data-wrapper-class"):"slimScrollDiv",railColor:$(this).attr("data-rail-color")?$(this).attr("data-rail-color"):"#eaeaea",position:b?"left":"right",height:a,alwaysVisible:"1"==$(this).attr("data-always-visible")?!0:!1,railVisible:"1"==$(this).attr("data-rail-visible")?!0:!1,disableFadeOut:!0}),$(this).attr("data-initialized","1")}})},destroySlimScroll:function(a){$(a).each(function(){if("1"===$(this).attr("data-initialized")){$(this).removeAttr("data-initialized"),$(this).removeAttr("style");var a={};$(this).attr("data-handle-color")&&(a["data-handle-color"]=$(this).attr("data-handle-color")),$(this).attr("data-wrapper-class")&&(a["data-wrapper-class"]=$(this).attr("data-wrapper-class")),$(this).attr("data-rail-color")&&(a["data-rail-color"]=$(this).attr("data-rail-color")),$(this).attr("data-always-visible")&&(a["data-always-visible"]=$(this).attr("data-always-visible")),$(this).attr("data-rail-visible")&&(a["data-rail-visible"]=$(this).attr("data-rail-visible")),$(this).slimScroll({wrapperClass:$(this).attr("data-wrapper-class")?$(this).attr("data-wrapper-class"):"slimScrollDiv",destroy:!0});var b=$(this);$.each(a,function(a,c){b.attr(a,c)})}})},scrollTop:function(){App.scrollTo()},blockUI:function(a){a=$.extend(!0,{},a);var b="";if(b=a.animate?'<div class="loading-message '+(a.boxed?"loading-message-boxed":"")+'"><div class="block-spinner-bar"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div>':a.iconOnly?'<div class="loading-message '+(a.boxed?"loading-message-boxed":"")+'"><img src="'+this.getGlobalImgPath()+'loading-spinner-grey.gif" align=""></div>':a.textOnly?'<div class="loading-message '+(a.boxed?"loading-message-boxed":"")+'"><span>&nbsp;&nbsp;'+(a.message?a.message:"LOADING...")+"</span></div>":'<div class="loading-message '+(a.boxed?"loading-message-boxed":"")+'"><img src="'+this.getGlobalImgPath()+'loading-spinner-grey.gif" align=""><span>&nbsp;&nbsp;'+(a.message?a.message:"LOADING...")+"</span></div>",a.target){var c=$(a.target);c.height()<=$(window).height()&&(a.cenrerY=!0),c.block({message:b,baseZ:a.zIndex?a.zIndex:1e3,centerY:void 0!==a.cenrerY?a.cenrerY:!1,css:{top:"10%",border:"0",padding:"0",backgroundColor:"none"},overlayCSS:{backgroundColor:a.overlayColor?a.overlayColor:"#555",opacity:a.boxed?.05:.1,cursor:"wait"}})}else $.blockUI({message:b,baseZ:a.zIndex?a.zIndex:1e3,css:{border:"0",padding:"0",backgroundColor:"none"},overlayCSS:{backgroundColor:a.overlayColor?a.overlayColor:"#555",opacity:a.boxed?.05:.1,cursor:"wait"}})},unblockUI:function(a){a?$(a).unblock({onUnblock:function(){$(a).css("position",""),$(a).css("zoom","")}}):$.unblockUI()},startPageLoading:function(a){a&&a.animate?($(".page-spinner-bar").remove(),$("body").append('<div class="page-spinner-bar"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>')):($(".page-loading").remove(),$("body").append('<div class="page-loading"><img src="'+this.getGlobalImgPath()+'loading-spinner-grey.gif"/>&nbsp;&nbsp;<span>'+(a&&a.message?a.message:"Loading...")+"</span></div>"))},stopPageLoading:function(){$(".page-loading, .page-spinner-bar").remove()},alert:function(a){a=$.extend(!0,{container:"",place:"append",type:"success",message:"",close:!0,reset:!0,focus:!0,closeInSeconds:0,icon:""},a);var b=App.getUniqueID("App_alert"),c='<div id="'+b+'" class="custom-alerts alert alert-'+a.type+' fade in">'+(a.close?'<button type="button" class="close" data-dismiss="alert" aria-hidden="true"></button>':"")+(""!==a.icon?'<i class="fa-lg fa fa-'+a.icon+'"></i>  ':"")+a.message+"</div>";return a.reset&&$(".custom-alerts").remove(),a.container?"append"==a.place?$(a.container).append(c):$(a.container).prepend(c):$("body").hasClass("page-container-bg-solid")||$("body").hasClass("page-content-white")?$(".page-title").after(c):$(".page-bar").size()>0?$(".page-bar").after(c):$(".page-breadcrumb").after(c),a.focus&&App.scrollTo($("#"+b)),a.closeInSeconds>0&&setTimeout(function(){$("#"+b).remove()},1e3*a.closeInSeconds),b},initUniform:function(a){a?$(a).each(function(){0===$(this).parents(".checker").size()&&($(this).show(),$(this).uniform())}):p()},updateUniform:function(a){$.uniform.update(a)},initFancybox:function(){E()},getActualVal:function(a){return a=$(a),a.val()===a.attr("placeholder")?"":a.val()},getURLParameter:function(a){var b,c,d=window.location.search.substring(1),e=d.split("&");for(b=0;b<e.length;b++)if(c=e[b].split("="),c[0]==a)return unescape(c[1]);return null},isTouchDevice:function(){try{return document.createEvent("TouchEvent"),!0}catch(a){return!1}},getViewPort:function(){var a=window,b="inner";return"innerWidth"in window||(b="client",a=document.documentElement||document.body),{width:a[b+"Width"],height:a[b+"Height"]}},getUniqueID:function(a){return"prefix_"+Math.floor(Math.random()*(new Date).getTime())},isIE8:function(){return c},isIE9:function(){return d},isRTL:function(){return b},isAngularJsApp:function(){return"undefined"==typeof angular?!1:!0},getAssetsPath:function(){return g},setAssetsPath:function(a){g=a},setGlobalImgPath:function(a){h=a},getGlobalImgPath:function(){return g+h},setGlobalPluginsPath:function(a){i=a},getGlobalPluginsPath:function(){return g+i},getGlobalCssPath:function(){return g+j},getBrandColor:function(a){return k[a]?k[a]:""},getResponsiveBreakpoint:function(a){var b={xs:480,sm:768,md:992,lg:1200};return b[a]?b[a]:0}}}();jQuery(document).ready(function(){App.init()});var Layout=function(){var a="layouts/layout/img/",b="layouts/layout/css/",c=App.getResponsiveBreakpoint("md"),d=function(){var a,b=$(".page-content"),d=$(".page-sidebar"),e=$("body");if(e.hasClass("page-footer-fixed")===!0&&e.hasClass("page-sidebar-fixed")===!1){var f=App.getViewPort().height-$(".page-footer").outerHeight()-$(".page-header").outerHeight();b.height()<f&&b.attr("style","min-height:"+f+"px")}else{if(e.hasClass("page-sidebar-fixed"))a=g(),e.hasClass("page-footer-fixed")===!1&&(a-=$(".page-footer").outerHeight());else{var h=$(".page-header").outerHeight(),i=$(".page-footer").outerHeight();a=App.getViewPort().width<c?App.getViewPort().height-h-i:d.height()+20,a+h+i<=App.getViewPort().height&&(a=App.getViewPort().height-h-i)}b.attr("style","min-height:"+a+"px")}},e=function(a,b){var d=location.hash.toLowerCase(),e=$(".page-sidebar-menu");if("click"===a||"set"===a?b=$(b):"match"===a&&e.find("li > a").each(function(){var a=$(this).attr("href").toLowerCase();return a.length>1&&d.substr(1,a.length-1)==a.substr(1)?void(b=$(this)):void 0}),b&&0!=b.size()&&"javascript:;"!==b.attr("href").toLowerCase()&&"#"!==b.attr("href").toLowerCase()){parseInt(e.data("slide-speed")),e.data("keep-expanded");e.find("li.active").removeClass("active"),e.find("li > a > .selected").remove(),e.hasClass("page-sidebar-menu-hover-submenu")===!1?e.find("li.open").each(function(){0===$(this).children(".sub-menu").size()&&($(this).removeClass("open"),$(this).find("> a > .arrow.open").removeClass("open"))}):e.find("li.open").removeClass("open"),b.parents("li").each(function(){$(this).addClass("active"),$(this).find("> a > span.arrow").addClass("open"),1===$(this).parent("ul.page-sidebar-menu").size()&&$(this).find("> a").append('<span class="selected"></span>'),1===$(this).children("ul.sub-menu").size()&&$(this).addClass("open")}),"click"===a&&App.getViewPort().width<c&&$(".page-sidebar").hasClass("in")&&$(".page-header .responsive-toggler").click()}},f=function(){$(".page-sidebar-menu").on("click","li > a.nav-toggle, li > a > span.nav-toggle",function(a){var b=$(this).closest(".nav-item").children(".nav-link");if(!(App.getViewPort().width>=c&&!$(".page-sidebar-menu").attr("data-initialized")&&$("body").hasClass("page-sidebar-closed")&&1===b.parent("li").parent(".page-sidebar-menu").size())){var e=b.next().hasClass("sub-menu");if(!(App.getViewPort().width>=c&&1===b.parents(".page-sidebar-menu-hover-submenu").size())){if(e===!1)return void(App.getViewPort().width<c&&$(".page-sidebar").hasClass("in")&&$(".page-header .responsive-toggler").click());if(!b.next().hasClass("sub-menu always-open")){var f=b.parent().parent(),g=b,h=$(".page-sidebar-menu"),i=b.next(),j=h.data("auto-scroll"),k=parseInt(h.data("slide-speed")),l=h.data("keep-expanded");l||(f.children("li.open").children("a").children(".arrow").removeClass("open"),f.children("li.open").children(".sub-menu:not(.always-open)").slideUp(k),f.children("li.open").removeClass("open"));var m=-200;i.is(":visible")?($(".arrow",g).removeClass("open"),g.parent().removeClass("open"),i.slideUp(k,function(){j===!0&&$("body").hasClass("page-sidebar-closed")===!1&&($("body").hasClass("page-sidebar-fixed")?h.slimScroll({scrollTo:g.position().top}):App.scrollTo(g,m)),d()})):e&&($(".arrow",g).addClass("open"),g.parent().addClass("open"),i.slideDown(k,function(){j===!0&&$("body").hasClass("page-sidebar-closed")===!1&&($("body").hasClass("page-sidebar-fixed")?h.slimScroll({scrollTo:g.position().top}):App.scrollTo(g,m)),d()})),a.preventDefault()}}}}),App.isAngularJsApp()&&$(".page-sidebar-menu li > a").on("click",function(a){App.getViewPort().width<c&&$(this).next().hasClass("sub-menu")===!1&&$(".page-header .responsive-toggler").click()}),$(".page-sidebar").on("click"," li > a.ajaxify",function(a){a.preventDefault(),App.scrollTop();var b=$(this).attr("href"),d=$(".page-sidebar ul"),e=($(".page-content"),$(".page-content .page-content-body"));d.children("li.active").removeClass("active"),d.children("arrow.open").removeClass("open"),$(this).parents("li").each(function(){$(this).addClass("active"),$(this).children("a > span.arrow").addClass("open")}),$(this).parents("li").addClass("active"),App.getViewPort().width<c&&$(".page-sidebar").hasClass("in")&&$(".page-header .responsive-toggler").click(),App.startPageLoading();var f=$(this);$.ajax({type:"GET",cache:!1,url:b,dataType:"html",success:function(a){0===f.parents("li.open").size()&&$(".page-sidebar-menu > li.open > a").click(),App.stopPageLoading(),e.html(a),Layout.fixContentHeight(),App.initAjax()},error:function(a,b,c){App.stopPageLoading(),e.html("<h4>Could not load the requested content.</h4>")}})}),$(".page-content").on("click",".ajaxify",function(a){a.preventDefault(),App.scrollTop();var b=$(this).attr("href"),d=($(".page-content"),$(".page-content .page-content-body"));App.startPageLoading(),App.getViewPort().width<c&&$(".page-sidebar").hasClass("in")&&$(".page-header .responsive-toggler").click(),$.ajax({type:"GET",cache:!1,url:b,dataType:"html",success:function(a){App.stopPageLoading(),d.html(a),Layout.fixContentHeight(),App.initAjax()},error:function(a,b,c){d.html("<h4>Could not load the requested content.</h4>"),App.stopPageLoading()}})}),$(document).on("click",".page-header-fixed-mobile .page-header .responsive-toggler",function(){App.scrollTop()}),i(),$(".page-sidebar").on("click",".sidebar-search .remove",function(a){a.preventDefault(),$(".sidebar-search").removeClass("open")}),$(".page-sidebar .sidebar-search").on("keypress","input.form-control",function(a){return 13==a.which?($(".sidebar-search").submit(),!1):void 0}),$(".sidebar-search .submit").on("click",function(a){a.preventDefault(),$("body").hasClass("page-sidebar-closed")&&$(".sidebar-search").hasClass("open")===!1?(1===$(".page-sidebar-fixed").size()&&$(".page-sidebar .sidebar-toggler").click(),$(".sidebar-search").addClass("open")):$(".sidebar-search").submit()}),0!==$(".sidebar-search").size()&&($(".sidebar-search .input-group").on("click",function(a){a.stopPropagation()}),$("body").on("click",function(){$(".sidebar-search").hasClass("open")&&$(".sidebar-search").removeClass("open")}))},g=function(){var a=App.getViewPort().height-$(".page-header").outerHeight(!0);return $("body").hasClass("page-footer-fixed")&&(a-=$(".page-footer").outerHeight()),a},h=function(){var a=$(".page-sidebar-menu");return App.destroySlimScroll(a),0===$(".page-sidebar-fixed").size()?void d():void(App.getViewPort().width>=c&&(a.attr("data-height",g()),App.initSlimScroll(a),d()))},i=function(){var a=$("body");a.hasClass("page-sidebar-fixed")&&$(".page-sidebar").on("mouseenter",function(){a.hasClass("page-sidebar-closed")&&$(this).find(".page-sidebar-menu").removeClass("page-sidebar-menu-closed")}).on("mouseleave",function(){a.hasClass("page-sidebar-closed")&&$(this).find(".page-sidebar-menu").addClass("page-sidebar-menu-closed")})},j=function(){var a=$("body");$.cookie&&"1"===$.cookie("sidebar_closed")&&App.getViewPort().width>=c&&($("body").addClass("page-sidebar-closed"),$(".page-sidebar-menu").addClass("page-sidebar-menu-closed")),$("body").on("click",".sidebar-toggler",function(b){var c=$(".page-sidebar"),d=$(".page-sidebar-menu");$(".sidebar-search",c).removeClass("open"),a.hasClass("page-sidebar-closed")?(a.removeClass("page-sidebar-closed"),d.removeClass("page-sidebar-menu-closed"),$.cookie&&$.cookie("sidebar_closed","0")):(a.addClass("page-sidebar-closed"),d.addClass("page-sidebar-menu-closed"),a.hasClass("page-sidebar-fixed")&&d.trigger("mouseleave"),$.cookie&&$.cookie("sidebar_closed","1")),$(window).trigger("resize");
})},k=function(){$(".page-header").on("click",'.hor-menu a[data-toggle="tab"]',function(a){a.preventDefault();var b=$(".hor-menu .nav"),c=b.find("li.current");$("li.active",c).removeClass("active"),$(".selected",c).remove();var d=$(this).parents("li").last();d.addClass("current"),d.find("a:first").append('<span class="selected"></span>')}),$(".page-header").on("click",".search-form",function(a){$(this).addClass("open"),$(this).find(".form-control").focus(),$(".page-header .search-form .form-control").on("blur",function(a){$(this).closest(".search-form").removeClass("open"),$(this).unbind("blur")})}),$(".page-header").on("keypress",".hor-menu .search-form .form-control",function(a){return 13==a.which?($(this).closest(".search-form").submit(),!1):void 0}),$(".page-header").on("mousedown",".search-form.open .submit",function(a){a.preventDefault(),a.stopPropagation(),$(this).closest(".search-form").submit()}),$('[data-hover="megamenu-dropdown"]').not(".hover-initialized").each(function(){$(this).dropdownHover(),$(this).addClass("hover-initialized")}),$(document).on("click",".mega-menu-dropdown .dropdown-menu",function(a){a.stopPropagation()})},l=function(){$("body").on("shown.bs.tab",'a[data-toggle="tab"]',function(){d()})},m=function(){var a=300,b=500;navigator.userAgent.match(/iPhone|iPad|iPod/i)?$(window).bind("touchend touchcancel touchleave",function(c){$(this).scrollTop()>a?$(".scroll-to-top").fadeIn(b):$(".scroll-to-top").fadeOut(b)}):$(window).scroll(function(){$(this).scrollTop()>a?$(".scroll-to-top").fadeIn(b):$(".scroll-to-top").fadeOut(b)}),$(".scroll-to-top").click(function(a){return a.preventDefault(),$("html, body").animate({scrollTop:0},b),!1})},n=function(){$(".full-height-content").each(function(){var a,b=$(this);if(a=App.getViewPort().height-$(".page-header").outerHeight(!0)-$(".page-footer").outerHeight(!0)-$(".page-title").outerHeight(!0)-$(".page-bar").outerHeight(!0),b.hasClass("portlet")){var d=b.find(".portlet-body");App.destroySlimScroll(d.find(".full-height-content-body")),a=a-b.find(".portlet-title").outerHeight(!0)-parseInt(b.find(".portlet-body").css("padding-top"))-parseInt(b.find(".portlet-body").css("padding-bottom"))-5,App.getViewPort().width>=c&&b.hasClass("full-height-content-scrollable")?(a-=35,d.find(".full-height-content-body").css("height",a),App.initSlimScroll(d.find(".full-height-content-body"))):d.css("min-height",a)}else App.destroySlimScroll(b.find(".full-height-content-body")),App.getViewPort().width>=c&&b.hasClass("full-height-content-scrollable")?(a-=35,b.find(".full-height-content-body").css("height",a),App.initSlimScroll(b.find(".full-height-content-body"))):b.css("min-height",a)})};return{initHeader:function(){k()},setSidebarMenuActiveLink:function(a,b){e(a,b)},initSidebar:function(){h(),f(),j(),App.isAngularJsApp()&&e("match"),App.addResizeHandler(h)},initContent:function(){n(),l(),App.addResizeHandler(d),App.addResizeHandler(n)},initFooter:function(){m()},init:function(){this.initHeader(),this.initSidebar(),this.initContent(),this.initFooter()},fixContentHeight:function(){d()},initFixedSidebarHoverEffect:function(){i()},initFixedSidebar:function(){h()},getLayoutImgPath:function(){return App.getAssetsPath()+a},getLayoutCssPath:function(){return App.getAssetsPath()+b}}}();App.isAngularJsApp()===!1&&jQuery(document).ready(function(){Layout.init()}),angular.module("mbkportalApp").controller("BackupCtrl",["$scope","$stateParams","backup_service","EventBus_Service","$uibModal","$log","user","constants","usSpinnerService","$timeout",function(a,b,c,d,e,f,g,h,i,j){a.showAlert=!1,a.alertType="",a.notifType="",a.notifMsg="",a.showSpinner=!1,a.companyQuota=0,a.companyQuotaUsed=0,a.modals={},a.isGroupOpen=!1,a.updateAlert=function(b,c,d,e){a.showAlert=b,a.alertType=c,a.notifType=d,a.notifMsg=e,j(function(){a.showAlert=!1},3e3)};var k=b.deviceId,l={Linux:2,Windows:1,IOS:3,Android:4,Tablet:5,Mobile:6};g.getCurrentUserInfo().then(function(b){var c=b.data;console.log(c.username),a.currentUser=c.username},function(b){401==b.status&&($window.localStorage.loginStatus=!1),a.currentUser=""}),a.getUserQuotaInfo=function(){g.getUserQuotaInfo().then(function(b){b.data;a.companyQuota=b.quota,a.companyQuotaUsed=b.storage_used},function(a){console.log("error"),console.log(a)})},a.getUserQuotaInfo(),a.mapIcon=function(a){var b="";switch(a){case l.Windows:b="fa fa-windows fa-2x";break;case l.Linux:b="fa fa-linux fa-2x";break;case l.Android:b="fa fa-android fa-2x";break;case l.IOS:b="fa fa-apple fa-2x";break;case l.Tablet:b="fa fa-tablet fa-2x";break;case l.Mobile:b="fa fa-mobile fa-2x";break;default:b="fa fa-desktop fa-2x"}return b},a.getUserDevices=function(){c.getUserDevices().then(function(b){a.devicesBlank_notice="设备列表为空","[object Array]"===Object.prototype.toString.call(b)?a.devices=b:(a.devices=[],a.devicesBlank_notice="请先登录");for(var c=0;c<a.devices.length;c++)a.devices[c].id==k?a.devices[c].itemStatus=!0:a.devices[c].itemStatus=!1,a.devices[c].isDeleting=!1;a.oneAtATime=!0},function(a){console.log("error"),console.log(a)})},a.getUserDevices(),a.deleteDevice=function(b){a.showSpinner=!0;for(var d="",e=0;e<a.devices.length;++e)a.devices[e].id==b&&(d=a.devices[e].host,a.devices[e].isDeleting=!0);c.deleteDevice(b).then(function(b){a.updateAlert(!0,"success","提示：","删除设备“"+d+"”成功！"),a.getUserDevices(),a.showSpinner=!1},function(c){for(var e=0;e<a.devices.length;++e)a.devices[e].id==b&&(a.devices[e].isDeleting=!1);console.log("error"),console.log(c),a.updateAlert(!0,"warning","警告：","删除设备“"+d+"失败"),a.showSpinner=!1})},a.modals.deleteDevice=function(b,c){var d=e.open({templateUrl:"modalDeleteDevice.html",controller:"modalDeleteDeviceCtrl",size:"sm",resolve:{modalInfo:function(){return{deviceName:c,deviceId:b}}}});d.result.then(function(b){a.deleteDevice(b)},function(){console.info("Modal dismissed at: "+new Date)})}}]).controller("modalDeleteDeviceCtrl",["$scope","$uibModalInstance","modalInfo",function(a,b,c){a.deviceName=c.deviceName,a.deviceId=c.deviceId,a.ok=function(){b.close(a.deviceId)},a.cancel=function(){b.dismiss("cancel")}}]).controller("deviceController",["$scope","backup_service","EventBus_Service","DTOptionsBuilder","user","constants","usSpinnerService","$uibModal",function(a,b,c,d,e,f,g,h){function i(a){for(var b=[],c=0,d=a.length;d>c;c++){for(var e=a[c],f=e[0],g=e.slice(1),h=null,j=0,k=b.length;k>j;j++)if(b[j].name===f){h=b[j];break}null===h&&(h=0==g.length?{name:f,leaf:!0,children:[]}:{name:f,children:[]},b.push(h)),g.length>0&&g[0]&&h.children.push(g)}for(c=0,d=b.length;d>c;c++)h=b[c],h.children=i(h.children);return b}var j={file:0},k={everyDay:1,daily:2};a.taskInfos=[],a.dtOptions=d.newOptions().withLanguage({sProcessing:"处理中...",sLengthMenu:"显示 _MENU_ 项结果",sZeroRecords:"没有匹配结果",sInfo:"显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项",sInfoEmpty:"显示第 0 至 0 项结果，共 0 项",sInfoFiltered:"(由 _MAX_ 项结果过滤)",sInfoPostFix:"",sSearch:"搜索:",sUrl:"",sEmptyTable:"表中数据为空",sLoadingRecords:"载入中...",sInfoThousands:",",oPaginate:{sFirst:"首页",sPrevious:"上页",sNext:"下页",sLast:"末页"},oAria:{sSortAscending:": 以升序排列此列",sSortDescending:": 以降序排列此列"}}),a.getTaskOfDevice=function(c){b.getTaskOfDevice(c).then(function(b){a.taskInfos=b,a.treedata=[];for(var c=0;c<b.length;c++){a.taskInfos[c].mapStatus=a.translateTaskStatus(a.taskInfos[c].status),a.taskInfos[c].isSuccess=!0;var d=a.GetContent(b[c].details,b[c].task_type);d=d.map(function(a){return a.split("/")});var e=i(d);a.treedata.push(e)}},function(a){console.log("error"),console.log(a)})},a.$watch("device.itemStatus",function(b){1!=b||a.taskInfos.length||a.getTaskOfDevice(a.device.guid)}),a.GetContent=function(a,b){for(var c=a.dirs,d=c.split("|"),e=l(b),f=0;f<d.length;f++)d[f]=e+d[f];return d};var l=function(a){var b="";switch(a){case j.file:b="我的电脑";break;default:b="/"}return b};a.mapTaskIcon=function(a){var b="";switch(a){case j.file:b="fa fa-folder-o fa-3x";break;default:b="fa fa-folder-o fa-3x"}return b},a.mapFrequency=function(a,b){var c=["星期一","星期二","星期三","星期四","星期五","星期六","星期日"],d="";if(k.everyDay==b)return d=c.join(", ");for(var e=!1,f=0;7>f;f++)if(1<<f&a){if(!f){e=!0;continue}d=d+c[f-1]+", "}return e&&(d=d+c[6]+", "),d.substring(0,d.length-2)},a.formatMinute=function(a){var b="";return b=9>a?"0"+a.toString():a.toString()},a.showTaskHistory=function(a,b){window.location="#/actionlist/"+b+"/"+a},a.opts={isLeaf:function(a){return a.leaf}},a.task_status_idle=f.taskStatus.TASK_STATUS_IDLE,a.task_status_purging=f.taskStatus.TASK_STATUS_PURGING,a.translateTaskStatus=function(a){switch(a){case f.taskStatus.TASK_STATUS_IDLE:return"备份成功";case f.taskStatus.TASK_STATUS_BACKUPING:return"正在备份";case f.taskStatus.TASK_STATUS_RESTORING:return"正在恢复";case f.taskStatus.TASK_STATUS_PURGING:return"正在删除";default:return""}},a.deleteTask=function(c){a.showSpinner=!0;for(var d=0;d<a.taskInfos.length;++d)a.taskInfos[d].id==c&&(a.taskInfos[d].status=f.taskStatus.TASK_STATUS_PURGING,a.taskInfos[d].mapStatus="正在删除");b.deleteTask(c).then(function(b){for(var d=0;d<a.taskInfos.length;++d)a.taskInfos[d].id==c&&(a.taskInfos[d].mapStatus="删除成功 ");a.updateAlert(!0,"success","提示：","删除任务成功！"),a.getTaskOfDevice(a.device.guid),a.showSpinner=!1},function(b){for(var d=0;d<a.taskInfos.length;++d)a.taskInfos[d].id==c&&(a.taskInfos[d].status=f.taskStatus.TASK_STATUS_IDLE,a.taskInfos[d].mapStatus="删除失败 ",a.taskInfos[d].isSuccess=!1);console.log("error"),console.log(b),a.updateAlert(!0,"warning","警告：","删除任务失败！"),a.showSpinner=!1})},a.showDescription=function(){0==a.isGroupOpen&&(a.isGroupOpen=!0)},a.translatePurgeType=function(a){switch(a){case f.purgeType.KEEP_LAST_ONE_WEEK:return"最近一周";case f.purgeType.KEEP_LAST_TWO_WEEKS:return"最近两周";case f.purgeType.KEEP_LAST_ONE_MONTH:return"最近一个月";case f.purgeType.KEEP_LAST_THREE_MONTHS:return"最近三个月";case f.purgeType.KEEP_LAST_SIX_MONTHS:return"最近六个月";case f.purgeType.KEEP_LAST_ONE_YEAR:return"最近一年";default:return"最近三个月"}},a.modals.deleteTask=function(b,c){var d=h.open({templateUrl:"modalDeleteTask.html",controller:"modalDeleteTaskCtrl",size:"sm",resolve:{modalInfo:function(){return{deviceName:c,taskId:b}}}});d.result.then(function(b){a.deleteTask(b)},function(){console.info("Modal dismissed at: "+new Date)})}}]).controller("modalDeleteTaskCtrl",["$scope","$uibModalInstance","modalInfo",function(a,b,c){a.deviceName=c.deviceName,a.taskId=c.taskId,a.ok=function(){b.close(a.taskId)},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("mbkportalApp").controller("UserProfileCtrl",["$scope","$uibModal","$window","user","usSpinnerService","constants","$location",function(a,b,c,d,e,f,g){a.userInfo={},a.userType=f.userType,a.userInfoActive=!1,a.confirmStatus="",a.certStatus="",a.showSpinner=!1,a.showAlert=!1,a.alertType="",a.notifType="",a.notifMsg="",a.updateAlert=function(b,c,d,e){a.showAlert=b,a.alertType=c,a.notifType=d,a.notifMsg=e},a.emailSent=!1,a.userNotConfirmed=function(){return!a.userInfo.is_email_confirmed},a.sendConfirmation=function(){d.sendConfirmEmail(a.userInfo).then(function(b){a.updateAlert(!0,"success","恭喜","验证信息已发送，请到邮箱验证该账号！"),a.emailSent=!0},function(b){return 500==b.status?void a.updateAlert(!0,"error","邮件发送失败","程序猿们正在玩命抢修中！"):void 0})},a.userCertification=function(){0==a.userInfo.is_email_confirmed?a.updateAlert(!0,"warning","警告","账户未验证！"):g.path("/certmgt")},a.formChanged=function(){return a.updatePwd?a.profileForm.inputUsername.$dirty||a.profileForm.inputEmail.$dirty||a.profileForm.inputPhone.$dirty?!0:!1:a.profileForm.inputUsername.$dirty||a.profileForm.inputEmail.$dirty||a.profileForm.inputPhone.$dirty?!0:!1},a.disableSaveUserProfile=function(){return a.profileForm.inputUsername.$invalid||a.profileForm.inputEmail.$invalid||a.profileForm.inputPhone.$invalid?!0:!1},a.getCurrentUserInfo=function(){d.getCurrentUserInfo().then(function(b){a.userInfo=b.data,0==a.userInfo.is_email_confirmed?a.confirmStatus="未验证":a.confirmStatus="已验证",a.userInfo.user_type==a.userType.normal?a.certStatus="未认证":a.certStatus="已认证"},function(a){401==a.status&&(c.localStorage.loginStatus=!1)})},a.enableUpdateUserInfo=function(){a.userInfoActive=!0},a.disableUpdateUserInfo=function(){a.userInfoActive=!1},a.submitForm=function(){return a.formChanged()?(a.showSpinner=!0,d.setUserInfo(a.userInfo.id,a.userInfo).then(function(b){a.updateAlert(!0,"success","恭喜","个人信息更新成功！"),a.getCurrentUserInfo(),a.userInfoActive=!1},function(b){a.updateAlert(!0,"danger","错误","更新失败！")}),void(a.showSpinner=!1)):void console.log("aaaaa")},a.getCurrentUserInfo(),a.openConfirmationModal=function(c){a.animationsEnabled=!0;b.open({animation:a.animationsEnabled,templateUrl:"accountConfirmationModalContent",controller:"AccountConfirmationCtrl",size:c,resolve:{modalInfo:function(){return{userInfo:a.userInfo,sendConfirmation:a.sendConfirmation,updateAlert:a.updateAlert,getCurrentUserInfo:a.getCurrentUserInfo}}}})}}]),angular.module("mbkportalApp").controller("phoneConfirmCtrl",["$scope","$timeout","user",function(a,b,c){a.smsSent={status:!1},a.getValidation="获取验证码",a.showAlert2=!1,a.alertType2="",a.notifType2="",a.notifMsg2="",a.updateAlert2=function(b,c,d,e){a.showAlert2=b,a.alertType2=c,a.notifType2=d,a.notifMsg2=e},a.closeAlert2=function(){a.showAlert2=!1,a.alertType2="",a.notifType2="",a.notifMsg2=""};var d=120;a.canSendSms=function(){return 0>=d?(a.getValidation="获取验证码",a.smsSent.status=!1,void(d=120)):(a.getValidation="获取验证码("+d+" 秒)",d--,void b(function(){a.canSendSms()},1e3))},a.sendValidateCode=function(){var b={cellphone:a.userInfo.cellphone,tranCode:"confirm"};c.check_cellphone(b).then(function(b){a.smsSent.status=!0,a.updateAlert2(!0,"success","提示：","验证码已发送您的手机，请在5分钟内输入！"),a.canSendSms()},function(b){return 500==b.status?(a.updateAlert(!0,"error","信息发送失败","程序猿们正在玩命抢修中！"),void a.confirmationCancel()):void 0})},a.submitConfirmationForm=function(){var b={cellphone:a.userInfo.cellphone,validateCode:a.validateCode};c.activeuser_phone(b).then(function(b){a.getCurrentUserInfo(),a.updateAlert(!0,"success","恭喜：","账户验证成功!"),a.confirmationCancel()},function(b){if(a.updateAlert2(!0,"error","未知错误：","程序猿们正在玩命抢修中！"),a.confirmRet=b,200!=a.confirmRet.status){if(500==a.confirmRet.status)return void a.updateAlert2(!0,"error","请求失败：","程序猿们正在玩命抢修中！");if(400==a.confirmRet.status)return void a.updateAlert2(!0,"error","请求失败：","程序猿们正在玩命抢修中！");if(408==a.confirmRet.status)return void a.updateAlert2(!0,"warning","提示：","验证码超时，请重新获取，务必在5分钟内输入！");if(406==a.confirmRet.status)return void a.updateAlert2(!0,"warning","提示：","验证码错误，请重新输入！")}})}}]),angular.module("mbkportalApp").controller("AccountConfirmationCtrl",["$scope","$uibModalInstance","modalInfo",function(a,b,c){a.userInfo=c.userInfo,a.updateAlert=c.updateAlert,a.getCurrentUserInfo=c.getCurrentUserInfo,a.emailConfirmationOk=function(){c.sendConfirmation(),b.close()},a.phoneConfirmationOk=function(){c.sendConfirmation(),b.close()},a.confirmationCancel=function(){b.dismiss("cancel")}}]),angular.module("mbkportalApp").controller("PasswordCtrl",["$scope","$window","user","usSpinnerService",function(a,b,c,d){a.updateActive=!0,a.showSpinner=!1,a.showAlert=!1,a.alertType="",a.notifType="",a.notifMsg="",a.updateAlert=function(b,c,d,e){a.showAlert=b,a.alertType=c,a.notifType=d,a.notifMsg=e},a.getCurrentUserInfo=function(){c.getCurrentUserInfo().then(function(b){a.userInfo=b.data},function(a){401==a.status&&(b.localStorage.loginStatus=!1)})},a.getCurrentUserInfo(),a.submitForm=function(){a.showSpinner=!0,c.setUserInfo(a.userInfo.id,a.userInfo).then(function(b){a.updateAlert(!0,"success","恭喜","密码修改成功！"),a.updateActive=!1},function(b){a.updateAlert(!0,"danger","错误","更新失败！")}),a.showSpinner=!1}}]),angular.module("mbkportalApp").controller("CertMgtCtrl",["$scope","$window","user","usSpinnerService","constants","$location",function(a,b,c,d,e,f){a.userInfo={},a.certInfo={},a.certType=e.certType,a.userCertType=a.certType.personal,a.userInfoActive=!1,a.certStatus="",a.noteSwitch=0,a.disableEdit=!1,a.userCertStatus="",a.companyCertStatus="";var g="http://www.placehold.it/200x150/EFEFEF/AAAAAA&amp;text=no+image";a.frontPic=g,a.backPic=g,a.licensePic=g,a.organPic=g,a.showSpinner=!1,a.showAlert=!1,a.alertType="",a.notifType="",a.notifMsg="",a.updateAlert=function(b,c,d,e){a.showAlert=b,a.alertType=c,a.notifType=d,a.notifMsg=e},a.personalCert=function(){a.userCertType=a.certType.personal},a.companyCert=function(){a.userCertType=a.certType.company},a.getQualifiedStatus=function(){b.alert("getQualifiedStatus ")},a.getCurrentUserInfo=function(){c.getCurrentUserInfo().then(function(b){a.userInfo=b.data,a.certInfo.uid=b.data.id},function(a){401==a.status&&(b.localStorage.loginStatus=!1)})},a.getCertStatus=function(){a.showSpinner=!0,c.getCertStatus().then(function(b){a.showSpinner=!1,a.certStatus=b.data,a.certStatus.cert_status==e.certStatus.certTypeNo?console.log("need do nothing yet"):a.certStatus.cert_status==e.certStatus.certTypeUser?(a.noteSwitch=1,a.disableEdit=!0,a.userCertStatus="（审核通过）",a.frontPic=a.certStatus.cert_pic_front,a.backPic=a.certStatus.cert_pic_back,a.certInfo.cert_name=a.certStatus.cert_name):a.certStatus.cert_status==e.certStatus.certTypeUserVerifying?(a.noteSwitch=1,a.disableEdit=!0,a.userCertStatus="（审核中）",a.frontPic=a.certStatus.cert_pic_front,a.backPic=a.certStatus.cert_pic_back,a.certInfo.cert_name=a.certStatus.cert_name):a.certStatus.cert_status==e.certStatus.certTypeCompany?(a.noteSwitch=2,a.disableEdit=!0,a.companyCertStatus="（审核通过）",a.organPic=a.certStatus.org_pic,a.licensePic=a.certStatus.license_pic,a.certInfo.company_name=a.certStatus.company_name,a.certInfo.license_id=a.certStatus.license_id,a.certInfo.org_id=a.certStatus.org_id,a.certInfo.entity_name=a.certStatus.entity_name,a.certInfo.entity_cert_id=a.certStatus.entity_cert_id):a.certStatus.cert_status==e.certStatus.certTypeCompanyVerifying?(a.noteSwitch=2,a.disableEdit=!0,a.companyCertStatus="（审核中）",a.organPic=a.certStatus.org_pic,a.licensePic=a.certStatus.license_pic,a.certInfo.company_name=a.certStatus.company_name,a.certInfo.license_id=a.certStatus.license_id,a.certInfo.org_id=a.certStatus.org_id,a.certInfo.entity_name=a.certStatus.entity_name,a.certInfo.entity_cert_id=a.certStatus.entity_cert_id):a.certStatus.cert_status==e.certStatus.certTypeNoneed&&(a.disableEdit=!0)},function(c){a.showSpinner=!1,401==c.status&&(b.localStorage.loginStatus=!1)})},a.submitForm=function(){return 0==a.userInfo.is_email_confirmed?void a.updateAlert(!0,"warning","警告","账户未验证，请先验证该账户！"):a.certInfo.cert_pic_front?a.certInfo.cert_pic_back?a.certInfo.cert_pic_front.size>e.certFile.maxSize||a.certInfo.cert_pic_back.size>e.certFile.maxSize?void a.updateAlert(!0,"error","提示","上传文件大小须不大于2MB！"):a.certInfo.cert_pic_front.type.split("/")[0]!=e.certFile.type||a.certInfo.cert_pic_back.type.split("/")[0]!=e.certFile.type?void a.updateAlert(!0,"error","提示","请确保上传文件为图片格式！"):(a.showSpinner=!0,c.userCertification(a.certInfo).then(function(b){a.updateAlert(!0,"success","恭喜","认证信息上传成功，我们会在3个工作日内审核处理！"),a.disableEdit=!0},function(b){a.updateAlert(!0,"danger","错误","认证信息上传失败，请耐心等候后台修复！")}),void(a.showSpinner=!1)):void a.updateAlert(!0,"warning","警告","请上传证件反面照片！"):void a.updateAlert(!0,"warning","警告","请上传证件正面照片！")},a.submitFormCom=function(){return 0==a.userInfo.is_email_confirmed?void a.updateAlert(!0,"warning","警告","账户未验证，请先验证该账户！"):a.certInfo.license_pic?a.certInfo.org_pic?a.certInfo.license_pic.size>e.certFile.maxSize||a.certInfo.org_pic.size>e.certFile.maxSize?void a.updateAlert(!0,"error","提示","上传文件大小须不大于2MB！"):a.certInfo.license_pic.type.split("/")[0]!=e.certFile.type||a.certInfo.org_pic.type.split("/")[0]!=e.certFile.type?void a.updateAlert(!0,"error","提示","请确保上传文件为图片格式！"):(a.showSpinner=!0,c.comCertification(a.certInfo).then(function(b){a.updateAlert(!0,"success","恭喜","认证信息上传成功，我们会在3个工作日内审核处理！"),a.disableEdit=!0},function(b){a.updateAlert(!0,"danger","错误","认证信息上传失败，请耐心等候后台修复！")}),void(a.showSpinner=!1)):void a.updateAlert(!0,"warning","警告","请上传公司组织机构照片！"):void a.updateAlert(!0,"warning","警告","请上传公司营业执照照片！")},a.getCurrentUserInfo(),a.getCertStatus()}]),angular.module("mbkportalApp").controller("SubuserMgtCtrl",["$scope","$window","user","usSpinnerService","constants","DTOptionsBuilder","DTColumnDefBuilder","$uibModal","$location",function(a,b,c,d,e,f,g,h,i){a.showSpinner=!1,a.userInfo={},a.companyInfo={},a.userInfo.username="test",a.usersCount=10,a.companyQuota=100,a.companyQuotaUsed=90,a.devicesUsed=10,a.actions={},a.subusers={},a.checkStatus={},a.checkStatus.checkAll=!1,a.checkStatus.clickCheckAll=function(){if(0==a.checkStatus.checkAll)for(var b=0;b<a.subusers.subusers.length;b++)a.subusers.subusers[b].checked=!1;else for(var b=0;b<a.subusers.subusers.length;b++)a.subusers.subusers[b].checked=!0},a.checkStatus.updateCheckAll=function(){for(var b=0;b<a.subusers.subusers.length;b++)if(0==a.subusers.subusers[b].checked)return void(a.checkStatus.checkAll=!1);a.checkStatus.checkAll=!0},a.clickCheck=function(b){for(var c=0;c<a.subusers.subusers.length;c++)a.subusers.subusers[c].id==b&&(0==a.subusers.subusers[c].checked?a.checkStatus.updateCheckAll():a.checkStatus.updateCheckAll())},a.showAlert=!1,a.alertType="",a.notifType="",a.notifMsg="",a.updateAlert=function(b,c,d,e){a.showAlert=b,a.alertType=c,a.notifType=d,a.notifMsg=e},a.dtOptions=f.newOptions().withLanguage({sProcessing:"处理中...",sLengthMenu:"显示 _MENU_ 项结果",sZeroRecords:"没有匹配结果",sInfo:"显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项",sInfoEmpty:"显示第 0 至 0 项结果，共 0 项",sInfoFiltered:"(由 _MAX_ 项结果过滤)",sInfoPostFix:"",sSearch:"搜索:",sUrl:"",sEmptyTable:"表中数据为空",sLoadingRecords:"载入中...",sInfoThousands:",",oPaginate:{sFirst:"首页",sPrevious:"上页",sNext:"下页",sLast:"末页"},oAria:{sSortAscending:": 以升序排列此列",sSortDescending:": 以降序排列此列"}}),a.certmgt=function(){i.path("certmgt")},a.getCurrentUserInfo=function(){a.showSpinner=!0,c.getCurrentUserInfo().then(function(b){a.userInfo=b.data,a.getCompanyInfo(a.userInfo.cid)},function(a){401==a.status&&(b.localStorage.loginStatus=!1)}),a.showSpinner=!1},a.getSubuserInfo=function(){a.showSpinner=!0,c.getSubuserInfo().then(function(b){a.subusers=b.data;for(var c=0;c<a.subusers.subusers.length;c++)a.subusers.subusers[c].checked=!1},function(a){401==a.status&&(b.localStorage.loginStatus=!1)}),a.showSpinner=!1},a.getCompanyInfo=function(d){a.showSpinner=!0,c.getCompanyInfo(d).then(function(b){a.companyInfo=b.data,a.showSpinner=!1},function(a){401==a.status?b.localStorage.loginStatus=!1:500==a.status&&b.alert("获取认证信息失败，程序猿正在抢修中！")}),a.showSpinner=!1},a.createsubuser=function(d){a.showSpinner=!0,c.createsubuser(d).then(function(b){a.showSpinner=!1,a.getSubuserInfo(),a.getCompanyInfo(a.userInfo.cid)},function(c){401==c.status?b.localStorage.loginStatus=!1:500==c.status?b.alert("创建用户失败，程序猿正在抢修中！"):413==c.status&&b.alert("创建用户失败，备份配额不足，请获取更大的配额！"),a.showSpinner=!1,a.getSubuserInfo(),a.getCompanyInfo(a.userInfo.cid)})},a.subuserStatus=function(d){a.showSpinner=!0,c.subuserStatus(d).then(function(b){a.updateAlert(!0,"success","提示","用户状态更新成功！"),a.showSpinner=!1,a.getSubuserInfo()},function(c){401==c.status?b.localStorage.loginStatus=!1:500==c.status&&b.alert("更新用户状态失败，程序猿正在抢修中！"),a.showSpinner=!1,a.getSubuserInfo()})},a.deleteSubuser=function(d){a.showSpinner=!0,c.deleteSubuser(d).then(function(b){a.showSpinner=!1,a.getSubuserInfo(),a.getCompanyInfo(a.userInfo.cid)},function(c){401==c.status?b.localStorage.loginStatus=!1:500==c.status?b.alert("删除用户失败，程序猿正在抢修中！"):406==c.status&&(c.data.ret==e.restRet.errUserNotFrozen?a.updateAlert(!0,"warning","警告","无法删除非冻结用户！"):c.data.ret==e.restRet.errUserInFrozen?a.updateAlert(!0,"warning","警告","无法删除在冻结期内的用户！"):c.data.ret==e.restRet.errUserSame&&a.updateAlert(!0,"warning","警告","不能删除管理员！")),a.showSpinner=!1,a.getSubuserInfo(),a.getCompanyInfo(a.userInfo.cid)})},a.updateQuota=function(d){a.showSpinner=!0,c.updateQuota(d).then(function(b){a.showSpinner=!1,a.getSubuserInfo(),a.getCompanyInfo(a.userInfo.cid)},function(c){401==c.status?b.localStorage.loginStatus=!1:500==c.status?b.alert("删除用户失败，程序猿正在抢修中！"):413==c.status&&a.updateAlert(!0,"warning","分配失败","备份空间不足！"),a.showSpinner=!1,a.getSubuserInfo(),a.getCompanyInfo(a.userInfo.cid)})},a.setSubuserStatus=function(d){a.showSpinner=!0;for(var e=0;e<a.subusers.subusers.length;e++)if(1==a.subusers.subusers[e].checked){var f={uid:a.subusers.subusers[e].id,status:d};c.subuserStatus(f).then(function(b){a.updateAlert(!0,"success","提示","用户状态更新成功！")},function(a){401==a.status?b.localStorage.loginStatus=!1:500==a.status&&b.alert("更新用户状态失败，程序猿正在抢修中！")})}a.showSpinner=!1,a.getSubuserInfo()},a.delSubuser=function(){a.showSpinner=!0;for(var d=0;d<a.subusers.subusers.length;d++)if(1==a.subusers.subusers[d].checked){var f=a.subusers.subusers[d].id;c.deleteSubuser(f).then(function(a){},function(c){401==c.status?b.localStorage.loginStatus=!1:500==c.status?b.alert("删除用户失败，程序猿正在抢修中！"):406==c.status&&(c.data.ret==e.restRet.errUserNotFrozen?a.updateAlert(!0,"warning","警告","无法删除非冻结用户！"):c.data.ret==e.restRet.errUserInFrozen?a.updateAlert(!0,"warning","警告","无法删除在冻结期内的用户！"):c.data.ret==e.restRet.errUserSame&&a.updateAlert(!0,"warning","警告","不能删除管理员！"))})}a.showSpinner=!1,a.getSubuserInfo(),a.getCompanyInfo(a.userInfo.cid)},a.subuserDelete=function(b){a.deleteSubuser(b),a.getSubuserInfo()},a.subuserDisable=function(b){a.subuserStatus({uid:b,status:0})},a.subuserEnable=function(b){a.subuserStatus({uid:b,status:1})},a.actions.addSubuser=function(){var b=h.open({templateUrl:"myModalContent.html",controller:"ModalInstanceCtrl",size:"md",resolve:{modalInfo:function(){return{userInfo:a.userInfo,companyInfo:a.companyInfo}}}});b.result.then(function(b){a.createsubuser(b)},function(){console.info("Modal dismissed at: "+new Date)})},a.actions.updateQuota=function(b){var c=h.open({templateUrl:"updateQuota.html",controller:"UpdateQuotaCtrl",size:"md",resolve:{modalInfo:function(){return{userInfo:a.userInfo,companyInfo:a.companyInfo}}}});c.result.then(function(c){var d={uid:b,quota:parseInt(c,10)};a.updateQuota(d)},function(){console.info("Modal dismissed at: "+new Date)})},a.getCurrentUserInfo(),a.getSubuserInfo()}]),angular.module("mbkportalApp").controller("ModalInstanceCtrl",ModalInstanceCtrl),ModalInstanceCtrl.$inject=["$scope","$uibModalInstance","modalInfo"],angular.module("mbkportalApp").controller("UpdateQuotaCtrl",UpdateQuotaCtrl),UpdateQuotaCtrl.$inject=["$scope","$uibModalInstance","modalInfo"],angular.module("mbkportalApp").controller("ChanneluserMgtCtrl",["$scope","$window","user","usSpinnerService","constants","DTOptionsBuilder","DTColumnDefBuilder","$uibModal","$location",function(a,b,c,d,e,f,g,h,i){a.showSpinner=!1,a.userInfo={},a.companyInfo={},a.userInfo.username="test",a.usersCount=10,a.companyQuota=100,a.companyQuotaUsed=90,a.devicesUsed=10,a.actions={},a.subusers={},a.checkStatus={},a.checkStatus.checkAll=!1,a.checkStatus.clickCheckAll=function(){if(0==a.checkStatus.checkAll)for(var b=0;b<a.subusers.subusers.length;b++)a.subusers.subusers[b].checked=!1;else for(var b=0;b<a.subusers.subusers.length;b++)a.subusers.subusers[b].checked=!0},a.checkStatus.updateCheckAll=function(){for(var b=0;b<a.subusers.subusers.length;b++)if(0==a.subusers.subusers[b].checked)return void(a.checkStatus.checkAll=!1);a.checkStatus.checkAll=!0},a.clickCheck=function(b){for(var c=0;c<a.subusers.subusers.length;c++)a.subusers.subusers[c].id==b&&(0==a.subusers.subusers[c].checked?a.checkStatus.updateCheckAll():a.checkStatus.updateCheckAll())},a.showAlert=!1,a.alertType="",a.notifType="",a.notifMsg="",a.updateAlert=function(b,c,d,e){a.showAlert=b,a.alertType=c,a.notifType=d,a.notifMsg=e},a.dtOptions=f.newOptions().withLanguage({sProcessing:"处理中...",sLengthMenu:"显示 _MENU_ 项结果",sZeroRecords:"没有匹配结果",sInfo:"显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项",sInfoEmpty:"显示第 0 至 0 项结果，共 0 项",sInfoFiltered:"(由 _MAX_ 项结果过滤)",sInfoPostFix:"",sSearch:"搜索:",sUrl:"",sEmptyTable:"表中数据为空",sLoadingRecords:"载入中...",sInfoThousands:",",oPaginate:{sFirst:"首页",sPrevious:"上页",sNext:"下页",sLast:"末页"},oAria:{sSortAscending:": 以升序排列此列",sSortDescending:": 以降序排列此列"}}),a.getCurrentUserInfo=function(){a.showSpinner=!0,c.getCurrentUserInfo().then(function(b){a.userInfo=b.data,a.getCompanyInfo()},function(a){401==a.status&&(b.localStorage.loginStatus=!1)}),a.showSpinner=!1},a.getSubuserInfo=function(){a.showSpinner=!0,c.clgetSubuserInfo().then(function(b){a.subusers=b.data;for(var c=0;c<a.subusers.subusers.length;c++)a.subusers.subusers[c].checked=!1},function(a){401==a.status&&(b.localStorage.loginStatus=!1)}),a.showSpinner=!1},a.getCompanyInfo=function(){a.showSpinner=!0,c.clgetCompanyInfo().then(function(b){a.companyInfo=b.data,a.showSpinner=!1},function(a){401==a.status?b.localStorage.loginStatus=!1:500==a.status&&b.alert("获取认证信息失败，程序猿正在抢修中！")}),a.showSpinner=!1},a.createsubuser=function(d){a.showSpinner=!0,c.clcreatesubuser(d).then(function(b){a.showSpinner=!1,a.getSubuserInfo(),a.getCompanyInfo()},function(c){401==c.status?b.localStorage.loginStatus=!1:500==c.status?b.alert("创建用户失败，程序猿正在抢修中！"):413==c.status&&b.alert("创建用户失败，备份配额不足，请获取更大的配额！"),a.showSpinner=!1,a.getSubuserInfo(),a.getCompanyInfo()})},a.subuserStatus=function(d){a.showSpinner=!0,c.clsubuserStatus(d).then(function(b){a.updateAlert(!0,"success","提示","用户状态更新成功！"),a.showSpinner=!1,a.getSubuserInfo()},function(c){401==c.status?b.localStorage.loginStatus=!1:500==c.status&&b.alert("更新用户状态失败，程序猿正在抢修中！"),a.showSpinner=!1,a.getSubuserInfo()})},a.deleteSubuser=function(d){a.showSpinner=!0,c.cldeleteSubuser(d).then(function(b){a.showSpinner=!1,a.getSubuserInfo(),a.getCompanyInfo()},function(c){401==c.status?b.localStorage.loginStatus=!1:500==c.status?b.alert("删除用户失败，程序猿正在抢修中！"):406==c.status&&(c.data.ret==e.restRet.errUserNotFrozen?a.updateAlert(!0,"warning","警告","无法删除非冻结用户！"):c.data.ret==e.restRet.errUserInFrozen?a.updateAlert(!0,"warning","警告","无法删除在冻结期内的用户！"):c.data.ret==e.restRet.errUserSame&&a.updateAlert(!0,"warning","警告","不能删除管理员！")),a.showSpinner=!1,a.getSubuserInfo(),a.getCompanyInfo()})},a.updateQuota=function(d){a.showSpinner=!0,c.clupdateQuota(d).then(function(b){a.showSpinner=!1,a.getSubuserInfo(),a.getCompanyInfo()},function(c){401==c.status?b.localStorage.loginStatus=!1:500==c.status?b.alert("删除用户失败，程序猿正在抢修中！"):413==c.status&&a.updateAlert(!0,"warning","分配失败","备份空间不足！"),a.showSpinner=!1,a.getSubuserInfo(),a.getCompanyInfo()})},a.setSubuserStatus=function(d){a.showSpinner=!0;for(var e=0;e<a.subusers.subusers.length;e++)if(1==a.subusers.subusers[e].checked){var f={cid:a.subusers.subusers[e].cid,status:d};c.clsubuserStatus(f).then(function(b){a.updateAlert(!0,"success","提示","用户状态更新成功！")},function(a){401==a.status?b.localStorage.loginStatus=!1:500==a.status&&b.alert("更新用户状态失败，程序猿正在抢修中！")})}a.showSpinner=!1,a.getSubuserInfo()},a.delSubuser=function(){a.showSpinner=!0;for(var d=0;d<a.subusers.subusers.length;d++)if(1==a.subusers.subusers[d].checked){var f=a.subusers.subusers[d].cid;c.cldeleteSubuser(f).then(function(a){},function(c){401==c.status?b.localStorage.loginStatus=!1:500==c.status?b.alert("删除用户失败，程序猿正在抢修中！"):406==c.status&&(c.data.ret==e.restRet.errUserNotFrozen?a.updateAlert(!0,"warning","警告","无法删除非冻结用户！"):c.data.ret==e.restRet.errUserInFrozen?a.updateAlert(!0,"warning","警告","无法删除在冻结期内的用户！"):c.data.ret==e.restRet.errUserSame&&a.updateAlert(!0,"warning","警告","不能删除管理员！"))})}a.showSpinner=!1,a.getSubuserInfo(),a.getCompanyInfo()},a.subuserDelete=function(b){a.deleteSubuser(b),a.getSubuserInfo()},a.subuserDisable=function(b){a.subuserStatus({cid:b,status:0})},a.subuserEnable=function(b){a.subuserStatus({cid:b,status:1})},a.actions.addSubuser=function(){var b=h.open({templateUrl:"myModalContent.html",controller:"ModalInstanceCtrl",size:"md",resolve:{modalInfo:function(){return{userInfo:a.userInfo,companyInfo:a.companyInfo}}}});b.result.then(function(b){b.quota=parseInt(b.quota,10),a.createsubuser(b)},function(){console.info("Modal dismissed at: "+new Date)})},a.actions.updateQuota=function(b){var c=h.open({templateUrl:"updateQuota.html",controller:"UpdateQuotaCtrl",size:"md",resolve:{modalInfo:function(){return{userInfo:a.userInfo,companyInfo:a.companyInfo}}}});c.result.then(function(c){var d={cid:b,quota:parseInt(c,10)};a.updateQuota(d)},function(){console.info("Modal dismissed at: "+new Date);
})},a.getCurrentUserInfo(),a.getSubuserInfo()}]),angular.module("mbkportalApp").controller("CreateChannelUserCtrl",CreateChannelUserCtrl),CreateChannelUserCtrl.$inject=["$scope","$uibModalInstance","modalInfo"],angular.module("mbkportalApp").controller("UpdateUserQuotaCtrl",UpdateUserQuotaCtrl),UpdateUserQuotaCtrl.$inject=["$scope","$uibModalInstance","modalInfo"],angular.module("mbkportalApp").controller("ChannelcompanyMgtCtrl",["$scope","$window","user","usSpinnerService","constants","DTOptionsBuilder","DTColumnDefBuilder","$uibModal","$location",function(a,b,c,d,e,f,g,h,i){a.showSpinner=!1,a.userInfo={},a.companyInfo={},a.userInfo.username="test",a.usersCount=10,a.companyQuota=100,a.companyQuotaUsed=90,a.devicesUsed=10,a.actions={},a.subusers={},a.checkStatus={},a.checkStatus.checkAll=!1,a.checkStatus.clickCheckAll=function(){if(0==a.checkStatus.checkAll)for(var b=0;b<a.subusers.subusers.length;b++)a.subusers.subusers[b].checked=!1;else for(var b=0;b<a.subusers.subusers.length;b++)a.subusers.subusers[b].checked=!0},a.checkStatus.updateCheckAll=function(){for(var b=0;b<a.subusers.subusers.length;b++)if(0==a.subusers.subusers[b].checked)return void(a.checkStatus.checkAll=!1);a.checkStatus.checkAll=!0},a.clickCheck=function(b){for(var c=0;c<a.subusers.subusers.length;c++)a.subusers.subusers[c].id==b&&(0==a.subusers.subusers[c].checked?a.checkStatus.updateCheckAll():a.checkStatus.updateCheckAll())},a.showAlert=!1,a.alertType="",a.notifType="",a.notifMsg="",a.updateAlert=function(b,c,d,e){a.showAlert=b,a.alertType=c,a.notifType=d,a.notifMsg=e},a.dtOptions=f.newOptions().withLanguage({sProcessing:"处理中...",sLengthMenu:"显示 _MENU_ 项结果",sZeroRecords:"没有匹配结果",sInfo:"显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项",sInfoEmpty:"显示第 0 至 0 项结果，共 0 项",sInfoFiltered:"(由 _MAX_ 项结果过滤)",sInfoPostFix:"",sSearch:"搜索:",sUrl:"",sEmptyTable:"表中数据为空",sLoadingRecords:"载入中...",sInfoThousands:",",oPaginate:{sFirst:"首页",sPrevious:"上页",sNext:"下页",sLast:"末页"},oAria:{sSortAscending:": 以升序排列此列",sSortDescending:": 以降序排列此列"}}),a.getCurrentUserInfo=function(){a.showSpinner=!0,c.getCurrentUserInfo().then(function(b){a.userInfo=b.data,a.getCompanyInfo()},function(a){401==a.status&&(b.localStorage.loginStatus=!1)}),a.showSpinner=!1},a.getSubuserInfo=function(){a.showSpinner=!0,c.clgetSubcomInfo().then(function(b){a.subusers=b.data;for(var c=0;c<a.subusers.subusers.length;c++)a.subusers.subusers[c].checked=!1},function(a){401==a.status&&(b.localStorage.loginStatus=!1)}),a.showSpinner=!1},a.getCompanyInfo=function(){a.showSpinner=!0,c.clgetCompanyInfo().then(function(b){a.companyInfo=b.data,a.showSpinner=!1},function(a){401==a.status?b.localStorage.loginStatus=!1:500==a.status&&b.alert("获取认证信息失败，程序猿正在抢修中！")}),a.showSpinner=!1},a.createsubuser=function(d){a.showSpinner=!0,c.clcreatecompany(d).then(function(b){a.showSpinner=!1,a.getSubuserInfo(),a.getCompanyInfo()},function(c){401==c.status?b.localStorage.loginStatus=!1:500==c.status?b.alert("创建用户失败，程序猿正在抢修中！"):413==c.status&&b.alert("创建用户失败，备份配额不足，请获取更大的配额！"),a.showSpinner=!1,a.getSubuserInfo(),a.getCompanyInfo()})},a.subuserStatus=function(d){a.showSpinner=!0,c.clsubuserStatus(d).then(function(b){a.updateAlert(!0,"success","提示","用户状态更新成功！"),a.showSpinner=!1,a.getSubuserInfo()},function(c){401==c.status?b.localStorage.loginStatus=!1:500==c.status&&b.alert("更新用户状态失败，程序猿正在抢修中！"),a.showSpinner=!1,a.getSubuserInfo()})},a.deleteSubuser=function(d){a.showSpinner=!0,c.cldeleteSubuser(d).then(function(b){a.showSpinner=!1,a.getSubuserInfo(),a.getCompanyInfo()},function(c){401==c.status?b.localStorage.loginStatus=!1:500==c.status?b.alert("删除用户失败，程序猿正在抢修中！"):406==c.status&&(c.data.ret==e.restRet.errUserNotFrozen?a.updateAlert(!0,"warning","警告","无法删除非冻结用户！"):c.data.ret==e.restRet.errUserInFrozen?a.updateAlert(!0,"warning","警告","无法删除在冻结期内的用户！"):c.data.ret==e.restRet.errUserSame&&a.updateAlert(!0,"warning","警告","不能删除管理员！")),a.showSpinner=!1,a.getSubuserInfo(),a.getCompanyInfo()})},a.updateQuota=function(d){a.showSpinner=!0,c.clupdateQuota(d).then(function(b){a.showSpinner=!1,a.getSubuserInfo(),a.getCompanyInfo()},function(c){401==c.status?b.localStorage.loginStatus=!1:500==c.status?b.alert("删除用户失败，程序猿正在抢修中！"):413==c.status&&a.updateAlert(!0,"warning","分配失败","备份空间不足！"),a.showSpinner=!1,a.getSubuserInfo(),a.getCompanyInfo()})},a.setSubuserStatus=function(d){a.showSpinner=!0;for(var e=0;e<a.subusers.subusers.length;e++)if(1==a.subusers.subusers[e].checked){var f={cid:a.subusers.subusers[e].cid,status:d};c.clsubuserStatus(f).then(function(b){a.updateAlert(!0,"success","提示","用户状态更新成功！")},function(a){401==a.status?b.localStorage.loginStatus=!1:500==a.status&&b.alert("更新用户状态失败，程序猿正在抢修中！")})}a.showSpinner=!1,a.getSubuserInfo()},a.delSubuser=function(){a.showSpinner=!0;for(var d=0;d<a.subusers.subusers.length;d++)if(1==a.subusers.subusers[d].checked){var f=a.subusers.subusers[d].cid;c.cldeleteSubuser(f).then(function(a){},function(c){401==c.status?b.localStorage.loginStatus=!1:500==c.status?b.alert("删除用户失败，程序猿正在抢修中！"):406==c.status&&(c.data.ret==e.restRet.errUserNotFrozen?a.updateAlert(!0,"warning","警告","无法删除非冻结用户！"):c.data.ret==e.restRet.errUserInFrozen?a.updateAlert(!0,"warning","警告","无法删除在冻结期内的用户！"):c.data.ret==e.restRet.errUserSame&&a.updateAlert(!0,"warning","警告","不能删除管理员！"))})}a.showSpinner=!1,a.getSubuserInfo(),a.getCompanyInfo()},a.subuserDelete=function(b){a.deleteSubuser(b),a.getSubuserInfo()},a.subuserDisable=function(b){a.subuserStatus({cid:b,status:0})},a.subuserEnable=function(b){a.subuserStatus({cid:b,status:1})},a.actions.addSubuser=function(){var b=h.open({templateUrl:"myModalContent.html",controller:"ModalInstanceCtrl",size:"md",resolve:{modalInfo:function(){return{userInfo:a.userInfo,companyInfo:a.companyInfo}}}});b.result.then(function(b){b.quota=parseInt(b.quota,10),a.createsubuser(b)},function(){console.info("Modal dismissed at: "+new Date)})},a.actions.updateQuota=function(b){var c=h.open({templateUrl:"updateQuota.html",controller:"UpdateQuotaCtrl",size:"md",resolve:{modalInfo:function(){return{userInfo:a.userInfo,companyInfo:a.companyInfo}}}});c.result.then(function(c){var d={cid:b,quota:parseInt(c,10)};a.updateQuota(d)},function(){console.info("Modal dismissed at: "+new Date)})},a.getCurrentUserInfo(),a.getSubuserInfo()}]),angular.module("mbkportalApp").controller("CreateChannelCompanyCtrl",CreateChannelCompanyCtrl),CreateChannelCompanyCtrl.$inject=["$scope","$uibModalInstance","modalInfo"],angular.module("mbkportalApp").controller("UpdateCompanyQuotaCtrl",UpdateCompanyQuotaCtrl),UpdateCompanyQuotaCtrl.$inject=["$scope","$uibModalInstance","modalInfo"],angular.module("mbkportalApp").filter("fileSize",function(){return function(a,b){if(isNaN(parseFloat(a))||!isFinite(a))return"-";"undefined"==typeof b&&(b=2);var c=["Bytes","KB","MB","GB","TB","PB"],d=a?Math.floor(Math.log(a)/Math.log(1024)):0;return(a/Math.pow(1024,Math.floor(d))).toFixed(b)+" "+c[d]}}),angular.module("mbkportalApp").controller("taskhistoryCtrl",["$scope","$stateParams","backup_service","DTOptionsBuilder","DTColumnDefBuilder","constants","usSpinnerService","$timeout","user","$uibModal",function(a,b,c,d,e,f,g,h,i,j){a.taskId=b.taskId,a.deviceId=b.deviceId,a.showSpinner=!1,a.companyQuota=100,a.companyQuotaUsed=90,a.actions=[],a.modals={},a.updateAlert=function(b,c,d,e){a.showAlert=b,a.alertType=c,a.notifType=d,a.notifMsg=e,h(function(){a.showAlert=!1},3e3)},a.backToDeviceList=function(){window.location="#/deviceList/"+a.deviceId},a.opts={isLeaf:function(a){return"dir"!=a.type}},a.dtOptions=d.newOptions().withLanguage({sProcessing:"处理中...",sLengthMenu:"显示 _MENU_ 项结果",sZeroRecords:"没有匹配结果",sInfo:"显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项",sInfoEmpty:"显示第 0 至 0 项结果，共 0 项",sInfoFiltered:"(由 _MAX_ 项结果过滤)",sInfoPostFix:"",sSearch:"搜索:",sUrl:"",sEmptyTable:"表中数据为空",sLoadingRecords:"载入中...",sInfoThousands:",",oPaginate:{sFirst:"首页",sPrevious:"上页",sNext:"下页",sLast:"末页"},oAria:{sSortAscending:": 以升序排列此列",sSortDescending:": 以降序排列此列"}}).withOption("order",[0,"desc"]),a.dtColumnDefs=[e.newColumnDef(3).notSortable()];a.logActionListIndex=function(a){for(var b=[],c=0,d=a.length;d>c;c++){var e=a[c];void 0!==e.statistics.total_dirs&&b.push(c)}return b},a.filterActionList=function(a){var b=a.statistics.total_dirs;return void 0===b?!1:!0},a.getInfoOfTask=function(b){a.showSpinner=!0,c.getInfoOfTask(b).then(function(b){a.treedata=[];for(var c=0;c<b.length;c++){var d=b[c].dir_layout,e=[{name:d.length?"我的电脑":"空",children:d.length?d:[],type:"dir"}];a.treedata.push(e),b[c].mapStatus=a.translateBackupStatus(b[c].statistics,b[c].date_backuped),"备份失败"==b[c].mapStatus?b[c].isSuccess=!1:b[c].isSuccess=!0}var f=a.logActionListIndex(b);console.log("indexShow: "+f),a.actions=b},function(a){console.log("error"),concole.log(a)}),a.showSpinner=!1},a.translateBackupStatus=function(a,b){var c="",d=void 0===a.errcode?a.errocode:a.errcode;return void 0===d?c="正在备份":0!==d?c="备份失败":0!==d||b?0===d&&b&&(c="备份成功"):c="正在备份",c},a.deleteBackup=function(b){a.showSpinner=!0;for(var d=0;d<a.actions.length;++d)a.actions[d].id==b&&(a.actions[d].mapStatus="正在删除",a.actions[d].is_deleted=!0);c.deleteBackup(b).then(function(c){for(var d=0;d<a.actions.length;++d)a.actions[d].id==b&&(a.actions[d].mapStatus="删除成功 ");a.updateAlert(!0,"success","提示：","删除备份成功！"),a.getInfoOfTask(a.taskId),a.showSpinner=!1},function(c){for(var d=0;d<a.actions.length;++d)a.actions[d].id==b&&(a.actions[d].mapStatus="删除失败 ",a.actions[d].is_deleted=!1,a.actions[d].isSuccess=!1);console.log("error"),console.log(c),a.updateAlert(!0,"warning","提示：","删除备份失败！"),a.showSpinner=!1})},a.getInfoOfTask(a.taskId),a.getUserQuotaInfo=function(){i.getUserQuotaInfo().then(function(b){b.data;a.companyQuota=b.quota,a.companyQuotaUsed=b.storage_used},function(a){console.log("error"),console.log(a)})},a.getUserQuotaInfo(),a.modals.deleteBackup=function(b){var c=j.open({templateUrl:"modalDeleteBackup.html",controller:"modalDeleteBackupCtrl",size:"sm",resolve:{modalInfo:function(){return{backupId:b}}}});c.result.then(function(b){a.deleteBackup(b)},function(){console.info("Modal dismissed at: "+new Date)})}}]).controller("modalDeleteBackupCtrl",["$scope","$uibModalInstance","modalInfo",function(a,b,c){a.backupId=c.backupId,a.ok=function(){b.close(a.backupId)},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("mbkportalApp").controller("dashboardCtrl",["$scope","$stateParams",function(a,b){console.log("this is the controller for dashboard")}]),angular.module("mbkportalApp").directive("login",function(){return{templateUrl:"views/login.html",restrict:"E",link:function(a,b,c){a.$on("event:unauthorized",function(b){a.show=!0}),a.$on("event:authenticated",function(b){a.show=!1});var d=angular.element(document.getElementById("submitButton"));d.bind("click",function(){a.$emit("event:authenticate",a.user.email,a.user.password)})}}}),angular.module("mbkportalApp").service("user",["$http","$q","config","utils",function(a,b,c,d){return{getCurrentUserInfo:function(){var d=b.defer();return a({method:"GET",url:c.host+"/api/user/info/"}).success(function(a,b,c,e){var f={};f.data=a,f.status=b,d.resolve(f)}).error(function(a,b,c,e){var f={};f.data=a,f.status=b,d.reject(f)}),d.promise},setUserInfo:function(d,e){var f=b.defer();return a({method:"PUT",url:c.host+"/api/user/"+d+"/",data:e}).success(function(a,b,c,d){f.resolve(a)}).error(function(a,b,c,d){var e={};e.data=a,e.status=b,f.reject(e)}),f.promise},signupUser:function(d){var e=b.defer();return a({method:"POST",url:c.host+"/api/user/signup/",data:d}).success(function(a,b,c,d){var f={};f.data=a,f.status=b,e.resolve(f)}).error(function(a,b,c,d){var f={};f.data=a,f.status=b,e.reject(f)}),e.promise},loginUser:function(e){var f={grant_type:c.grant_type,username:e.email,client_id:c.client_id,client_secret:c.client_secret,password:e.password,captcha:e.captchaCode},g=b.defer();return a({method:"POST",url:c.host+"/api/user/ologin/",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:d.formURLEncode,data:f}).success(function(a,b,c,d){var e={};e.data=a,e.status=b,g.resolve(e)}).error(function(a,b,c,d){var e={};e.data=a,e.status=b,g.reject(e)}),g.promise},logoutUser:function(){var d=b.defer();return a({method:"POST",url:c.host+"/api/user/logout/"}).success(function(a,b,c,e){var f={};f.data=a,f.status=b,d.resolve(f)}).error(function(a,b,c,e){var f={};f.data=a,f.status=b,d.reject(f)}),d.promise},forgetpassword:function(d,e){var f=b.defer();return a({method:"POST",url:c.host+"/api/user/forgetpwd/?step="+e,data:d}).success(function(a,b,c,d){var e={};e.data=a,e.status=b,f.resolve(e)}).error(function(a,b,c,d){var e={};e.data=a,e.status=b,f.reject(e)}),f.promise},check_cellphone:function(d){var e=b.defer();return a({method:"POST",url:c.host+"/api/user/check_cellphone/",data:d}).success(function(a,b,c,d){var f={};f.data=a,f.status=b,e.resolve(f)}).error(function(a,b,c,d){var f={};f.data=a,f.status=b,e.reject(f)}),e.promise},activeuser_phone:function(d){var e=b.defer();return a({method:"POST",url:c.host+"/api/user/active_cellphone/",data:d}).success(function(a,b,c,d){var f={};f.data=a,f.status=b,e.resolve(f)}).error(function(a,b,c,d){var f={};f.data=a,f.status=b,e.reject(f)}),e.promise},getcaptcha:function(d,e,f){var g=b.defer();return a({method:"GET",url:c.host+"/api/user/captcha/?username="+d+"&captcha_type="+e+"&update="+f}).success(function(a,b,c,d){var e={};e.data=a,e.status=b,g.resolve(e)}).error(function(a,b,c,d){var e={};e.data=a,e.status=b,g.reject(e)}),g.promise},sendConfirmEmail:function(d){var e=b.defer();return a({method:"POST",url:c.host+"/api/user/userconfirm/",data:d}).success(function(a,b,c,d){var f={};f.data=a,f.status=b,e.resolve(f)}).error(function(a,b,c,d){var f={};f.data=a,f.status=b,e.reject(f)}),e.promise},userCertification:function(d){var e=b.defer();return a({method:"POST",url:c.host+"/api/user/user_certification/",data:d}).success(function(a,b,c,d){var f={};f.data=a,f.status=b,e.resolve(f)}).error(function(a,b,c,d){var f={};f.data=a,f.status=b,e.reject(f)}),e.promise},comCertification:function(d){var e=b.defer();return a({method:"POST",url:c.host+"/api/user/company_certification/",data:d}).success(function(a,b,c,d){var f={};f.data=a,f.status=b,e.resolve(f)}).error(function(a,b,c,d){var f={};f.data=a,f.status=b,e.reject(f)}),e.promise},getCertStatus:function(){var d=b.defer();return a({method:"GET",url:c.host+"/api/user/certstatus/"}).success(function(a,b,c,e){var f={};f.data=a,f.status=b,d.resolve(f)}).error(function(a,b,c,e){var f={};f.data=a,f.status=b,d.reject(f)}),d.promise},getSubuserInfo:function(){var d=b.defer();return a({method:"GET",url:c.host+"/api/user/subusers/"}).success(function(a,b,c,e){var f={};f.data=a,f.status=b,d.resolve(f)}).error(function(a,b,c,e){var f={};f.data=a,f.status=b,d.reject(f)}),d.promise},clgetSubuserInfo:function(){var d=b.defer();return a({method:"GET",url:c.host+"/api/user/channel/channel_users/"}).success(function(a,b,c,e){var f={};f.data=a,f.status=b,d.resolve(f)}).error(function(a,b,c,e){var f={};f.data=a,f.status=b,d.reject(f)}),d.promise},clgetSubcomInfo:function(){var d=b.defer();return a({method:"GET",url:c.host+"/api/user/channel/channel_companys/"}).success(function(a,b,c,e){var f={};f.data=a,f.status=b,d.resolve(f)}).error(function(a,b,c,e){var f={};f.data=a,f.status=b,d.reject(f)}),d.promise},createsubuser:function(d){var e=b.defer();return a({method:"POST",url:c.host+"/api/user/subuser/",data:d}).success(function(a,b,c,d){var f={};f.data=a,f.status=b,e.resolve(f)}).error(function(a,b,c,d){var f={};f.data=a,f.status=b,e.reject(f)}),e.promise},clcreatesubuser:function(d){var e=b.defer();return a({method:"POST",url:c.host+"/api/user/channel/channel_user/",data:d}).success(function(a,b,c,d){var f={};f.data=a,f.status=b,e.resolve(f)}).error(function(a,b,c,d){var f={};f.data=a,f.status=b,e.reject(f)}),e.promise},clcreatecompany:function(d){var e=b.defer();return a({method:"POST",url:c.host+"/api/user/channel/channel_company/",data:d}).success(function(a,b,c,d){var f={};f.data=a,f.status=b,e.resolve(f)}).error(function(a,b,c,d){var f={};f.data=a,f.status=b,e.reject(f)}),e.promise},getCompanyInfo:function(){var d=b.defer();return a({method:"GET",url:c.host+"/api/company/info/"}).success(function(a,b,c,e){var f={};f.data=a,f.status=b,d.resolve(f)}).error(function(a,b,c,e){var f={};f.data=a,f.status=b,d.reject(f)}),d.promise},clgetCompanyInfo:function(){var d=b.defer();return a({method:"GET",url:c.host+"/api/channel/info/"}).success(function(a,b,c,e){var f={};f.data=a,f.status=b,d.resolve(f)}).error(function(a,b,c,e){var f={};f.data=a,f.status=b,d.reject(f)}),d.promise},subuserStatus:function(d){var e=b.defer();return a({method:"PUT",url:c.host+"/api/user/subuser/status",data:d}).success(function(a,b,c,d){var f={};f.data=a,f.status=b,e.resolve(f)}).error(function(a,b,c,d){var f={};f.data=a,f.status=b,e.reject(f)}),e.promise},clsubuserStatus:function(d){var e=b.defer();return a({method:"PUT",url:c.host+"/api/user/channel/channel_user/status/",data:d}).success(function(a,b,c,d){var f={};f.data=a,f.status=b,e.resolve(f)}).error(function(a,b,c,d){var f={};f.data=a,f.status=b,e.reject(f)}),e.promise},deleteSubuser:function(d){var e=b.defer();return a({method:"POST",url:c.host+"/api/user/subuser/del",data:{uid:d}}).success(function(a,b,c,d){var f={};f.data=a,f.status=b,e.resolve(f)}).error(function(a,b,c,d){var f={};f.data=a,f.status=b,e.reject(f)}),e.promise},cldeleteSubuser:function(d){var e=b.defer();return a({method:"POST",url:c.host+"/api/user/channel/channel_user/del/",data:{cid:d}}).success(function(a,b,c,d){var f={};f.data=a,f.status=b,e.resolve(f)}).error(function(a,b,c,d){var f={};f.data=a,f.status=b,e.reject(f)}),e.promise},getUserQuotaInfo:function(){var d=b.defer();return a({method:"GET",url:c.host+"/api/user/quotainfo/"}).success(function(a,b,c,e){d.resolve(a)}).error(function(a,b,c,e){d.reject(b)}),d.promise},updateQuota:function(d){var e=b.defer();return a({method:"PUT",url:c.host+"/api/user/subuser/quota",data:d}).success(function(a,b,c,d){var f={};f.data=a,f.status=b,e.resolve(f)}).error(function(a,b,c,d){var f={};f.data=a,f.status=b,e.reject(f)}),e.promise},clupdateQuota:function(d){var e=b.defer();return a({method:"PUT",url:c.host+"/api/user/channel/channel_user/quota/",data:d}).success(function(a,b,c,d){var f={};f.data=a,f.status=b,e.resolve(f)}).error(function(a,b,c,d){var f={};f.data=a,f.status=b,e.reject(f)}),e.promise}}}]),angular.module("mbkportalApp").service("constants",function(){return{captchaType:{basicCaptcha:0,fpwdCaptcha:1},userType:{normal:0,company:1,companyVirtual:2,channel:3,channelUser:4,channelCompany:5},taskStatus:{TASK_STATUS_IDLE:0,TASK_STATUS_BACKUPING:1,TASK_STATUS_RESTORING:2,TASK_STATUS_PURGING:3},certType:{personal:0,company:1},certFile:{maxSize:2097152,type:"image"},certStatus:{certyTypeNo:0,certTypeUser:1,certTypeUserVerifying:2,certTypeCompany:3,certTypeCompanyVerifying:4,certTypeNoneed:5},restRet:{captchaStatusOK:0,captchaStatusNg:1,loginNgCaptcha:2,loginNoCaptcha:3,loginFail:1,loginNeedCaptcha:"1",loginNoNeedCaptcha:"0",errChgPwd:-1,errOpsValid:1,errFieldMiss:2,errTooLarge:3,errFieldErr:4,errUserNotFrozen:5,errUserNotinCompany:6,errUserSame:7,errUserInFrozen:8},purgeType:{KEEP_LAST_ONE_WEEK:0,KEEP_LAST_TWO_WEEKS:1,KEEP_LAST_ONE_MONTH:2,KEEP_LAST_THREE_MONTHS:3,KEEP_LAST_SIX_MONTHS:4,KEEP_LAST_ONE_YEAR:5}}}),angular.module("mbkportalApp").service("config",function(){return{host:"http://192.168.1.181",grant_type:"password",client_id:"0Oq62d5HeW1sbQ5gD2jF6KBjzizqKsaO7MhBRfR3",client_secret:"6vFeolOrASGD20RYJAuceBktE4UUyPLFfjqS91fV4tZomzh1XNKO4hxe3vXxWpgtEcmamgRUvOhIjT4aJKPQT3HdJ5qx5FyjMA8x2sYs5CNTAeegExkVJvDoANOVqKCz"}}),angular.module("mbkportalApp").service("utils",function(){return{formURLEncode:function(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")}}}),angular.module("mbkportalApp").service("backup_service",["$http","$q","config",function(a,b,c){return{getUserDevices:function(){var d=b.defer();return a({method:"GET",url:c.host+"/api/devices/"}).success(function(a,b,c,e){d.resolve(a)}).error(function(a,b,c,e){d.reject(b)}),d.promise},getTaskOfDevice:function(d){var e=b.defer();return a({method:"GET",url:c.host+"/api/tasks/"+d+"/"}).success(function(a,b,c,d){e.resolve(a)}).error(function(a,b,c,d){e.reject(b)}),e.promise},getInfoOfTask:function(d){var e=b.defer();return a({method:"GET",url:c.host+"/api/backups/task/"+d+"/"}).success(function(a,b,c,d){e.resolve(a)}).error(function(a,b,c,d){e.reject(b)}),e.promise},deleteDevice:function(d){var e=b.defer();return a({method:"DELETE",url:c.host+"/api/device/"+d+"/"}).success(function(a,b,c,d){e.resolve(a)}).error(function(a,b,c,d){e.reject(b)}),e.promise},deleteTask:function(d){var e=b.defer();return a({method:"DELETE",url:c.host+"/api/task/"+d+"/"}).success(function(a,b,c,d){e.resolve(a)}).error(function(a,b,c,d){e.reject(b)}),e.promise},deleteBackup:function(d){var e=b.defer();return a({method:"DELETE",url:c.host+"/api/backup/"+d+"/"}).success(function(a,b,c,d){e.resolve(a)}).error(function(a,b,c,d){e.reject(b)}),e.promise}}}]),angular.module("mbkportalApp").service("EventBus_Service",function(){var a={},b={on:function(b,c){a[b]||(a[b]=[]),a[b].push(c)},off:function(b,c){for(var d=0;a[b].length;d++)if(a[b][d]===c){a[b].splice(d,1);break}},fire:function(b){var c=b.type;if(a&&a[c])for(var d=0;d<a[c].length;d++)a[c][d](b)}};return b}),angular.module("mbkportalApp").run(["$templateCache",function(a){a.put("views/backup.html",'<style>/*.panel-heading {\n    padding: 15px;\n}*/\ntable.dataTable thead td, table.dataTable thead th {\n  padding: 10px;\n}</style> <div class="page-bar"> <ul class="page-breadcrumb"> <li> <a href="#/profile">主页</a> <i class="fa fa-circle"></i> </li> <li> <a href="#/deviceList">设备列表</a> <i class="fa fa-circle"></i> </li> </ul> <h3 class="page-title" style="float:right"> <small>已用备份空间：{{companyQuotaUsed}}GB/{{companyQuota}}GB </small> </h3> </div> <div class="alert alert-{{alertType}} alert-dismissible" style="margin-top: 20px" role="alert" ng-show="showAlert"> <button type="button" class="close" ng-click="showAlert=false"> <span aria-hidden="true">&times;</span></button> <strong>{{notifType}}</strong> {{notifMsg}} </div> <div> <!-- BEGIN MAIN CONTENT --> <div class="note note-info" style="margin-top: 10px"> <p> 温馨提示：点击列表中的<strong>设备信息</strong>以查看该设备的备份任务。点击<strong>备份类型</strong>以查看该任务的备份历史记录。 </p> </div> <div class="row"> <div class="col-md-12" style="margin-top:0"> <!-- BEGIN TABLE PORTLET--> <div class="portlet light bordered"> <div class="portlet-title"> <div class="caption font-dark"> <i class="icon-list font-dark"></i> <span class="caption-subject bold uppercase">&nbsp;设备列表</span> </div> </div> <div class="portlet-body"> <uib-accordion close-others="oneAtATime"> <uib-accordion-group is-open="false" is-disabled="true" panel-class="panel-myprimary"> <uib-accordion-heading> <div class="row text-center" style="color: #ffffff"> <div class="col-xs-1">类型</div> <div class="col-xs-2">系统</div> <div class="col-xs-2">主机名</div> <!--div class="col-xs-2">GUID</div--> <div class="col-xs-3">上次成功备份时间</div> <div class="col-xs-3">加入时间</div> <div class="col-xs-1">操作</div> </div> </uib-accordion-heading> </uib-accordion-group> <uib-accordion-group ng-repeat="device in devices" is-open="device.itemStatus" is-disabled="device.isDeleting == true"> <div ng-controller="deviceController"> <uib-accordion-heading> <div class="row text-center"> <div class="col-md-1"><i class="{{mapIcon(device.device_type)}}"></i></div> <div class="col-md-2">{{device.os}}</div> <div class="col-md-2">{{device.host}}</div> <!--div class="col-md-2">{{device.guid}}</div--> <div class="col-md-3">{{device.last_backuped | date:\'yyyy-MM-dd HH:mm:ss\'}}</div> <div class="col-md-3">{{device.date_joined | date:\'yyyy-MM-dd HH:mm:ss\'}}</div> <div class="col-md-1"> <a href="javascript:void(0);" popover="删除设备" popover-trigger="mouseenter" ng-hide="device.user!=currentUser || device.isDeleting==true" ng-click="modals.deleteDevice(device.id, device.host)"> <i class="fa fa-trash"></i> </a> </div> </div> </uib-accordion-heading> <table datatable="ng" class="row-border hover" dt-options="dtOptions"> <thead> <tr> <th width="10%">备份类型</th> <th width="20%">备份内容</th> <th width="20%">备份周期</th> <th width="20%">最后修改时间</th> <th width="10%">版本保留</th> <th width="10%">状态</th> <th width="10%">操作</th> </tr> </thead> <tbody> <tr ng-repeat="taskInfo in taskInfos" ng-disabled="taskInfo.status==task_status_purging"> <td ng-click="taskInfo.status==task_status_purging||showTaskHistory(taskInfo.id, taskInfo.device)"> <a href=""> <i class="{{mapTaskIcon(taskInfo.task_type)}}"></i> </a> </td> <td> <treecontrol class="tree-classic" tree-model="treedata[$index]" on-selection="showSelected(node)" options="opts"> {{node.name}} </treecontrol> </td> <td> 频率： {{mapFrequency(taskInfo.schedule_day, taskInfo.schedule_type)}} <br> 时间： {{ taskInfo.schedule_hour}}：{{formatMinute(taskInfo.schedule_minute) }} </td> <td>{{ taskInfo.last_modified | date:\'yyyy-MM-dd HH:mm:ss\' }}</td> <td>{{translatePurgeType(taskInfo.purge_type)}}</td> <td> <span class="label label-sm label-success" ng-if="taskInfo.isSuccess==true"> {{taskInfo.mapStatus}} </span> <span class="label label-sm label-warning" ng-if="taskInfo.isSuccess==false"> {{taskInfo.mapStatus}} </span> </td> <td> <a href="javascript:void(0);" popover="删除任务" popover-trigger="mouseenter" ng-click="modals.deleteTask(taskInfo.id, device.host)" ng-hide="taskInfo.status!=task_status_idle" style="margin-left:5px"> <i class="fa fa-trash"></i> </a> </td> </tr> </tbody> </table> </div> </uib-accordion-group> <div ng-show="devices.length == 0" style="background:#FFFFFF; color:\n              #2B3643" class="text-center">  <p ng-bind="devicesBlank_notice"></p>  </div> </uib-accordion> </div> </div> <!-- END TABLE PORTLET--> <span us-spinner spinner-on="showSpinner"></span> </div> </div> <script type="text/ng-template" id="myModalContent.html"><div class="modal-header">\n      <h3 class="modal-title" style="text-align: center">备份记录</h3>\n    </div>\n    <div class="modal-body">\n      <table st-table="history" class="table table-striped">\n        <thead>\n        <tr>\n          <th st-sort="startTime">开始时间</th>\n          <th st-sort="dirNum">备份文件数</th>\n          <th st-sort="fileSize">备份大小</th>\n          <th st-sort="status">状态</th>\n          <th >操作</th>\n        </tr>\n        <tr>\n          <th colspan="5">\n            <input st-search placeholder="全局搜索" class="input-sm form-control" type="search"/>\n          </th>\n        </tr>\n        </thead>\n        <tbody>\n        <tr ng-repeat="action in history">\n          <td>{{action.startTime}}</td>\n          <td>{{action.dirNum}}</td>\n          <td>{{action.fileSize}}</td>\n          <td>{{action.status}}</td>\n          <td class="options">\n            <button class="btn-sm btn-primary" type="button" ng-click="doAction(action.startTime)">Action 1</button>\n            <button class="btn-sm btn-warning" type="button" ng-click="doAction(action.dirNum)">Action 2</button>\n          </td>\n        </tr>\n        </tbody>\n      </table>\n    </div></script> <!--div class="checkbox">\n    <label>\n      <input type="checkbox" ng-model="oneAtATime">\n      Open only one at a time\n    </label>\n  </div--> </div> <script type="text/ng-template" id="modalDeleteDevice.html"><div class="modal-header">\n      <h4 class="modal-title">\n        <i class="fa fa-exclamation-triangle"></i>&nbsp;系统提示\n      </h4>\n    </div>\n    <div class="modal-body">\n      <p>\n        确定要删除{{deviceName}}吗？<br/>\n        （该设备所有的任务和备份都会被删除）\n      </p>\n    </div>\n    <div class="modal-footer">\n      <button class="btn btn-primary" ng-click="ok()">确定</button>\n      <button class=\'btn btn-warning\' ng-click="cancel()">取消</button>\n    </div></script> <script type="text/ng-template" id="modalDeleteTask.html"><div class="modal-header">\n      <h4 class="modal-title">\n        <i class="fa fa-exclamation-triangle"></i>&nbsp;系统提示\n      </h4>\n    </div>\n    <div class="modal-body">\n      <p>\n        确定要删除{{deviceName}}的备份任务吗？<br/>\n        （该任务所有的备份都会被删除）\n      </p>\n    </div>\n    <div class="modal-footer">\n      <button class="btn btn-primary" ng-click="ok()">确定</button>\n      <button class=\'btn btn-warning\' ng-click="cancel()">取消</button>\n    </div></script>'),a.put("views/certManagement.html",'<!-- BEGIN PAGE HEADER--> <div class="page-bar"> <ul class="page-breadcrumb"> <li> <a href="#/profile">主页</a> <i class="fa fa-circle"></i> </li> <li> <a href="#/certmgt">认证管理</a> <i class="fa fa-circle"></i> </li> <li> <a href="#/certmgt">实名认证</a> </li> </ul> </div> <div class="alert alert-{{alertType}} alert-dismissible" style="margin-top: 20px" role="alert" ng-show="showAlert"> <button type="button" class="close" ng-click="showAlert=false"> <span aria-hidden="true">&times;</span></button> <strong>{{notifType}}</strong> {{notifMsg}} </div> <!--h3 class="page-title"> 用户管理\n    <small>个人信息管理</small>\n</h3--> <!-- BEGIN MAIN CONTENT --> <div class="note note-info" style="margin-top: 20px"> <p> 进行实名认证，可以获得更多的备份配额，获取更加全面丰富的管理能力。 <span ng-if="noteSwitch==0"> 您可以选择<a href="#" ng-click="personalCert()">个人认证</a> 或 <a href="#" ng-click="companyCert()">公司认证</a> </span> <span ng-if="noteSwitch==1"> 您选择了<strong>个人认证</strong> </span> <span ng-if="noteSwitch==2"> 您选择了<strong>公司认证</strong> </span> </p> </div> <div class="row" ng-if="(noteSwitch==0 && userCertType==certType.personal) ||\n    noteSwitch==1"> <div class="col-md-12"> <!-- BEGIN PORTLET--> <div class="portlet box blue-hoki"> <div class="portlet-title"> <div class="caption"> <i class="fa fa-gift"></i>实名认证--个人认证 {{userCertStatus}} </div> </div> <div class="portlet-body form"> <!-- BEGIN FORM--> <form class="form-horizontal form-bordered" name="userCertForm" ng-submit="submitForm()"> <fieldset ng-disabled="disableEdit"> <div class="form-body"> <div class="form-group" ng-class="{\'has-error\':\n                            userCertForm.inputUsername.$invalid  \n                            && !userCertForm.inputUsername.$pristine}"> <label class="control-label col-md-3">身份证姓名</label> <div class="col-md-4"> <input type="text" class="form-control" maxlength="15" id="inputUsername" name="inputUsername" ng-model="certInfo.cert_name" required> <span ng-show="userInfoActive" class="help-block"> 请输入身份证中的真实姓名 </span> </div> </div> <div class="form-group"> <label class="control-label col-md-3">身份证正面</label> <div class="col-md-9"> <div class="fileinput fileinput-new" data-provides="fileinput"> <div class="fileinput-new thumbnail" style="width: 200px; height: 150px"> <img ng-src="{{frontPic}}" alt=""> </div> <div class="fileinput-preview fileinput-exists thumbnail" style="max-width: 200px; max-height: 150px"> </div> <div> <span class="btn default btn-file"> <span class="fileinput-new"> 选择照片 </span> <span class="fileinput-exists"> 更改</span> <input type="file" name="file" file-model="certInfo.cert_pic_front"> </span> <a href="#" class="btn red fileinput-exists" data-dismiss="fileinput"> 删除 </a> </div> </div> <div class="clearfix margin-top-10"> <span class="label label-danger"> 须知 </span> 上传时选择清晰的身份证正面图片，文件大小小于2M </div> </div> </div> <div class="form-group last"> <label class="control-label col-md-3">身份证反面</label> <div class="col-md-9"> <div class="fileinput fileinput-new" data-provides="fileinput"> <div class="fileinput-new thumbnail" style="width: 200px; height: 150px"> <img ng-src="{{backPic}}" alt=""> </div> <div class="fileinput-preview fileinput-exists thumbnail" style="max-width: 200px; max-height: 150px"> </div> <div> <span class="btn default btn-file"> <span class="fileinput-new"> 选择照片 </span> <span class="fileinput-exists"> 更改</span> <input type="file" name="file" file-model="certInfo.cert_pic_back"> </span> <a href="#" class="btn red fileinput-exists" data-dismiss="fileinput"> 删除 </a> </div> </div> <div class="clearfix margin-top-10"> <span class="label label-danger"> 须知 </span> 上传时选择清晰的身份证正面图片，文件大小小于2M </div> </div> </div> </div> <div class="form-actions"> <div class="row"> <div class="col-md-offset-3 col-md-9"> <button type="submit" class="btn purple"> <i class="fa fa-check"></i> 提交</button> </div> </div> </div> </fieldset> </form> <!-- END FORM--> </div> </div> <!-- END PORTLET--> </div> </div> <!-- END MAIN CONTENT --> <div class="row" ng-if="(noteSwitch==0 && userCertType==certType.company) ||\n    noteSwitch==2"> <div class="col-md-12"> <!-- BEGIN PORTLET--> <div class="portlet box blue-hoki"> <div class="portlet-title"> <div class="caption"> <i class="fa fa-gift"></i>实名认证--公司认证 {{companyCertStatus}} </div> </div> <div class="portlet-body form"> <!-- BEGIN FORM--> <form class="form-horizontal form-bordered" name="companyCertForm" ng-submit="submitFormCom()"> <fieldset ng-disabled="disableEdit"> <div class="form-body"> <div class="form-group" ng-class="{\'has-error\':\n                            companyCertForm.inputComName.$invalid  \n                            && !companyCertForm.inputComName.$pristine}"> <label class="control-label col-md-3">公司名称</label> <div class="col-md-4"> <input type="text" class="form-control" maxlength="15" id="inputComName" name="inputComName" ng-model="certInfo.company_name" required> </div> </div> <div class="form-group" ng-class="{\'has-error\':\n                            companyCertForm.inputLicense.$invalid  \n                            && !companyCertForm.inputLicense.$pristine}"> <label class="control-label col-md-3">公司营业执照</label> <div class="col-md-4"> <input type="text" class="form-control" maxlength="15" id="inputLicense" name="inputLicense" ng-model="certInfo.license_id" required> </div> </div> <div class="form-group"> <label class="control-label col-md-3">公司营业执照照片</label> <div class="col-md-9"> <div class="fileinput fileinput-new" data-provides="fileinput"> <div class="fileinput-new thumbnail" style="width: 200px; height: 150px"> <img ng-src="{{licensePic}}" alt=""> </div> <div class="fileinput-preview fileinput-exists thumbnail" style="max-width: 200px; max-height: 150px"> </div> <div> <span class="btn default btn-file"> <span class="fileinput-new"> 选择照片 </span> <span class="fileinput-exists"> 更改</span> <input type="file" name="file" file-model="certInfo.license_pic"> </span> <a href="#" class="btn red fileinput-exists" data-dismiss="fileinput"> 删除 </a> </div> </div> <div class="clearfix margin-top-10"> <span class="label label-danger"> 须知 </span> 上传时选择清晰的身份证正面图片，文件大小小于2M </div> </div> </div> <div class="form-group" ng-class="{\'has-error\':\n                            companyCertForm.inputOrg.$invalid  \n                            && !companyCertForm.inputOrg.$pristine}"> <label class="control-label col-md-3">公司组织机构号</label> <div class="col-md-4"> <input type="text" class="form-control" maxlength="15" id="inputOrg" name="inputOrg" ng-model="certInfo.org_id" required> </div> </div> <div class="form-group"> <label class="control-label col-md-3">公司组织机构照片</label> <div class="col-md-9"> <div class="fileinput fileinput-new" data-provides="fileinput"> <div class="fileinput-new thumbnail" style="width: 200px; height: 150px"> <img ng-src="{{organPic}}" alt=""> </div> <div class="fileinput-preview fileinput-exists thumbnail" style="max-width: 200px; max-height: 150px"> </div> <div> <span class="btn default btn-file"> <span class="fileinput-new"> 选择照片 </span> <span class="fileinput-exists"> 更改</span> <input type="file" name="file" file-model="certInfo.org_pic"> </span> <a href="#" class="btn red fileinput-exists" data-dismiss="fileinput"> 删除 </a> </div> </div> <div class="clearfix margin-top-10"> <span class="label label-danger"> 须知 </span> 上传时选择清晰的身份证正面图片，文件大小小于2M </div> </div> </div> <div class="form-group" ng-class="{\'has-error\':\n                            companyCertForm.inputEntityName.$invalid  \n                            && !companyCertForm.inputEntityName.$pristine}"> <label class="control-label col-md-3">公司法人姓名</label> <div class="col-md-4"> <input type="text" class="form-control" maxlength="15" id="inputEntityName" name="inputEntityName" ng-model="certInfo.entity_name" required> </div> </div> <div class="form-group last" ng-class="{\'has-error\':\n                            companyCertForm.inputEntityID.$invalid  \n                            && !companyCertForm.inputEntityID.$pristine}"> <label class="control-label col-md-3">公司法人身份证</label> <div class="col-md-4"> <input type="text" class="form-control" maxlength="15" id="inputEntityID" name="inputEntityID" ng-model="certInfo.entity_cert_id" required> </div> </div> </div> <div class="form-actions"> <div class="row"> <div class="col-md-offset-3 col-md-9"> <button type="submit" class="btn purple"> <i class="fa fa-check"></i> 提交</button> <button type="button" class="btn default">取消</button> </div> </div> </div> </fieldset> </form> <!-- END FORM--> </div> </div> <!-- END PORTLET--> </div> </div> <!-- END MAIN CONTENT -->'),
a.put("views/changepwd.html",'<!-- BEGIN PAGE HEADER--> <div class="page-bar"> <ul class="page-breadcrumb"> <li> <a href="#/dashboard.html">主页</a> <i class="fa fa-circle"></i> </li> <li> <a href="#/profile">用户管理</a> <i class="fa fa-circle"></i> </li> <li> <a href="#/changepwd">修改密码</a> </li> </ul> </div> <div class="alert alert-{{alertType}} alert-dismissible" style="margin-top: 20px" role="alert" ng-show="showAlert"> <button type="button" class="close" ng-click="showAlert=false"> <span aria-hidden="true">&times;</span></button> <strong>{{notifType}}</strong> {{notifMsg}} </div> <!--h3 class="page-title"> 用户管理\n    <small>个人信息管理</small>\n</h3--> <!-- BEGIN MAIN CONTENT --> <div class="note note-info" style="margin-top: 20px"> <p> 管理员可以修改自己的密码，修改密码时需提供当前使用的密码 </p> </div> <div class="row"> <div class="col-md-12"> <!-- BEGIN PORTLET--> <div class="portlet box blue-hoki"> <div class="portlet-title"> <div class="caption"> <i class="fa fa-gift"></i> 修改密码 </div> </div> <div class="portlet-body form"> <!-- BEGIN FORM--> <form class="form-horizontal form-bordered" name="passwordForm" ng-submit="submitForm()"> <div class="form-body"> <fieldset ng-disabled="!updateActive"> <div class="form-group" ng-class="{\'has-error\':\n                            passwordForm.inputPassword.$invalid  \n                            && !passwordForm.inputPassword.$pristine}"> <label for="inputPassword" class="control-label col-md-3">当前密码</label> <div class="col-md-4"> <input type="password" class="form-control" ng-pattern="/^.{6,}$/" id="inputPassword" name="inputPassword" ng-model="userInfo.oldpassword" required> <span class="help-block">密码长度不小于6个字符 </span> </div> </div> <div class="form-group" ng-class="{\'has-error\':\n                            passwordForm.inputNewPassword.$invalid  \n                            && !passwordForm.inputNewPassword.$pristine}"> <label for="inputNewPassword" class="control-label col-md-3">新密码</label> <div class="col-md-4"> <input type="password" class="form-control" ng-pattern="/^.{6,}$/" id="inputNewPassword" name="inputNewPassword" ng-model="userInfo.password" required> <span class="help-block">新密码长度不小于6个字符 </span> </div> </div> <div class="form-group" ng-class="{\'has-error\':\n                            passwordForm.inputConfirmPassword.$invalid  \n                            && !passwordForm.inputConfirmPassword.$pristine}"> <label class="control-label col-md-3">确认密码</label> <div class="col-md-4"> <input type="password" class="form-control" ng-pattern="/^.{6,}$/" id="inputConfirmPassword" name="inputConfirmPassword" ng-model="userInfo.confirmPasword" required> <span class="help-block">确认密码与新密码保持一致 </span> </div> </div> <fieldset> </fieldset></fieldset></div> <div class="form-actions"> <div class="row"> <div class="col-md-offset-3 col-md-9"> <button type="submit" class="btn green"> <i class="fa fa-check"></i> 保存</button> </div> </div> </div> </form> <span us-spinner spinner-on="showSpinner"></span> <!-- END FORM--> </div> </div> <!-- END PORTLET--> </div> </div>'),a.put("views/channelcompanyMgt.html",'<!-- BEGIN PAGE HEADER--> <div class="page-bar"> <ul class="page-breadcrumb"> <li> <a href="#/profile">主页</a> <i class="fa fa-circle"></i> </li> <li> <a href="#/channelusermgt">渠道管理</a> <i class="fa fa-circle"></i> </li> <li> <a href="#/channelcompanymgt">公司用户管理</a> </li> </ul> </div> <div class="alert alert-{{alertType}} alert-dismissible" style="margin-top: 20px" role="alert" ng-show="showAlert"> <button type="button" class="close" ng-click="showAlert=false"> <span aria-hidden="true">&times;</span></button> <strong>{{notifType}}</strong> {{notifMsg}} </div> <div class="note note-info" style="margin-top: 20px"> <p> 管理渠道商公司用户：增加，更新和删除公司用户，更改公司备份空间，修改默认备份分配空间。 </p> </div> <h3 class="page-title"> Hi {{userInfo.username}} <small>您是渠道商<a ng-href="">{{companyInfo.company_name}}</a>的管理员</small> </h3> <!-- END PAGE HEADER--> <!-- BEGIN MAIN CONTENT --> <div class="row"> <div class="col-md-12"> <!-- BEGIN EXAMPLE TABLE PORTLET--> <div class="portlet light bordered"> <div class="portlet-title"> <div class="caption font-dark"> <i class="icon-settings font-dark"></i> <span class="caption-subject bold uppercase"> 渠道总览</span> </div> </div> <div class="portlet-body"> <div class="row list-separated"> <div class="col-md-3 col-sm-3 col-xs-6"> <div class="font-grey-mint font-sm"> 已分配备份空间</div> <div class="uppercase font-hg font-red-flamingo"> {{companyInfo.assigned_quota}} <span class="font-lg font-grey-mint">GB</span> </div> </div> <div class="col-md-3 col-sm-3 col-xs-6"> <div class="font-grey-mint font-sm"> 备份设备数</div> <div class="uppercase font-hg font-green"> {{companyInfo.devices_used}} <span class="font-lg font-grey-mint"></span> </div> </div> <div class="col-md-3 col-sm-3 col-xs-6"> <div class="font-grey-mint font-sm"> 渠道公司用户数</div> <div class="uppercase font-hg font-purple"> {{companyInfo.channel_companys}} <span class="font-lg font-grey-mint"></span> </div> </div> <div class="col-md-3 col-sm-3 col-xs-6"> <div class="font-grey-mint font-sm"> 备份用户数</div> <div class="uppercase font-hg font-blue"> {{companyInfo.backup_users}} <span class="font-lg font-grey-mint"></span> </div> </div> </div> </div> </div> <!-- END EXAMPLE TABLE PORTLET--> <span us-spinner spinner-on="showSpinner"></span> </div> </div> <div class="row"> <div class="col-md-12"> <!-- BEGIN EXAMPLE TABLE PORTLET--> <div class="portlet light bordered"> <div class="portlet-title"> <div class="caption font-dark"> <i class="icon-settings font-dark"></i> <span class="caption-subject bold uppercase"> 公司用户管理</span> </div> </div> <div class="portlet-body"> <div class="table-toolbar"> <div class="row"> <div class="col-md-6"> <div class="btn-group"> <button id="add_subuser" class="btn sbold green" ng-click="actions.addSubuser()"> 添加用户 <i class="fa fa-plus"></i> </button> </div> </div> <div class="col-md-6"> <div class="btn-group pull-right"> <button class="btn green btn-outline dropdown-toggle" data-toggle="dropdown">更多操作 <i class="fa fa-angle-down"></i> </button> <ul class="dropdown-menu pull-right"> <li> <a href="javascript:;" ng-click="setSubuserStatus(1)"> <i class="fa fa-play"></i> 激活用户 </a> </li> <li> <a href="javascript:;" ng-click="setSubuserStatus(0)"> <i class="fa fa-pause"></i> 冻结用户 </a> </li> <li> <a href="javascript:;" ng-click="delSubuser()"> <i class="fa fa-trash"></i> 删除用户 </a> </li> </ul> </div> </div> </div> </div> <table datatable="ng" dt-options="dtOptions" class="row-border hover"> <thead> <tr> <th> <input type="checkbox" class="checkboxes" ng-model="checkStatus.checkAll" ng-click="checkStatus.clickCheckAll()"> </th> <th> 公司名称 </th> <th> 公司地址 </th> <th> 公司联系号码 </th> <th> 状态 </th> <th> 备份空间 </th> <th> 设备数 </th> <th> 操作 </th> </tr> </thead> <tbody> <tr ng-repeat="subuser in subusers.subusers"> <td> <input type="checkbox" class="checkboxes" ng-model="subuser.checked" ng-click="clickCheck(subuser.id)"> </td> <td> {{subuser.company_name}} </td> <td> {{subuser.company_addr}} </td> <td> {{subuser.company_tel}} </td> <td> <span class="label label-sm label-success" ng-if="subuser.is_active==true"> 正常 </span> <span class="label label-sm label-success" ng-if="subuser.is_active==false"> 冻结中 </span> </td> <td class="center"> {{subuser.storage_used}} / {{subuser.quota}} </td> <td class="center"> {{subuser.devices_used}} / {{subuser.quota}} </td> <td class="center"> <a href="javascript:;" popover="更新备份空间" popover-trigger="mouseenter" ng-click="actions.updateQuota(subuser.cid)" style="margin-right: 5px"> <i class="fa fa-refresh"></i> </a> <a href="javascript:;" popover="激活" popover-trigger="mouseenter" ng-click="subuserEnable(subuser.cid)" style="margin-right: 5px"> <i class="fa fa-play"></i> </a> <a href="javascript:;" popover="冻结" popover-trigger="mouseenter" ng-click="subuserDisable(subuser.cid)" style="margin-right: 5px"> <i class="fa fa-pause"></i> </a> <a href="javascript:;" popover="删除" popover-trigger="mouseenter" ng-click="subuserDelete(subuser.cid)" style="margin-right: 5px"> <i class="fa fa-trash"></i> </a> </td> </tr> </tbody> </table> </div> </div> <!-- END EXAMPLE TABLE PORTLET--> </div> </div> <!-- BEGIN MAIN JS --> <script type="text/ng-template" id="myModalContent.html"><div class="modal-header">\n        <h3 class="modal-title">添加公司用户</h3>\n    </div>\n    <div class="modal-body">\n        <form class="register-form" style="display:block" name="userForm" novalidate>\n            <div class="form-group" style="margin-top: 20px" \n                ng-class="{\'has-error\':userForm.inputEmail.$invalid &&\n                    !userForm.inputEmail.$pristine}">\n                <input type="email" class="form-control" id="inputEmail" name="inputEmail"\n                placeholder="管理员邮箱" ng-model="subuser.email" required>\n                <div ng-show="userForm.inputEmail.$invalid && !userForm.inputEmail.$pristine" class="help-block">\n                    <p>请输入合法的邮箱地址.</p>\n                </div>\n            </div>\n            <div class="form-group" ng-class="{\'has-error\':userForm.inputPhone.$invalid &&\n                !userForm.inputPhone.$pristine}">\n                <input type="text" class="form-control" id="inputPhone" name="inputPhone"\n                placeholder="管理员手机号码" ng-model="subuser.cellphone" ng-pattern="/^1[0-9]{10}$/" required>\n                <div ng-show="userForm.inputPhone.$invalid && !userForm.inputPhone.$pristine" class="help-block">\n                    <p>请输入合法的手机号码.</p>\n                </div>\n            </div>\n            <div class="form-group" ng-class="{\'has-error\':userForm.inputUsername.$invalid &&\n                !userForm.inputUsername.$pristine}">\n                <input type="text" class="form-control" id="inputUsername" name="inputUsername"\n                placeholder="管理员用户名称" ng-model="subuser.username" required>\n                <div ng-show="userForm.inputUsername.$invalid && !userForm.inputUsername.$pristine" class="help-block">\n                    <p>用户昵称不能为空.</p>\n                </div>\n            </div>\n            <div class="form-group" ng-class="{\'has-error\':userForm.inputPassword.$invalid &&\n                !userForm.inputPassword.$pristine}">\n                <div class="input-group" style="text-align:left">\n                    <input type="text" class="form-control" id="inputPassword" name="inputPassword"\n                    ng-minlength="6" placeholder="管理员登录密码" ng-model="subuser.password" required>\n                    <span class="input-group-btn">\n                        <button class="btn green"\n                            ng-click="randomPassword()">随机密码 </button>\n                    </span>\n                </div>\n                <p ng-show="userForm.inputPassword.$invalid && !userForm.inputPassword.$pristine" class="help-block">\n                    请确保用户密码最小长度为6位字符.</p>\n            </div>\n            <hr>\n            <div class="form-group" ng-class="{\'has-error\':userForm.inputComname.$invalid &&\n                !userForm.inputComname.$pristine}">\n                <input type="text" class="form-control" id="inputComname"\n                name="inputComname"\n                placeholder="公司名称" ng-model="subuser.company_name" required>\n                <div ng-show="userForm.inputComname.$invalid &&\n                    !userForm.inputComname.$pristine" class="help-block">\n                    <p>公司名称不能为空.</p>\n                </div>\n            </div>\n            <div class="form-group" ng-class="{\'has-error\':userForm.inputComaddr.$invalid &&\n                !userForm.inputComaddr.$pristine}">\n                <input type="text" class="form-control" id="inputComaddr"\n                name="inputComaddr"\n                placeholder="公司地址" ng-model="subuser.company_addr" required>\n                <div ng-show="userForm.inputComaddr.$invalid &&\n                    !userForm.inputComaddr.$pristine" class="help-block">\n                    <p>公司地址不能为空.</p>\n                </div>\n            </div>\n            <div class="form-group"\n                ng-class="{\'has-error\':userForm.inputComphone.$invalid &&\n                !userForm.inputComphone.$pristine}">\n                <input type="text" class="form-control" id="inputComphone"\n                name="inputComphone" ng-pattern="/^1[0-9]{10}$/"\n                placeholder="公司联系电话" ng-model="subuser.company_tel" required>\n                <div ng-show="userForm.inputComphone.$invalid &&\n                    !userForm.inputComphone.$pristine" class="help-block">\n                    <p>请输入合法的手机号码.</p>\n                </div>\n            </div>\n            <div class="form-group" ng-class="{\'has-error\':userForm.inputQuota.$invalid &&\n                !userForm.inputQuota.$pristine}">\n                <div class="input-group" style="text-align:left">\n                    <input type="text" class="form-control" id="inputQuota" name="inputQuota"\n                    ng-pattern="/^[1-9]{1}[0-9]{0,10}$/"\n                    placeholder="公司备份空间，单位GB"\n                    ng-model="subuser.quota" required>\n                    <span class="input-group-btn">\n                        <button class="btn green"\n                            ng-click="setDefaultQuota()">默认空间 </button>\n                    </span>\n                </div>\n                <span ng-show="userForm.inputQuota.$invalid && !userForm.inputQuota.$pristine" class="help-block">\n                    请输入正确的备份配额，例如：<code>512</code>.</span>\n            </div>\n        </form>\n    </div>\n    <div class="modal-footer">\n        <button class="btn btn-primary" ng-disabled="disableSubmit()" ng-click="ok()">添加</button>\n        <button class="btn btn-warning" ng-click="cancel()">取消</button>\n    </div></script> <script type="text/ng-template" id="updateQuota.html"><div class="modal-header">\n        <h3 class="modal-title">更改备份空间</h3>\n    </div>\n    <div class="modal-body">\n        <form class="register-form" style="display:block" name="quotaForm" novalidate>\n            <div class="form-group" ng-class="{\'has-error\':quotaForm.inputQuota.$invalid &&\n                !quotaForm.inputQuota.$pristine}">\n                <div class="input-group" style="text-align:left">\n                    <input type="text" class="form-control" id="inputQuota" name="inputQuota"\n                    ng-pattern="/^[1-9]{1}[0-9]{0,10}$/"\n                    placeholder="备份空间，单位GB" ng-model="quota" required>\n                    <span class="input-group-btn">\n                        <button class="btn green"\n                            ng-click="setDefaultQuota()">默认空间 </button>\n                    </span>\n                </div>\n                <span ng-show="quotaForm.inputQuota.$invalid && !quotaForm.inputQuota.$pristine" class="help-block">\n                    请输入正确的备份配额，例如：<code>512</code>.</span>\n            </div>\n        </form>\n    </div>\n    <div class="modal-footer">\n        <button class="btn btn-primary" ng-disabled="disableSubmit()"\n            ng-click="ok()">确定</button>\n        <button class="btn btn-warning" ng-click="cancel()">取消</button>\n    </div></script> <!-- END MAIN JS -->'),a.put("views/channeluserMgt.html",'<!-- BEGIN PAGE HEADER--> <div class="page-bar"> <ul class="page-breadcrumb"> <li> <a href="#/profile">主页</a> <i class="fa fa-circle"></i> </li> <li> <a href="#/channelusermgt">渠道管理</a> <i class="fa fa-circle"></i> </li> <li> <a href="#/channelusermgt">个人用户管理</a> </li> </ul> </div> <div class="alert alert-{{alertType}} alert-dismissible" style="margin-top: 20px" role="alert" ng-show="showAlert"> <button type="button" class="close" ng-click="showAlert=false"> <span aria-hidden="true">&times;</span></button> <strong>{{notifType}}</strong> {{notifMsg}} </div> <div class="note note-info" style="margin-top: 20px"> <p> 管理渠道商个人用户：增加，更新和删除个人用户，更改备份空间，修改默认备份分配空间。 </p> </div> <h3 class="page-title"> Hi {{userInfo.username}} <small>您是渠道商<a ng-href="">{{companyInfo.company_name}}</a>的管理员</small> </h3> <!-- END PAGE HEADER--> <!-- BEGIN MAIN CONTENT --> <div class="row"> <div class="col-md-12"> <!-- BEGIN EXAMPLE TABLE PORTLET--> <div class="portlet light bordered"> <div class="portlet-title"> <div class="caption font-dark"> <i class="icon-settings font-dark"></i> <span class="caption-subject bold uppercase"> 渠道总览</span> </div> </div> <div class="portlet-body"> <div class="row list-separated"> <div class="col-md-3 col-sm-3 col-xs-6"> <div class="font-grey-mint font-sm"> 已分配备份空间</div> <div class="uppercase font-hg font-red-flamingo"> {{companyInfo.assigned_quota}} <span class="font-lg font-grey-mint">GB</span> </div> </div> <div class="col-md-3 col-sm-3 col-xs-6"> <div class="font-grey-mint font-sm"> 备份设备数</div> <div class="uppercase font-hg font-green"> {{companyInfo.devices_used}} <span class="font-lg font-grey-mint"></span> </div> </div> <div class="col-md-3 col-sm-3 col-xs-6"> <div class="font-grey-mint font-sm"> 渠道个人用户数</div> <div class="uppercase font-hg font-purple"> {{companyInfo.channel_users}} <span class="font-lg font-grey-mint"></span> </div> </div> <div class="col-md-3 col-sm-3 col-xs-6"> <div class="font-grey-mint font-sm"> 备份用户数</div> <div class="uppercase font-hg font-blue"> {{companyInfo.backup_users}} <span class="font-lg font-grey-mint"></span> </div> </div> </div> </div> </div> <!-- END EXAMPLE TABLE PORTLET--> <span us-spinner spinner-on="showSpinner"></span> </div> </div> <div class="row"> <div class="col-md-12"> <!-- BEGIN EXAMPLE TABLE PORTLET--> <div class="portlet light bordered"> <div class="portlet-title"> <div class="caption font-dark"> <i class="icon-settings font-dark"></i> <span class="caption-subject bold uppercase"> 个人用户管理</span> </div> </div> <div class="portlet-body"> <div class="table-toolbar"> <div class="row"> <div class="col-md-6"> <div class="btn-group"> <button id="add_subuser" class="btn sbold green" ng-click="actions.addSubuser()"> 添加用户 <i class="fa fa-plus"></i> </button> </div> </div> <div class="col-md-6"> <div class="btn-group pull-right"> <button class="btn green btn-outline dropdown-toggle" data-toggle="dropdown">更多操作 <i class="fa fa-angle-down"></i> </button> <ul class="dropdown-menu pull-right"> <li> <a href="javascript:;" ng-click="setSubuserStatus(1)"> <i class="fa fa-play"></i> 激活用户 </a> </li> <li> <a href="javascript:;" ng-click="setSubuserStatus(0)"> <i class="fa fa-pause"></i> 冻结用户 </a> </li> <li> <a href="javascript:;" ng-click="delSubuser()"> <i class="fa fa-trash"></i> 删除用户 </a> </li> </ul> </div> </div> </div> </div> <table datatable="ng" dt-options="dtOptions" class="row-border hover"> <thead> <tr> <th> <input type="checkbox" class="checkboxes" ng-model="checkStatus.checkAll" ng-click="checkStatus.clickCheckAll()"> </th> <th> 用户名 </th> <th> 手机号码 </th> <th> Email </th> <th> 状态 </th> <th> 备份空间 </th> <th> 设备数 </th> <th> 操作 </th> </tr> </thead> <tbody> <tr ng-repeat="subuser in subusers.subusers"> <td> <input type="checkbox" class="checkboxes" ng-model="subuser.checked" ng-click="clickCheck(subuser.id)"> </td> <td> {{subuser.username}} </td> <td> {{subuser.cellphone}} </td> <td> <a ng-href="mailto:{{subuser.email}}"> {{subuser.email}} </a> </td> <td> <span class="label label-sm label-success" ng-if="subuser.is_active==true"> 正常 </span> <span class="label label-sm label-success" ng-if="subuser.is_active==false"> 冻结中 </span> </td> <td class="center"> {{subuser.storage_used}} / {{subuser.quota}} </td> <td class="center"> {{subuser.devices_used}} / {{subuser.quota}} </td> <td class="center"> <a href="javascript:;" popover="更新备份空间" popover-trigger="mouseenter" ng-click="actions.updateQuota(subuser.cid)" style="margin-right: 5px"> <i class="fa fa-refresh"></i> </a> <a href="javascript:;" popover="激活" popover-trigger="mouseenter" ng-click="subuserEnable(subuser.cid)" style="margin-right: 5px"> <i class="fa fa-play"></i> </a> <a href="javascript:;" popover="冻结" popover-trigger="mouseenter" ng-click="subuserDisable(subuser.cid)" style="margin-right: 5px"> <i class="fa fa-pause"></i> </a> <a href="javascript:;" popover="删除" popover-trigger="mouseenter" ng-click="subuserDelete(subuser.cid)" style="margin-right: 5px"> <i class="fa fa-trash"></i> </a> </td> </tr> </tbody> </table> </div> </div> <!-- END EXAMPLE TABLE PORTLET--> </div> </div> <!-- BEGIN MAIN JS --> <script type="text/ng-template" id="myModalContent.html"><div class="modal-header">\n        <h3 class="modal-title">添加个人用户</h3>\n    </div>\n    <div class="modal-body">\n        <form class="register-form" style="display:block" name="userForm" novalidate>\n            <div class="form-group" style="margin-top: 20px" \n                ng-class="{\'has-error\':userForm.inputEmail.$invalid &&\n                    !userForm.inputEmail.$pristine}">\n                <input type="email" class="form-control" id="inputEmail" name="inputEmail"\n                placeholder="邮箱" ng-model="subuser.email" required>\n                <div ng-show="userForm.inputEmail.$invalid && !userForm.inputEmail.$pristine" class="help-block">\n                    <p>请输入合法的邮箱地址.</p>\n                </div>\n            </div>\n            <div class="form-group" ng-class="{\'has-error\':userForm.inputPhone.$invalid &&\n                !userForm.inputPhone.$pristine}">\n                <input type="text" class="form-control" id="inputPhone" name="inputPhone"\n                placeholder="手机号码" ng-model="subuser.cellphone" ng-pattern="/^1[0-9]{10}$/" required>\n                <div ng-show="userForm.inputPhone.$invalid && !userForm.inputPhone.$pristine" class="help-block">\n                    <p>请输入合法的手机号码.</p>\n                </div>\n            </div>\n            <div class="form-group" ng-class="{\'has-error\':userForm.inputUsername.$invalid &&\n                !userForm.inputUsername.$pristine}">\n                <input type="text" class="form-control" id="inputUsername" name="inputUsername"\n                placeholder="用户昵称" ng-model="subuser.username" required>\n                <div ng-show="userForm.inputUsername.$invalid && !userForm.inputUsername.$pristine" class="help-block">\n                    <p>用户昵称不能为空.</p>\n                </div>\n            </div>\n            <div class="form-group" ng-class="{\'has-error\':userForm.inputPassword.$invalid &&\n                !userForm.inputPassword.$pristine}">\n                <div class="input-group" style="text-align:left">\n                    <input type="text" class="form-control" id="inputPassword" name="inputPassword"\n                    ng-minlength="6" placeholder="密码" ng-model="subuser.password" required>\n                    <span class="input-group-btn">\n                        <button class="btn green"\n                            ng-click="randomPassword()">随机密码 </button>\n                    </span>\n                </div>\n                <p ng-show="userForm.inputPassword.$invalid && !userForm.inputPassword.$pristine" class="help-block">\n                    请确保用户密码最小长度为6位字符.</p>\n            </div>\n            <div class="form-group" ng-class="{\'has-error\':userForm.inputQuota.$invalid &&\n                !userForm.inputQuota.$pristine}">\n                <div class="input-group" style="text-align:left">\n                    <input type="text" class="form-control" id="inputQuota" name="inputQuota"\n                    ng-pattern="/^[1-9]{1}[0-9]{0,10}$/"\n                    placeholder="备份空间，单位GB" ng-model="subuser.quota" required>\n                    <span class="input-group-btn">\n                        <button class="btn green"\n                            ng-click="setDefaultQuota()">默认空间 </button>\n                    </span>\n                </div>\n                <span ng-show="userForm.inputQuota.$invalid && !userForm.inputQuota.$pristine" class="help-block">\n                    请输入正确的备份空间，例如：<code>512</code>.</span>\n            </div>\n        </form>\n    </div>\n    <div class="modal-footer">\n        <button class="btn btn-primary" ng-disabled="disableSubmit()" ng-click="ok()">添加</button>\n        <button class="btn btn-warning" ng-click="cancel()">取消</button>\n    </div></script> <script type="text/ng-template" id="updateQuota.html"><div class="modal-header">\n        <h3 class="modal-title">更改备份空间</h3>\n    </div>\n    <div class="modal-body">\n        <form class="register-form" style="display:block" name="quotaForm" novalidate>\n            <div class="form-group" ng-class="{\'has-error\':quotaForm.inputQuota.$invalid &&\n                !quotaForm.inputQuota.$pristine}">\n                <div class="input-group" style="text-align:left">\n                    <input type="text" class="form-control" id="inputQuota" name="inputQuota"\n                    ng-pattern="/^[1-9]{1}[0-9]{0,10}$/"\n                    placeholder="备份配额，单位GB" ng-model="quota" required>\n                    <span class="input-group-btn">\n                        <button class="btn green"\n                            ng-click="setDefaultQuota()">默认空间 </button>\n                    </span>\n                </div>\n                <span ng-show="quotaForm.inputQuota.$invalid && !quotaForm.inputQuota.$pristine" class="help-block">\n                    请输入正确的备份空间，例如：<code>512</code>.</span>\n            </div>\n        </form>\n    </div>\n    <div class="modal-footer">\n        <button class="btn btn-primary" ng-disabled="disableSubmit()"\n            ng-click="ok()">确定</button>\n        <button class="btn btn-warning" ng-click="cancel()">取消</button>\n    </div></script> <!-- END MAIN JS -->'),a.put("views/dashboard.html",'<div class="text-center"> <p>dashboard page</p> </div>'),a.put("views/download.html",'<!-- BEGIN PAGE HEADER--> <div class="page-bar"> <ul class="page-breadcrumb"> <li> <a href="#/profile">主页</a> <i class="fa fa-circle"></i> </li> <li> <a href="#/download">资源下载</a> <i class="fa fa-circle"></i> </li> </ul> </div> <!--h3 class="page-title"> 用户管理\n    <small>个人信息管理</small>\n</h3--> <!-- BEGIN MAIN CONTENT --> <div class="note note-info" style="margin-top: 20px"> <p> 可下载Windows、Windows2000客户端以及用户相关帮助文档。</p> </div> <div class="row"> <div class="col-md-12"> <div class="portlet light bordered"> <div class="portlet-title"> <div class="caption font-dark"> <i class="icon-cloud-download font-dark"></i> <span class="caption-subject bold uppercase"> 客户端下载</span> </div> </div> <div class="portlet-body"> <div class="row list-separated"> <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12"> <div style="text-align:center"> <a class="in-page-link" href="/download/webackup_win2000.zip"> <span style="font-size:90px"><i class="icon fa fa-th"></i></span> </a> <br> <span> Windows2000 </span> </div> </div> <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12"> <div style="text-align:center"> <a class="in-page-link" href="/download/webackup_windows.zip"> <span style="font-size:90px"><i class="icon fa fa-windows"></i></span> </a> <br> <span>windows</span> </div> </div> </div> </div> </div> </div> </div> <div class="row"> <div class="col-md-12"> <div class="portlet light bordered"> <div class="portlet-title"> <div class="caption font-dark"> <i class="icon-cloud-download font-dark"></i> <span class="caption-subject bold uppercase"> 文档下载</span> </div> </div> <div class="portlet-body"> <div class="row list-separated"> <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12"> <div style="text-align:center"> <a class="in-page-link" href="/download/用户使用手册.doc"> <span style="font-size:90px"><i class="icon fa fa-file-pdf-o"></i></span> </a> <br> <span> 用户使用手册 </span> </div> </div> <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12"> <div style="text-align:center"> <a class="in-page-link" href="/download/用户帮助文档.doc"> <span style="font-size:90px"><i class="icon fa fa-file-archive-o"></i></span> </a> <br> <span>用户帮助文档</span> </div> </div> <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12"> <div style="text-align:center"> <a class="in-page-link" href="/download/微备份服务协议.doc"> <span style="font-size:90px"><i class="icon fa fa-file-text-o"></i></span> </a> <br> <span>软件使用协议</span> </div> </div> </div> </div> </div> </div> </div>'),a.put("views/footer.html",'<div class="row"> <div class="page-footer-inner col-lg-6 col-lg-offset-3 text-center"> © 版权所有 2015 南京普亚信息技术有限公司 网站备案：苏ICP备14050311号-4 </div> <div class="scroll-to-top"> <i class="icon-arrow-up"></i> </div> </div>'),a.put("views/forgetpwd.html",'<div class="forget-form" style="display:block"> <div class="alert alert-{{alertType}} alert-dismissible" style="margin-top: 20px" role="alert" ng-show="showAlert"> <button type="button" class="close" ng-click="showAlert=false"> <span aria-hidden="true">&times;</span></button> <strong>{{notifType}}</strong> {{notifMsg}} </div> <!-- PAGE HEADER --> <h3 class="font-green">忘记密码 ?</h3> <!-- FORM --> <!-- novalidate prevents HTML5 validation since we will be validating ourselves--> <wizard on-finish="finishedWizard()"> <wz-step title="确认账号"> <form class="form-group" name="userForm" ng-submit="enterValidation()" novalidate> <p>请填入注册时使用的邮箱或绑定的手机号码。</p> <div class="form-group" ng-class="{\'has-error\':(userForm.inputEmail.$invalid  &&\n          !userForm.inputEmail.$pristine) || emailErr.error}"> <input type="text" ng-pattern="/(^1[0-9]{10}$)|(^\\w+([-+.\']\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$)/" class="form-control" id="inputEmail" name="inputEmail" placeholder="请输入邮箱地址或手机号码" ng-model="forgetPwdInfo.email" ng-blur="formEmailBlur()"> <div ng-show="userForm.inputEmail.$invalid &&\n            !userForm.inputEmail.$pristine" class="help-block"> <p>请输入合法的邮箱地址或手机号码.</p> </div> </div> <div class="form-group" ng-class="{\'has-error\':userForm.validateCode.$invalid  &&\n          !userForm.validateCode.$pristine}" ng-show="userForm.inputEmail.$valid\n          && userForm.inputEmail.$dirty && forgetPwdInfo.email!=\'\'"> <input class="form-control" id="validateCode" name="validateCode" ng-pattern="/^[0-9]{4}$/" placeholder="请输入验证码" ng-model="forgetPwdInfo.validateCode"> <img height="30" width="120" alt="验证码" style="margin-top: 10px" ng-src="data:image/png;base64,{{captChaResult}}"> <a href ng-click="getCaptchaContent({{basicCaptcha}}, \'true\')">看不清</a> <p ng-show="userForm.validateCode.$invalid && !userForm.validateCode.$pristine" class="help-block">请确保验证码长度为4位字符.</p> </div> <input type="button" ng-click="goToLoginPage()" class="btn btn-primary" value="返回"> <input type="submit" ng-disabled="userForm.$invalid" class="btn green pull-right" value="下 一 步"> </form> </wz-step> <wz-step title="安全验证"> <form class="form-group" name="userForm2" ng-submit="enterValidation2()" novalidate> <p>验证码已发到您邮箱或手机,请在5分钟内输入。</p> <div class="form-group" ng-class="{\'has-error\':userForm2.emailCode.$invalid  &&\n          !userForm2.emailCode.$pristine}"> <input class="form-control" id="emailCode" name="emailCode" ng-pattern="/^[0-9]{6}$/" placeholder="请输入验证码" ng-model="forgetPwdInfo.emailCode"> <p ng-show="userForm2.emailCode.$invalid && !userForm2.emailCode.$pristine" class="help-block">请确保验证码长度为6位字符.</p> </div> <div ng-show="showCaptcha" class="form-group" ng-class="{\'has-error\':userForm2.validateCode.$invalid  &&\n          !userForm2.validateCode.$pristine}"> <label for="validateCode"><i class="fa fa-coffee fa-lg"></i> 验证码</label> <input type="text" class="form-control" id="validateCode" name="validateCode" placeholder="请输入验证码" ng-model="forgetPwdInfo.validateCode2" ng-pattern="/[0-9]{4}/" required> <img height="30" width="120" alt="验证码" style="margin-top: 10px" ng-src="data:image/png;base64,{{captChaResult}}"> <a href ng-click="getCaptchaContent({{basicCaptcha}}, \'true\')">看不清</a> <p ng-show="userForm2.validateCode.$invalid && !userForm2.validateCode.$pristine" class="help-block">请确保验证码长度为4位字符.</p> </div> <div ng-switch="showCaptcha"> <div ng-switch-when="true"> <input type="button" wz-previous class="btn btn-primary" value="上 一 步"> <input type="submit" class="btn green pull-right" value="下 一 步" ng-disabled="userForm2.emailCode.$invalid || userForm2.validateCode.$invalid ||\n               userForm2.validateCode.$pristine"> </div> <div ng-switch-when="false"> <input type="button" wz-previous class="btn btn-primary" value="上 一 步"> <input type="submit" ng-disabled="userForm2.emailCode.$invalid || userForm2.emailCode.$pristine" class="btn green pull-right" value="下 一 步"> </div> </div> </form> </wz-step> <wz-step title="完成"> <form class="form-group" name="userForm3" ng-submit="enterValidation3()" novalidate> <p>重置密码。</p> <div class="form-group" ng-class="{\'has-error\':userForm3.inputPassword.$invalid  &&\n          !userForm3.inputPassword.$pristine}"> <input type="password" class="form-control" id="inputPassword" name="inputPassword" ng-minlength="6" placeholder="请输入用户密码" ng-disabled="forgetPwdInfo.status" ng-model="forgetPwdInfo.password"> <p ng-show="userForm3.inputPassword.$invalid && !userForm3.inputPassword.$pristine" class="help-block"> 请确保用户密码最小长度为6位字符.</p> </div> <div class="form-group" ng-class="{\'has-error\':userForm3.confirmPassword.$invalid  &&\n          !userForm3.confirmPassword.$pristine}"> <input type="password" class="form-control" id="confirmtPassword" name="confirmPassword" ng-minlength="6" placeholder="请确认密码" ng-disabled="forgetPwdInfo.status" ng-model="forgetPwdInfo.confirmPassword"> <p ng-show="userForm3.confirmPassword.$invalid && !userForm3.confirmPassword.$pristine" class="help-block">请确保用户密码最小长度为6位字符.</p> </div> <input type="button" wz-previous class="btn btn-primary" value="上 一 步"> <input type="submit" ng-disabled="userForm3.$invalid || forgetPwdInfo.status" class="btn green pull-right" value="提 交"> </form> </wz-step> </wizard> <span us-spinner spinner-key="spinnerResetPwd"></span> </div>'),
a.put("views/header.html",'<!-- BEGIN HEADER INNER --> <div class="page-header-inner"> <!-- BEGIN LOGO --> <div class="page-logo"> <a href="#/"> <img src="{{settings.layoutPath}}/puya_logo.png" alt="logo" class="logo-default"> </a> <div class="menu-toggler sidebar-toggler"> <!-- DOC: Remove the above "hide" to enable the sidebar toggler button on header --> </div> </div> <!-- END LOGO --> <!-- BEGIN HEADER SEARCH BOX --> <!-- DOC: Apply "search-form-expanded" right after the "search-form" class to have half expanded search box --> <form class="search-form hide" action="#" method="GET"> <div class="input-group"> <input type="text" class="form-control" placeholder="Search..." name="query"> <span class="input-group-btn"> <a href="javascript:;" class="btn submit"> <i class="icon-magnifier"></i> </a> </span> </div> </form> <!-- END HEADER SEARCH BOX --> <!-- BEGIN RESPONSIVE MENU TOGGLER --> <a href="javascript:;" class="menu-toggler responsive-toggler" data-toggle="collapse" data-target=".navbar-collapse"> </a> <!-- END RESPONSIVE MENU TOGGLER --> <!-- BEGIN TOP NAVIGATION MENU --> <div class="top-menu"> <ul class="nav navbar-nav pull-right"> <!-- BEGIN USER LOGIN DROPDOWN --> <!-- DOC: Apply "dropdown-dark" class after below "dropdown-extended" to change the dropdown styte --> <li class="dropdown dropdown-user"> <a href="#" class="dropdown-toggle" dropdown-menu-hover data-toggle="dropdown" data-close-others="true"> <i class="fa fa-user"></i> <!--img alt="" class="img-circle"\n                    src="{{settings.layoutPath}}/puya_avatar10.jpg" /--> <span class="username username-hide-on-mobile"> {{userinfo.username}} </span> <i class="fa fa-angle-down"></i> </a> <ul class="dropdown-menu dropdown-menu-default"> <li> <a href="#/profile"> <i class="icon-puzzle"></i> 个人信息 </a> </li> <li> <a href="#/changepwd"> <i class="icon-calendar"></i> 修改密码 </a> </li> <li class="divider"> </li> <li> <a href ng-click="logout()"> <i class="icon-key"></i> 退出 </a> </li> </ul> </li> <!-- END USER LOGIN DROPDOWN --> </ul> </div> <!-- END TOP NAVIGATION MENU --> </div> <!-- END HEADER INNER -->'),a.put("views/login.html",'<form class="login-form" name="loginForm" ng-submit="submitForm()" novalidate> <!--h3 class="form-title font-green">登录</h3--> <div class="alert alert-{{alertType}} alert-dismissible" style="margin-top: 20px" role="alert" ng-show="showAlert"> <button type="button" class="close" ng-click="showAlert=false"> <span aria-hidden="true">&times;</span></button> <strong>{{notifType}}</strong> {{notifMsg}} </div> <div class="form-group" style="margin-top: 20px"> <!--ie8, ie9 does not support html5 placeholder, so we just show field title for that--> <div class="form-group" ng-class="{\'has-error\':(loginForm.inputEmail.$invalid  &&\n            !loginForm.inputEmail.$pristine) || emailErr.error}"> <input class="form-control form-control-solid placeholder-no-fix" type="email" autocomplete="on" placeholder="邮箱" id="inputEmail" name="inputEmail" ng-model="user.email" required> <div ng-show="loginForm.inputEmail.$invalid && !loginForm.inputEmail.$pristine" class="help-block"> <p>请输入合法的邮箱地址.</p> </div> </div> </div> <div class="form-group"> <div class="form-group" ng-class="{\'has-error\':(loginForm.inputPassword.$invalid  &&\n            !loginForm.inputPassword.$pristine)}"> <label class="control-label visible-ie8 visible-ie9">密码</label> <input class="form-control form-control-solid placeholder-no-fix" type="password" autocomplete="off" placeholder="密码" id="inputPassword" name="inputPassword" ng-minlength="6" ng-model="user.password" required> <p ng-show="loginForm.inputPassword.$invalid && !loginForm.inputPassword.$pristine" class="help-block"> 请确保用户密码最小长度为6位字符.</p> </div> </div> <div ng-show="showCaptcha" class="form-group" ng-class="{\'has-error\':loginForm.captchaCode.$invalid  &&\n        !loginForm.captchaCode.$pristine}"> <input type="text" class="form-control" id="captchaCode" name="captchaCode" placeholder="验证码" ng-model="user.captchaCode" ng-pattern="/[0-9]{4}/" required> <img height="30" width="120" alt="验证码" style="margin-top: 10px" ng-src="data:image/png;base64,{{captChaResult}}"> <a href ng-click="getCaptchaContent(\'true\')">看不清</a> </div> <div class="form-actions"> <button type="submit" ng-disabled="!formC.canSubmit()" id="submitButton" class="btn green uppercase">登录</button> <!--label class="rememberme check">\n        <input type="checkbox" name="remember" value="1" />记住我 </label--> <a href="#/forgetpwd" id="forget-password" class="forget-password">忘记密码?</a> </div> <div class="create-account"> <p> <a href="#/signup" id="register-btn" class="uppercase">注册</a> </p> </div> </form>'),a.put("views/sidebar.html",'<div class="page-sidebar navbar-collapse collapse" style="margin-top: 40px"> <!-- BEGIN SIDEBAR MENU --> <!-- DOC: Apply "page-sidebar-menu-light" class right after "page-sidebar-menu" to enable light sidebar menu style(without borders) --> <!-- DOC: Apply "page-sidebar-menu-hover-submenu" class right after "page-sidebar-menu" to enable hoverable(hover vs accordion) sub menu mode --> <!-- DOC: Apply "page-sidebar-menu-closed" class right after "page-sidebar-menu" to collapse("page-sidebar-closed" class must be applied to the body element) the sidebar sub menu mode --> <!-- DOC: Set data-auto-scroll="false" to disable the sidebar from auto scrolling/focusing --> <!-- DOC: Set data-keep-expand="true" to keep the submenues expanded --> <!-- DOC: Set data-auto-speed="200" to adjust the sub menu slide up/down speed --> <ul class="page-sidebar-menu" data-keep-expanded="false" data-auto-scroll="true" data-slide-speed="200" ng-class="{\'page-sidebar-menu-closed\': settings.layout.pageSidebarClosed}"> <!-- DOC: To remove the search box from the sidebar you just need to completely remove the below "sidebar-search-wrapper" LI element --> <!--li class="sidebar-search-wrapper"--> <!-- BEGIN RESPONSIVE QUICK SEARCH FORM --> <!-- DOC: Apply "sidebar-search-bordered" class the below search form to have bordered search box --> <!-- DOC: Apply "sidebar-search-bordered sidebar-search-solid" class the below search form to have bordered & solid search box --> <!--form class="sidebar-search sidebar-search-bordered" action="#" method="POST">\n                <a href="javascript:;" class="remove">\n                    <i class="icon-close"></i>\n                </a>\n                <div class="input-group">\n                    <input type="text" class="form-control" placeholder="Search...">\n                    <span class="input-group-btn">\n                        <a href="javascript:;" class="btn submit">\n                            <i class="icon-magnifier"></i>\n                        </a>\n                    </span>\n                </div>\n            </form--> <!-- END RESPONSIVE QUICK SEARCH FORM --> <!--/li--> <!--li class="start nav-item" style="margin-top: 40px">\n            <a href="#/dashboard">\n                <i class="icon-home"></i>\n                <span class="title">统计信息</span>\n            </a>\n        </li--> <li class="nav-item"> <a href="#/profile" id="sidebar_menu_link_profile"> <i class="icon-user"></i> <span class="title">用户中心</span> </a> <ul class="sub-menu"> <li> <a href="#/profile"> <i class="icon-puzzle"></i> 个人信息 </a> </li> <li> <a href="#/changepwd"> <i class="icon-calendar"></i> 修改密码 </a> </li> </ul> </li> <li class="nav-item" ng-show="deviceMgt"> <a href="#/deviceList/all"> <i class="icon-list"></i> <span class="title">设备列表</span> </a> </li> <li class="nav-item" ng-show="channelMgt"> <a href="#/channelusermgt" id="sidebar_menu_link_profile"> <i class="icon-user"></i> <span class="title">渠道管理</span> </a> <ul class="sub-menu"> <li> <a href="#/channelusermgt"> <i class="icon-puzzle"></i> 个人用户管理 </a> </li> <li> <a href="#/channelcompanymgt"> <i class="icon-calendar"></i> 公司用户管理 </a> </li> </ul> </li> <li class="nav-item" ng-show="certMgt"> <a href="#/certmgt" id="sidebar_menu_link_profile"> <i class="icon-user"></i> <span class="title">认证管理</span> </a> <ul class="sub-menu"> <li ng-show="entityCert"> <a href="#/certmgt"> <i class="icon-puzzle"></i> 实名认证 </a> </li> <li ng-show="subuserMgt"> <a href="#/subusermgt"> <i class="icon-calendar"></i> 用户管理 </a> </li> </ul> </li> <li class="nav-item"> <a href="#/download"> <i class="icon-cloud-download"></i> <span class="title">资源下载</span> </a> </li> <!--li class="nav-item">\n            <a href="javascript:;" class="nav-link nav-toggle">\n                <i class="icon-settings"></i>\n                <span class="title">AngularJS Features</span>\n                <span class="arrow"></span>\n            </a>\n            <ul class="sub-menu">\n                <li>\n                    <a href="#/ui_bootstrap.html">\n                        <i class="icon-puzzle"></i> UI Bootstrap</span>\n                    </a>\n                </li>\n                <li>\n                    <a href="#/file_upload.html">\n                        <i class="icon-paper-clip"></i> File Upload</span>\n                    </a>\n                </li>\n                <li>\n                    <a href="#/ui_select.html">\n                        <i class="icon-check"></i> UI Select</span>\n                    </a>\n                </li>\n            </ul>\n        </li>\n        <li class="nav-item">\n            <a href="javascript:;" class="nav-link nav-toggle">\n                <i class="icon-wrench"></i>\n                <span class="title">jQuery Plugins</span>\n                <span class="arrow "></span>\n            </a>\n            <ul class="sub-menu">\n                <li>\n                    <a href="#/form-tools">\n                        <i class="icon-puzzle"></i> Form Tools </a>\n                </li>\n                <li>\n                    <a href="#/pickers">\n                        <i class="icon-calendar"></i> Date & Time Pickers </a>\n                </li>\n                <li>\n                    <a href="#/dropdowns">\n                        <i class="icon-refresh"></i> Custom Dropdowns </a>\n                </li>\n                <li>\n                    <a href="#/tree">\n                        <i class="icon-share"></i> Tree View </a>\n                </li>\n                <li class="nav-item">\n                    <a href="javascript:;" class="nav-link nav-toggle">\n                        <i class="icon-briefcase"></i> Datatables\n                        <span class="arrow "></span>\n                    </a>\n                    <ul class="sub-menu">\n                        <li>\n                            <a href="#/datatables/managed.html">\n                                <i class="icon-tag"></i> Managed Datatables </a>\n                        </li>\n                        <li>\n                            <a href="#/datatables/ajax.html">\n                                <i class="icon-refresh"></i> Ajax Datatables </a>\n                        </li>\n                    </ul>\n                </li>\n            </ul>\n        </li>\n        <li class="nav-item">\n            <a href="#/profile/dashboard" id="sidebar_menu_link_profile">\n                <i class="icon-user"></i>\n                <span class="title">User Profile</span>\n            </a>\n        </li>\n        <li class="nav-item">\n            <a href="#/todo">\n                <i class="icon-check"></i>\n                <span class="title">Task & Todo</span>\n            </a>\n        </li--> </ul> <!-- END SIDEBAR MENU --> </div>'),a.put("views/signup.html",'<form class="register-form" style="display:block" name="userForm" ng-submit="submitForm()" novalidate> <!--alert--> <div ng-switch="submitStatus"> <div ng-switch-when="success"> <div class="alert alert-success alert-dismissible" style="margin-top: 20px" role="alert"> <button type="button" class="close" ng-click="showAlert=false"> <span aria-hidden="true">&times;</span></button> 账号已经创建成功，请进行邮箱验证，点击 <strong>返回</strong> 开始登录。 </div> </div> <div ng-switch-when="warning"> <div class="alert alert-warning alert-dismissible" style="margin-top: 20px" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"> <span aria-hidden="true">&times;</span></button> <strong>提示:</strong> {{alertMsg}} </div> </div> <div ng-switch-when="error"> <div class="alert alert-danger alert-dismissible" style="margin-top: 20px" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"> <span aria-hidden="true">&times;</span></button> <strong>注册失败：</strong> 注册过程中发生一些未知的错误，程序员正在拼命处理中。 </div> </div> </div> <!--p class="hint"> 请输入个人详细信息: </p--> <div class="form-group" style="margin-top: 20px" ng-class="{\'has-error\':(userForm.inputEmail.$invalid  &&\n        !userForm.inputEmail.$pristine) || emailErr.error}"> <input type="email" class="form-control" id="inputEmail" name="inputEmail" placeholder="邮箱" ng-disabled="formStatus" ng-blur="showCaptcha()" ng-model="user.email" required> <div ng-show="userForm.inputEmail.$invalid && !userForm.inputEmail.$pristine" class="help-block"> <p>请输入合法的邮箱地址.</p> </div> </div> <div class="form-group" ng-class="{\'has-error\':(userForm.inputPhone.$invalid  &&\n        !userForm.inputPhone.$pristine) || phoneErr.error}"> <input type="text" class="form-control" id="inputPhone" name="inputPhone" placeholder="手机号码" ng-disabled="formStatus" ng-model="user.cellphone" ng-pattern="/^1[0-9]{10}$/" required> <div ng-show="userForm.inputPhone.$invalid && !userForm.inputPhone.$pristine" class="help-block"> <p>请输入合法的手机号码.</p> </div> </div> <div class="form-group" ng-class="{\'has-error\':(userForm.inputUsername.$invalid  &&\n        !userForm.inputUsername.$pristine) || userNameErr.error}"> <input type="text" class="form-control" id="inputUsername" name="inputUsername" placeholder="用户昵称" ng-disabled="formStatus" ng-model="user.username" required> <div ng-show="userForm.inputUsername.$invalid && !userForm.inputUsername.$pristine" class="help-block"> <p>用户昵称不能为空.</p> </div> </div> <!--p class="hint"> 请输入账户信息: </p--> <div class="form-group" ng-class="{\'has-error\':userForm.inputPassword.$invalid  &&\n        !userForm.inputPassword.$pristine}"> <input type="password" class="form-control" id="inputPassword" name="inputPassword" ng-minlength="6" placeholder="密码" ng-disabled="formStatus" ng-model="user.password" required> <p ng-show="userForm.inputPassword.$invalid && !userForm.inputPassword.$pristine" class="help-block"> 请确保用户密码最小长度为6位字符.</p> </div> <div class="form-group" ng-class="{\'has-error\':userForm.confirmPassword.$invalid  &&\n        !userForm.confirmPassword.$pristine}"> <input type="password" class="form-control" id="confirmtPassword" name="confirmPassword" ng-minlength="6" placeholder="重新输入密码" ng-disabled="formStatus" ng-model="user.confirmPassword" required> <p ng-show="userForm.confirmPassword.$invalid && !userForm.confirmPassword.$pristine" class="help-block">请确保用户密码最小长度为6位字符.</p> </div> <div class="form-group" ng-show="showCaptchaStatus" ng-class="{\'has-error\':userForm.captchaCode.$invalid  && !userForm.captchaCode.$pristine}"> <input type="text" class="form-control" id="captchaCode" name="captchaCode" placeholder="验证码" ng-model="user.captchaCode" ng-disabled="formStatus" ng-pattern="/[0-9]{4}/" required> <p ng-show="userForm.captchaCode.$invalid && !userForm.captchaCode.$pristine" class="help-block">请确保验证码长度为4位字符.</p> <img height="30" width="120" alt="验证码" style="margin-top: 10px" ng-src="data:image/png;base64,{{captChaResult}}"> <a href ng-show="!formStatus" ng-click="getCaptchaContent(\'true\')">看不清</a> </div> <div class="form-group margin-top-20 margin-bottom-20"> <label class="check"> <input type="checkbox" name="tnc" ng-model="licenseChecked"> 同意 <a href="" ng-click="openLicense()"> 用户协议</a> </label> </div> <div class="form-actions"> <a ui-sref="login"> <button type="button" id="register-back-btn" class="btn btn-default">返回</button> </a> <button type="submit" ng-disabled="canSubmit()" id="register-submit-btn" class="btn green uppercase pull-right">注册</button> </div> </form>'),a.put("views/subuserMgt.html",'<!-- BEGIN PAGE HEADER--> <div class="page-bar"> <ul class="page-breadcrumb"> <li> <a href="#/profile">主页</a> <i class="fa fa-circle"></i> </li> <li> <a href="#/certmgt">认证管理</a> <i class="fa fa-circle"></i> </li> <li> <a href="#/subusermgt">用户管理</a> </li> </ul> </div> <div class="alert alert-{{alertType}} alert-dismissible" style="margin-top: 20px" role="alert" ng-show="showAlert"> <button type="button" class="close" ng-click="showAlert=false"> <span aria-hidden="true">&times;</span></button> <strong>{{notifType}}</strong> {{notifMsg}} </div> <div class="note note-info" style="margin-top: 20px"> <p> 管理子用户：增加，更新和删除子用户，更改子用户备份配额，修改默认备份配额。 </p> </div> <h3 class="page-title"> Hi {{userInfo.username}} <small>您是<a ng-href="#" ng-click="certmgt()">{{companyInfo.company_name}}</a>的管理员</small> </h3> <!-- END PAGE HEADER--> <!-- BEGIN MAIN CONTENT --> <div class="row"> <div class="col-md-12"> <!-- BEGIN EXAMPLE TABLE PORTLET--> <div class="portlet light bordered"> <div class="portlet-title"> <div class="caption font-dark"> <i class="icon-settings font-dark"></i> <span class="caption-subject bold uppercase"> 公司总览</span> </div> </div> <div class="portlet-body"> <!--div class="table-toolbar">\n                    <div class="row">\n                        <div class="col-md-6">\n                            <div class="btn-group">\n                                <button id="add_subuser" class="btn\n                                    sbold green" ng-click="actions.addSubuser()"> 添加用户\n                                    <i class="fa fa-plus"></i>\n                                </button>\n                            </div>\n                        </div>\n                        <div class="col-md-6">\n                            <div class="btn-group pull-right">\n                                <button class="btn green  btn-outline dropdown-toggle" \n                                    data-toggle="dropdown">更多操作\n                                    <i class="fa fa-angle-down"></i>\n                                </button>\n                                <ul class="dropdown-menu pull-right">\n                                    <li>\n                                        <a href="javascript:;"\n                                            ng-click="setSubuserStatus(0)">\n                                            <i class="fa fa-pause"></i> 冻结用户 </a>\n                                    </li>\n                                    <li>\n                                        <a href="javascript:;"\n                                            ng-click="setSubuserStatus(1)">\n                                            <i class="fa fa-play"></i> 激活用户 </a>\n                                    </li>\n                                    <li>\n                                        <a href="javascript:;"\n                                            ng-click="delSubuser()">\n                                            <i class="fa fa-trash"></i> 删除用户 </a>\n                                    </li>\n                                </ul>\n                            </div>\n                        </div>\n                    </div>\n                </div--> <div class="row list-separated"> <div class="col-md-3 col-sm-3 col-xs-6"> <div class="font-grey-mint font-sm"> 备份空间</div> <div class="uppercase font-hg font-red-flamingo"> {{companyInfo.assigned_quota}} / {{companyInfo.quota}} <span class="font-lg font-grey-mint">GB</span> </div> </div> <div class="col-md-3 col-sm-3 col-xs-6"> <div class="font-grey-mint font-sm"> 备份设备数</div> <div class="uppercase font-hg font-green"> {{companyInfo.devices_used}} / {{companyInfo.quota}} <span class="font-lg font-grey-mint"></span> </div> </div> <div class="col-md-3 col-sm-3 col-xs-6"> <div class="font-grey-mint font-sm"> 备份用户数</div> <div class="uppercase font-hg font-blue"> {{companyInfo.backup_users}} / {{companyInfo.quota}} </div> </div> </div> </div> </div> <!-- END EXAMPLE TABLE PORTLET--> <span us-spinner spinner-on="showSpinner"></span> </div> </div> <div class="row"> <div class="col-md-12"> <!-- BEGIN EXAMPLE TABLE PORTLET--> <div class="portlet light bordered"> <div class="portlet-title"> <div class="caption font-dark"> <i class="icon-settings font-dark"></i> <span class="caption-subject bold uppercase"> 用户管理</span> </div> </div> <div class="portlet-body"> <div class="table-toolbar"> <div class="row"> <div class="col-md-6"> <div class="btn-group"> <button id="add_subuser" class="btn sbold green" ng-click="actions.addSubuser()"> 添加用户 <i class="fa fa-plus"></i> </button> </div> </div> <div class="col-md-6"> <div class="btn-group pull-right"> <button class="btn green btn-outline dropdown-toggle" data-toggle="dropdown">更多操作 <i class="fa fa-angle-down"></i> </button> <ul class="dropdown-menu pull-right"> <li> <a href="javascript:;" ng-click="setSubuserStatus(1)"> <i class="fa fa-play"></i> 激活用户 </a> </li> <li> <a href="javascript:;" ng-click="setSubuserStatus(0)"> <i class="fa fa-pause"></i> 冻结用户 </a> </li> <li> <a href="javascript:;" ng-click="delSubuser()"> <i class="fa fa-trash"></i> 删除用户 </a> </li> </ul> </div> </div> </div> </div> <table datatable="ng" dt-options="dtOptions" class="row-border hover"> <thead> <tr> <th> <input type="checkbox" class="checkboxes" ng-model="checkStatus.checkAll" ng-click="checkStatus.clickCheckAll()"> </th> <th> 用户名 </th> <th> 手机号码 </th> <th> Email </th> <th> 状态 </th> <th> 备份空间 </th> <th> 设备数 </th> <th> 操作 </th> </tr> </thead> <tbody> <tr ng-repeat="subuser in subusers.subusers"> <td> <input type="checkbox" class="checkboxes" ng-model="subuser.checked" ng-click="clickCheck(subuser.id)"> </td> <td> {{subuser.username}} </td> <td> {{subuser.cellphone}} </td> <td> <a ng-href="mailto:{{subuser.email}}"> {{subuser.email}} </a> </td> <td> <span class="label label-sm label-success" ng-if="subuser.is_active==true"> 正常 </span> <span class="label label-sm label-success" ng-if="subuser.is_active==false"> 冻结中 </span> </td> <td class="center"> {{subuser.storage_used}} / {{subuser.quota}} </td> <td class="center"> {{subuser.devices_used}} / {{subuser.quota}} </td> <td class="center"> <a href="javascript:;" popover="更新备份配额" popover-trigger="mouseenter" ng-click="actions.updateQuota(subuser.id)" style="margin-right: 5px"> <i class="fa fa-refresh"></i> </a> <a href="javascript:;" popover="激活" popover-trigger="mouseenter" ng-click="subuserEnable(subuser.id)" style="margin-right: 5px"> <i class="fa fa-play"></i> </a> <a href="javascript:;" popover="冻结" popover-trigger="mouseenter" ng-click="subuserDisable(subuser.id)" style="margin-right: 5px"> <i class="fa fa-pause"></i> </a> <a href="javascript:;" popover="删除" popover-trigger="mouseenter" ng-click="subuserDelete(subuser.id)" style="margin-right: 5px"> <i class="fa fa-trash"></i> </a> </td> </tr> </tbody> </table> </div> </div> <!-- END EXAMPLE TABLE PORTLET--> </div> </div> <!-- BEGIN MAIN JS --> <script type="text/ng-template" id="myModalContent.html"><div class="modal-header">\n        <h3 class="modal-title">添加用户</h3>\n    </div>\n    <div class="modal-body">\n        <form class="register-form" style="display:block" name="userForm" novalidate>\n            <div class="form-group" style="margin-top: 20px" \n                ng-class="{\'has-error\':userForm.inputEmail.$invalid &&\n                    !userForm.inputEmail.$pristine}">\n                <input type="email" class="form-control" id="inputEmail" name="inputEmail"\n                placeholder="邮箱" ng-model="subuser.email" required>\n                <div ng-show="userForm.inputEmail.$invalid && !userForm.inputEmail.$pristine" class="help-block">\n                    <p>请输入合法的邮箱地址.</p>\n                </div>\n            </div>\n            <div class="form-group" ng-class="{\'has-error\':userForm.inputPhone.$invalid &&\n                !userForm.inputPhone.$pristine}">\n                <input type="text" class="form-control" id="inputPhone" name="inputPhone"\n                placeholder="手机号码" ng-model="subuser.cellphone" ng-pattern="/^1[0-9]{10}$/" required>\n                <div ng-show="userForm.inputPhone.$invalid && !userForm.inputPhone.$pristine" class="help-block">\n                    <p>请输入合法的手机号码.</p>\n                </div>\n            </div>\n            <div class="form-group" ng-class="{\'has-error\':userForm.inputUsername.$invalid &&\n                !userForm.inputUsername.$pristine}">\n                <input type="text" class="form-control" id="inputUsername" name="inputUsername"\n                placeholder="用户昵称" ng-model="subuser.username" required>\n                <div ng-show="userForm.inputUsername.$invalid && !userForm.inputUsername.$pristine" class="help-block">\n                    <p>用户昵称不能为空.</p>\n                </div>\n            </div>\n            <div class="form-group" ng-class="{\'has-error\':userForm.inputPassword.$invalid &&\n                !userForm.inputPassword.$pristine}">\n                <div class="input-group" style="text-align:left">\n                    <input type="text" class="form-control" id="inputPassword" name="inputPassword"\n                    ng-minlength="6" placeholder="密码" ng-model="subuser.password" required>\n                    <span class="input-group-btn">\n                        <button class="btn green"\n                            ng-click="randomPassword()">随机密码 </button>\n                    </span>\n                </div>\n                <p ng-show="userForm.inputPassword.$invalid && !userForm.inputPassword.$pristine" class="help-block">\n                    请确保用户密码最小长度为6位字符.</p>\n            </div>\n            <div class="form-group" ng-class="{\'has-error\':userForm.inputQuota.$invalid &&\n                !userForm.inputQuota.$pristine}">\n                <div class="input-group" style="text-align:left">\n                    <input type="text" class="form-control" id="inputQuota" name="inputQuota"\n                    ng-pattern="/^[1-9]{1}[0-9]{0,10}$/"\n                    placeholder="备份配额，单位GB" ng-model="subuser.quota" required>\n                    <span class="input-group-btn">\n                        <button class="btn green"\n                            ng-click="setDefaultQuota()">默认配额 </button>\n                    </span>\n                </div>\n                <span ng-show="userForm.inputQuota.$invalid && !userForm.inputQuota.$pristine" class="help-block">\n                    请输入正确的备份配额，例如：<code>512</code>.</span>\n            </div>\n        </form>\n    </div>\n    <div class="modal-footer">\n        <button class="btn btn-primary" ng-disabled="disableSubmit()" ng-click="ok()">添加</button>\n        <button class="btn btn-warning" ng-click="cancel()">取消</button>\n    </div></script> <script type="text/ng-template" id="updateQuota.html"><div class="modal-header">\n        <h3 class="modal-title">更改备份配额</h3>\n    </div>\n    <div class="modal-body">\n        <form class="register-form" style="display:block" name="quotaForm" novalidate>\n            <div class="form-group" ng-class="{\'has-error\':quotaForm.inputQuota.$invalid &&\n                !quotaForm.inputQuota.$pristine}">\n                <div class="input-group" style="text-align:left">\n                    <input type="text" class="form-control" id="inputQuota" name="inputQuota"\n                    ng-pattern="/^[1-9]{1}[0-9]{0,10}$/"\n                    placeholder="备份配额，单位GB" ng-model="quota" required>\n                    <span class="input-group-btn">\n                        <button class="btn green"\n                            ng-click="setDefaultQuota()">默认配额 </button>\n                    </span>\n                </div>\n                <span ng-show="quotaForm.inputQuota.$invalid && !quotaForm.inputQuota.$pristine" class="help-block">\n                    请输入正确的备份配额，例如：<code>512</code>.</span>\n            </div>\n        </form>\n    </div>\n    <div class="modal-footer">\n        <button class="btn btn-primary" ng-disabled="disableSubmit()"\n            ng-click="ok()">确定</button>\n        <button class="btn btn-warning" ng-click="cancel()">取消</button>\n    </div></script> <!-- END MAIN JS -->'),a.put("views/taskhistory.html",'<div class="page-bar"> <ul class="page-breadcrumb"> <li> <a href="#/">主页</a> <i class="fa fa-circle"></i> </li> <li> <a href="#/deviceList/{{deviceId}}">设备列表</a> <i class="fa fa-circle"></i> </li> <li> <a href="#">备份历史记录</a> <i class="fa fa-circle"></i> </li> </ul> <h3 class="page-title" style="float:right"> <small>已用备份空间：{{companyQuotaUsed}}GB/{{companyQuota}}GB </small> </h3> </div> <div class="alert alert-{{alertType}} alert-dismissible" style="margin-top: 20px" role="alert" ng-show="showAlert"> <button type="button" class="close" ng-click="showAlert=false"> <span aria-hidden="true">&times;</span></button> <strong>{{notifType}}</strong> {{notifMsg}} </div> <!-- <hr style="border: 1px solid color: #ffffff"/> --> <div> <!-- BEGIN MAIN CONTENT --> <div class="row"> <div class="col-md-12" style="margin-top:10px"> <!-- BEGIN TABLE PORTLET--> <div class="portlet light bordered"> <div class="portlet-title"> <div class="caption font-dark"> <i class="icon-list font-dark"></i> <span class="caption-subject bold uppercase">&nbsp;备份历史记录</span> </div> <div class="btn-group" style="float:right"> <a class="pull-left back-to-list btn btn-default" style="color:powderblue" ng-click="backToDeviceList()"> <i class="fa fa-chevron-left"></i>&nbsp;返回 </a> </div> </div> <div class="portlet-body"> <table datatable="ng" class="row-border hover" dt-options="dtOptions" dt-column-defs="dtColumnDefs"> <thead> <tr> <th>备份时间</th> <th>备份内容</th> <th>备份文件数</th> <th>备份大小</th> <th>状态</th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="action in actions | filter:filterActionList"> <td> <!--\n              date_backup:\n              {{action.date_backuped | date:"yyyy-MM-dd HH:mm:ss"}}\n              <br/>\n              date_reday:\n              {{action.date_ready | date:"yyyy-MM-dd HH:mm:ss"}}\n              <br/>\n              date_request:\n              {{action.date_request | date:"yyyy-MM-dd HH:mm:ss"}}\n              <br/>\n              statistics.finish_date:\n              {{action.statistics.finish_date*1000 | date:"yyyy-MM-dd HH:mm:ss"}}\n              <br/>\n              statistics.backup_date:--> {{action.statistics.backup_date*1000 | date:"yyyy-MM-dd HH:mm:ss"}} </td> <td ng-switch="action.dir_layout.length"> <div ng-switch-when="1"> <treecontrol class="tree-classic" tree-model="treedata[$index]" on-selection="showSelected(node)" options="opts"> {{node.name}} </treecontrol> </div> <div ng-switch-default> -- </div> </td> <td>{{action.statistics.changed_files}}</td> <td>{{action.statistics.created_size | fileSize}}</td> <td> <span class="label label-sm label-success" ng-if="action.isSuccess==true"> {{action.mapStatus}} </span> <span class="label label-sm label-warning" ng-if="action.isSuccess==false"> {{action.mapStatus}} </span> </td> <td> <a href="javascript:void(0);" popover="删除备份" popover-trigger="mouseenter" ng-click="modals.deleteBackup(action.id)" ng-hide="action.is_done==false||action.is_deleted==true" style="margin-left:5px"> <i class="fa fa-trash"></i> </a> </td> </tr> </tbody> </table> </div> </div> <!-- END TABLE PORTLET--> <span us-spinner spinner-on="showSpinner"></span> </div> </div> </div> <script type="text/ng-template" id="modalDeleteBackup.html"><div class="modal-header">\n      <h4 class="modal-title">\n        <i class="fa fa-exclamation-triangle"></i>&nbsp;系统提示\n      </h4>\n    </div>\n    <div class="modal-body">\n      <p>\n        确定要删除备份吗？\n      </p>\n    </div>\n    <div class="modal-footer">\n      <button class="btn btn-primary" ng-click="ok()">确定</button>\n      <button class=\'btn btn-warning\' ng-click="cancel()">取消</button>\n    </div></script>'),a.put("views/user.html",'<!-- BEGIN PAGE HEADER--> <div class="page-bar"> <ul class="page-breadcrumb"> <li> <a href="#/profile">主页</a> <i class="fa fa-circle"></i> </li> <li> <a href="#/profile">用户管理</a> <i class="fa fa-circle"></i> </li> <li> <a href="#/profile">个人信息</a> </li> </ul> </div> <div class="alert alert-{{alertType}} alert-dismissible" style="margin-top: 20px" role="alert" ng-show="showAlert"> <button type="button" class="close" ng-click="showAlert=false"> <span aria-hidden="true">&times;</span></button> <strong>{{notifType}}</strong> {{notifMsg}} </div> <!--h3 class="page-title"> 用户管理\n    <small>个人信息管理</small>\n</h3--> <!-- BEGIN MAIN CONTENT --> <div class="note note-info" style="margin-top: 20px"> <p> 可查看或修改个人用户昵称、邮箱及手机号码，账户验证成功后可以进行实名认证。 </p> </div> <div class="row"> <div class="col-md-12"> <!-- BEGIN PORTLET--> <div class="portlet box blue-hoki"> <div class="portlet-title"> <div class="caption"> <i class="fa fa-gift"></i>个人信息 </div> </div> <div class="portlet-body form"> <!-- BEGIN FORM--> <form class="form-horizontal form-bordered" name="profileForm" ng-submit="submitForm()"> <div class="form-body"> <fieldset ng-disabled="!userInfoActive"> <div class="form-group" ng-class="{\'has-error\':\n                            profileForm.inputUsername.$invalid  \n                            && !profileForm.inputUsername.$pristine}"> <label for="inputUserName" class="control-label col-md-3">用户昵称</label> <div class="col-md-4"> <input type="text" class="form-control" maxlength="15" id="inputUsername" name="inputUsername" ng-model="userInfo.username"> <span ng-show="userInfoActive" class="help-block"> 允许输入任意中英文字符和其他符号 </span> </div> </div> <div class="form-group" ng-class="{\'has-error\':\n                            profileForm.inputEmail.$invalid  \n                            && !profileForm.inputEmail.$pristine}"> <label for="inputEmail" class="control-label col-md-3">邮箱</label> <div class="col-md-4"> <input type="email" class="form-control" maxlength="100" id="inputEmail" name="inputEmail" ng-model="userInfo.email" required> <span ng-show="userInfoActive" class="help-block"> 邮箱地址，例如: <code>john@yourcompany.com</code> </span> </div> </div> <div class="form-group" ng-class="{\'has-error\':\n                            profileForm.inputPhone.$invalid  \n                            && !profileForm.inputPhone.$pristine}"> <label class="control-label col-md-3">手机</label> <div class="col-md-4"> <input type="text" class="form-control" maxlength="11" id="inputPhone" name="inputPhone" ng-model="userInfo.cellphone" ng-pattern="/^1[0-9]{10}$/" required> <span ng-show="userInfoActive" class="help-block"> 手机号码，格式如: <code>13800000000</code> </span> </div> </div> </fieldset> <div class="form-group"> <label class="control-label col-md-3">账户状态</label> <div class="col-md-4"> <div ng-switch="userInfo.is_email_confirmed"> <div class="input-group" style="text-align:left" ng-switch-when="false"> <label class="form-control" name="userStatus" id="userStatus">{{confirmStatus}}</label> <span class="input-group-btn"> <!--<button class="btn green" ng-click="sendConfirmation()">--> <button class="btn green" ng-click="openConfirmationModal()"> 账户验证 </button> </span> </div> <div ng-switch-when="true"> <label class="form-control" name="userStatus2" id="userStatus2"> {{confirmStatus}}</label> </div> </div> </div> </div> <div class="form-group"> <label class="control-label col-md-3">认证状态</label> <div class="col-md-4"> <div class="input-group" style="text-align:left" ng-if="userInfo.user_type==userType.normal"> <label class="form-control" name="userCert" id="userCert">{{certStatus}}</label> <span class="input-group-btn"> <button class="btn green" ng-click="userCertification()"> 实名认证 </button> </span> </div> <div ng-if="userInfo.user_type!=userType.normal"> <label class="form-control" name="userCert2" id="userCert2"> {{certStatus}}</label> </div> </div> </div> </div> <div class="form-actions"> <div class="row"> <div class="col-md-offset-3 col-md-9"> <div ng-hide="!userInfoActive"> <button type="submit" class="btn green" ng-disabled="disableSaveUserProfile()"> <i class="fa fa-check"></i> 保存</button> <button type="button" class="btn default" ng-click="disableUpdateUserInfo()">取消</button> </div> <div ng-hide="userInfoActive"> <button type="button" class="btn green" ng-click="enableUpdateUserInfo()"> <i class="fa fa-gear"></i> 修改个人信息</button> </div> </div> </div> </div> </form> <span us-spinner spinner-on="showSpinner"></span> <!-- END FORM--> </div> </div> <!-- END PORTLET--> </div> </div> <div> <script type="text/ng-template" id="accountConfirmationModalContent"><div class="modal-header">\n						            <h4 class="modal-title">账户验证</h4>\n						        </div>\n						        <div class="modal-body">\n						          <uib-tabset>\n						             <uib-tab heading="邮箱验证" >\n								             <div class="note note-info">\n											    <p>\n											        点击确定将发送验证信息至您的邮箱：{{userInfo.email}}\n											     </p>\n											</div>\n								                 \n			                                 <div class="modal-footer">\n									            <button class="btn btn-primary" type="button" ng-click="emailConfirmationOk()">确定</button>\n									            <button class="btn btn-warning" type="button" ng-click="confirmationCancel()">取消</button>\n									        </div>\n						             </uib-tab>\n						             <uib-tab heading="手机验证">\n						                       <form  class="form-horizontal"\n                                                            id="confirmForm"\n                                                            name="confirmForm"\n                                                            ng-submit="submitConfirmationForm()"\n                                                            ng-controller="phoneConfirmCtrl">\n                                                            \n                                                            <div class="alert alert-{{alertType2}} alert-dismissible" style="margin-top: 10px" role="alert" ng-show="showAlert2">\n															  <button type="button" class="close" ng-click="closeAlert2()">\n															        <span aria-hidden="true">&times;</span></button>\n															  <strong>{{notifType2}}</strong> {{notifMsg2}}\n															</div>\n										<div class="row">\n										    <div class="col-md-12">\n										            <div class="portlet-body form">\n										                <!-- BEGIN FORM-->\n                                                            <div class="form-body">\n										                        <fieldset ng-disabled="false">\n										                        \n										                        <div class="form-group">										                           \n										                            <label class="control-label col-md-3">手机号码</label>\n										                            <div class="col-md-7" >\n										                                <div class="input-group">\n										                                <input type="text" class="form-control" maxlength="11" id="inputPhone" \n										                                name="inputPhone" ng-model="userInfo.cellphone"   ng-pattern="/^1[0-9]{10}$/" required ng-disabled="true">\n										                               <span class="input-group-btn">\n										                                        <button class="btn green"  ng-click="sendValidateCode()" ng-disabled="smsSent.status">{{getValidation}}</button>										                                      \n										                               </span>										                              \n										                               </div>\n										                            </div>\n										                        </div>\n										                      										                        \n										                        <div class="form-group" ng-class="{\'has-error\':\n										                            confirmForm.validateCode.$invalid  \n										                            && !confirmForm.validateCode.$pristine}">\n										                            <label  class="control-label col-md-3">验证码</label>\n										                            <div class="col-md-7">\n										                                <input type="text" class="form-control" maxlength="6" \n										                                id="validateCode"\n                                                                        name ="validateCode" \n                                                                         ng-model="validateCode" ng-pattern="/^[0-9]{6}$/" required>\n										                                <span ng-show=\'confirmForm.validateCode.$invalid  \n										                            && !confirmForm.validateCode.$pristine\' class="help-block">\n										                                    输入6位验证码</span>\n										                            </div>\n										                        </div>\n										                        			                         \n										                        \n										                        </fieldset>\n										                    </div>\n					                                        <div class="modal-footer">								             \n														            <button class="btn btn-primary" type="submit"  ng-disabled="confirmForm.validateCode.$invalid" >确定</button>\n														            <button class="btn btn-warning" type="button" ng-click="confirmationCancel()">取消</button>\n														   </div>\n										                \n										             </div>\n										        </div>\n										    </div>\n										    </form>\n						             </uib-tab>\n						          </uib-tabset>						                  \n						        </div></script> </div>'),
a.put("views/webackupLicense.html",'<!-- PAGE HEADER --> <div class="modal-header"><h3>微备份服务协议</h3></div> <!-- FORM\n      <div ng-show="loginForm.captchaCode.$invalid && !loginForm.captchaCode.$pristine" class="help-block">\n        <p>请输入正确的验证码.</p>\n      </div>\n--> <!-- novalidate prevents HTML5 validation since we will be validating ourselves--> <div class="modal-body"> <p> <strong> </strong> </p> <p> 本协议系由南京普亚信息技术有限公司（以下简称“普亚”）与所有使用微备份服务的主体（包括但不限于个人、团队等）（以下简称“用户”）对微备份服务的使用及相关服务所订立的有效合 约。使用微备份服务的任何服务即表示接受本协议的全部条款。本协议适用于任何微备份服务，包括本协议内的用户所使用的各项服务和软件的升级和更新。 </p> <p align="left"> <strong>一、</strong> <strong>服务内容及使用须知</strong> <strong></strong> </p> <p align="left"> <strong> </strong> 1.微备份是一个向广大用户提供数据备份和数据恢复的备份软件，通过微备份系统为用户提供数据的备份、数据的定时自动备份、数据的恢复等多种备份服务。微备份本身不对用户备份的数据进 行任何修改或编辑。 </p> <p align="left"> 2.用户理解微备份提供相关的网络服务，除此之外与相关网络服务有关的设备（如个人电脑、手机、及其他与接入互联网或移动网有关的装置）及所需的费用（如为接入互联网而支付的电话费及 上网费、为使用移动网而支付的手机费）均应由用户自行负担。 </p> <p align="left"> <strong>二、</strong> <strong>所有权</strong> <strong></strong> </p> <p align="left"> 微备份保留对以下所有权及知识产权的声明： </p> <p align="left"> 1.除用户自行备份的内容外，微备份服务及其所有元素，包括但不限于所有内容、数据、技术、软件、代码、用户界面以及与其相关的任何衍生作品； </p> <p align="left"> 2.用户信息； </p> <p align="left"> 3.用户向微备份提供的与该平台服务相关的冗余及反馈； </p> <p align="left"> 未经普亚同意，上述的资料不得在任何媒体直接或间接发布、播放、出于播放或发布目的而改写或再发行，或者被用于其它任何商业目的。上述资料或其任何部分仅可作为私人用途而保存在某台 计算机内。微备份不就由上述资料产生或在传送或递交全部或部分上述资料过程中产生的延误、不准确、错误和遗漏或从中产生或由此产生的任何损害赔偿，以任何形式向用户或任何第三方负法律、 经济责任； </p> <p align="left"> 微备份为提供网络服务而使用的任何软件（包括但不限于软件中所含的任何图像、照片、动画、录像、录音、音乐、文字和附加程序、随附的帮助材料）的一切权利均属于该软件的著作权人，未 经该软件的著作权人 许可，用户不得对该软件进行反向工程（reverse engineer）、反向编译（decompile）或反汇编（disassemble），或以其他方式发现其原始编码，以及实施任何涉嫌侵害著作权的行为。 </p> <p align="left"> 三、<strong>承诺与保障</strong> </p> <p align="left"> 1.用户保证，其使用微备份不得并禁止直接或间接的： </p> <p align="left"> a. 以任何方式干扰或企图干扰微备份服务或微备份上任何部分或功能的正常运行； </p> <p align="left"> b. 避开、尝试避开或声称能够避开任何内容保护机制 </p> <p align="left"> c. 未获得普亚事先书面同意以书面形式或图形方式使用源自普亚的任何注册作品； </p> <p align="left"> d. 未事先经过原始用户的同意向任何非原始用户显示或以其他方式提供任何用户信息； </p> <p align="left"> e.请求、收集、索取或以其他方式从任何用户那里获取对微备份帐号、密码或其他身份验证凭据的访问权； </p> <p align="left"> f.自动将浏览器窗口定向到其他网页； </p> <p align="left"> g.未经授权冒充他人或获取对微备份服务的访问权； </p> <p align="left"> 用户违反上述任何一款的保证，普亚均有权就其情节，对其做出警告、直至取消资格的处罚；如因用户违反上述保证而给微备份、微备份用户或普亚的任何合作伙伴造成损失，用户自行负责承担 一切法律责任并赔偿损失。 </p> <p align="left"> 2.用户承诺： </p> <p align="left"> a.用户利用微备份提供的网络服务上传、发布、传送或通过其他方式传播的内容，不得含有任何违反国家法律法规政策的信息。 </p> <p align="left"> b.用户不得为任何非法目的而使用微备份系统；不得以任何形式使用微备份服务网络服务侵犯普亚的商业利益，包括并不限于发布非经普亚许可的商业广告；不得利用微备份系统进行任何可能对 互联网正常运转造成不利影响的行为； </p> <p align="left"> c.用户不得利用微备份的服务从事故意制作、传播计算机病毒等破坏性程序的，其他危害计算机信息网络安全的行为等。 </p> <p align="left"> d.如因用户利用微备份提供的网络服务通过非法方式传播的内容存在权利瑕疵或侵犯了第三方的合法权益（包括但不限于专利权、商标权、著作权及著作权邻接权、肖像权、隐私权、 名誉权等）而导致普亚或与普亚合作的其他单位面临任何投诉、举报、质询、索赔、诉讼；或者使普亚或者与普亚合作的其他单位因此遭受任何名誉、声誉或者财产上的损失，用户应积极地采取 一切可能采取的措施，以保证普亚及与普亚合作的其他单位免受上述索赔、诉讼的影响。同时用户对普亚及与普亚合作的其他单位因此遭受的直接及间接经济损失负有全 部的损害赔偿责任。 </p> <p> <strong> </strong> </p> <p align="left"> <strong>四、</strong> <strong>知识产权保护</strong> <strong></strong> </p> <p align="left"> 1.用户在收到侵权通知之时，应立即删除或禁止访问声明的侵权内容，并同时联系递送通知的人员以了解详细信息。 </p> <p align="left"> 2.用户知悉并同意百度将根据相关法律法规对第三方发出的合格的侵权通知进行处理，并按照要求删除或禁止访问声明的侵权内容，采用并实施适当的政策，以期杜绝在相应条件下重复侵权。 </p> <p align="left"> <strong> </strong> </p> <p> <strong>五、</strong> <strong>隐私保护</strong> <strong></strong> </p> <p> 普亚不会公开或向第三方提供用户存储在微备份服务上的非公开内容，微备份采用的是分段分片加密传输，所有的数据都存在云端。 </p> <p> <strong>六、</strong> <strong>免责声明</strong> <strong></strong> </p> <p align="left"> 1.鉴于网络服务的特殊性，用户同意微备份有权随时变更、中断或终止部分或全部的网络服务。如变更、中断或终止的网络服务属于免费网络服务，微备份无需通知用户，也无需对任何用户或任 何第三方承担任何责任。 </p> <p align="left"> 2.用户理解，微备份需要定期或不定期地对提供网络服务的平台或相关的设备进行 检修或者维护，如因此类情况而造成收费网络服务在合理时间内的中断，普亚无需为此承担任何责任，但微备份 服务应尽可能事先进行通告。 </p> <p align="left"> 3.微备份服务可在任何时候为任何原因变更本服务或删除其部分功能。微备份服务可在任何时候取消或终止对用户的服务。微备份服务取消或终止服务的决定不需要理由或通知用户。一旦服务取 消，用户使用微备份的权利立即终止。 一旦本服务取消或终止，用户在本服务中储存的任何信息可能无法恢复。 </p> <p align="left"> 4.微备份服务不保证（包括但不限于）： </p> <p align="left"> a.微备份服务适合用户的使用要求； </p> <p align="left"> b.微备份服务不受干扰，及时、安全、可靠或不出现错误；及用户经由微备份取得的任何产品、服务或其他材料符合用户的期望。 </p> <p align="left"> c.用户使用经由微备份取得的任何资料，其风险由用户自行承担；用户因使用微备份而导致用户电脑系统损坏或资料流失，用户应自己负完全责任； </p> <p align="left"> 5.基于以下原因而造成的利润、商业信誉、资料损失或其他有形或无形损失， 微备份服务不承担任何直接、间接的赔偿： </p> <p align="left"> a.对微备份服务的使用或无法使用； </p> <p align="left"> b.经由微备份服务购买或取得的任何产品、资料或服务； </p> <p align="left"> c.用户资料遭到未授权的使用或修改；及其他与微备份服务相关的事宜。 </p> <p align="left"> <strong> </strong> </p> <p align="left"> 6.由于用户授权第三方（包括第三方应用）访问/使用微备份服务所导致的纠纷或损失，应由用户自行负责，与普亚无关。 </p> <p> <strong>七、</strong> <strong>其他</strong> <strong></strong> </p> <p align="left"> 1.本协议最终解释权归普亚所有。 </p> <p align="left"> 2.本协议一经公布即生效，普亚有权随时对协议内容进行修改，修改后的结果公布于普亚官网上。如果不同意普亚对本协议相关条款所做的修改，用户有权停止使用微备份服务。如果用户继续使 用网络服务，则视为用户接受普亚对本协议相关条款所做的修改。 </p> <p align="left"> 3. 本协议项下普亚微备份服务对于用户所有的通知均可通过网页公告、电子邮件、手机短信或常规的信件传送等方式进行；该等通知于发送之日视为已送达收件人。 </p> <p align="left"> 4.本协议的订立、执行和解释及争议的解决均应适用中国法律并受中国法院管辖。如双方就本协议内容或其执行发生任何争议，双方应尽量友好协商解决；协商不成时，任何一方均可向普亚所在 地的人民法院提起诉讼。 </p> <p align="left"> 5.本协议构成双方对本协议之约定事项及其他有关事宜的完整协议，除本协议规定的之外，未赋予本协议各方其他权利。 </p> <p align="left"> 6.如本协议中的任何条款无论因何种原因完全或部分无效或不具有执行力，本协议的其余条款仍应有效并且有约束力。 <strong></strong> </p> </div> <div class="modal-footer"> <button type="button" class="btn btn-primary btn-block" ng-click="$dismiss()">确 定</button> </div>')}]);